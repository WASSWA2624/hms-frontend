---
alwaysApply: true
---

# Security Standards & Policies

## Purpose
Define mandatory security requirements across auth, storage, transport, permissions, and protected feature access.

## Security Ownership
Security layer owns:
- Token lifecycle and secure storage access
- Encryption and key management helpers
- Permission/biometric helper logic
- Security gate decisions consumed by navigation/features

Security layer must not:
- Render UI
- Depend on feature UI flows for enforcement

## Core Modules
```txt
src/security/
  index.js
  token.manager.js
  encryption.js
  biometric.js
  permissions.js
```

## Token and Session Rules
- Raw tokens/credentials must never be persisted in plain text.
- Sensitive credentials are stored only with secure storage primitives.
- Token access and refresh flow are centralized in `token.manager.js`.
- UI must not parse or refresh tokens directly.
- Redux may store session/token metadata only (expiry flags, auth state), never raw token values.

## Storage and Encryption Rules
- Sensitive offline payloads must be encrypted.
- Encryption keys must not be hardcoded.
- Secure and non-secure storage concerns must remain separated.

## Permission and Biometric Rules
- Permission requests are just-in-time and routed through security helpers.
- Biometric usage is optional and must provide fallback auth paths.
- UI components must not contain permission/biometric implementation logic.

## Network Security Rules
- HTTPS-only transport.
- No sensitive values in URL/query strings.
- Auth headers are injected centrally via service/client infrastructure.

## Access Control Rules
- Access checks must combine backend authority, security context, and guard policy.
- Client-only gate checks are insufficient for protected resources.
- Guard integration points are owned by routing/navigation policy.

## Logging and Error Rules
- Never log tokens, credentials, secrets, or PII.
- Security failures must surface sanitized errors only.
- High-risk auth failures must trigger safe session reset/logout behavior.

## Forbidden Patterns
- Raw tokens in Redux state
- Secrets in plain storage or source/config constants
- Permission requests implemented ad hoc in UI files
- Encryption logic scattered outside security/service boundaries

## Enforcement
Security violations are release blockers.

## Related Owners
- Service integration and secret-handling boundaries: `services-integration.mdc`
- Store constraints: `state-management.mdc`
- Startup order/provider wiring: `bootstrap-config.mdc`
- Error/logging pipeline: `errors-logging.mdc`