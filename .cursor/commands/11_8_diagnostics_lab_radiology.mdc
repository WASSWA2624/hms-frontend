Steps to review and implement:
- **11.8.1** Lab (main) -- `(main)/diagnostics/lab`
- **11.8.2.1** Lab Test -- `(main)/diagnostics/lab/lab-tests`
- **11.8.2.2** Lab Panel -- `(main)/diagnostics/lab/lab-panels`
- **11.8.2.3** Lab Order -- `(main)/diagnostics/lab/lab-orders`
- **11.8.2.4** Lab Sample -- `(main)/diagnostics/lab/lab-samples`
- **11.8.2.5** Lab Result -- `(main)/diagnostics/lab/lab-results`
- **11.8.2.6** Lab QC Log -- `(main)/diagnostics/lab/lab-qc-logs`
- **11.8.3** Radiology (main) -- `(main)/diagnostics/radiology`
- **11.8.4.1** Radiology Test -- `(main)/diagnostics/radiology/radiology-tests`
- **11.8.4.2** Radiology Order -- `(main)/diagnostics/radiology/radiology-orders`
- **11.8.4.3** Radiology Result -- `(main)/diagnostics/radiology/radiology-results`
- **11.8.4.4** Imaging Study -- `(main)/diagnostics/radiology/imaging-studies`
- **11.8.4.5** PACS Link -- `(main)/diagnostics/radiology/pacs-links`

Review and implement all missing and non-compliant aspects of the provided dev step(s) as per `hms-frontend/dev-plan/P011_screens-routes.md`.

You must ensure 100% compliance with:
- All rules in `hms-frontend/.cursor/rules/*`
- `hms-frontend/dev-plan/P011_screens-routes.md`
- `hms-frontend/write-up.md`
- Backend contracts in `hms-backend/dev-plan/P010_api_endpoints.mdc` for selected Tier 8 resources
- Actual mounted backend routes in `hms-backend/src/app/router.js` and these Tier 8 module route files:
  - `hms-backend/src/modules/lab-test/routes/lab-test.routes.js`
  - `hms-backend/src/modules/lab-panel/routes/lab-panel.routes.js`
  - `hms-backend/src/modules/lab-order/routes/lab-order.routes.js`
  - `hms-backend/src/modules/lab-sample/routes/lab-sample.routes.js`
  - `hms-backend/src/modules/lab-result/routes/lab-result.routes.js`
  - `hms-backend/src/modules/lab-qc-log/routes/lab-qc-log.routes.js`
  - `hms-backend/src/modules/radiology-test/routes/radiology-test.routes.js`
  - `hms-backend/src/modules/radiology-order/routes/radiology-order.routes.js`
  - `hms-backend/src/modules/radiology-result/routes/radiology-result.routes.js`
  - `hms-backend/src/modules/imaging-study/routes/imaging-study.routes.js`
  - `hms-backend/src/modules/pacs-link/routes/pacs-link.routes.js`
- If backend changes are required, full compliance with `hms-backend/.cursor/rules/*` is mandatory

Only implement what is required for the selected Tier 8 screen(s) to function correctly.

---

## Step Selection Contract (Mandatory)

- The request can target one or more steps from `11.8.1` to `11.8.4.5`.
- Group labels `11.8.2` and `11.8.4` are collections, not single resources.
- If a request selects `11.8.2`, implement all child lab tab steps `11.8.2.1` to `11.8.2.6`.
- If a request selects `11.8.4`, implement all child radiology tab steps `11.8.4.1` to `11.8.4.5`.
- If a request selects specific child tab step IDs, implement only those.
- If a selected step depends on shared Tier 8 wiring, implement only minimal shared wiring required.
- Do NOT auto-implement unselected sibling steps.

---

## Scope

Implement full functionality required for the selected Tier 8 step(s):

- Route + screen wiring under `(main)/diagnostics/lab/*` and `(main)/diagnostics/radiology/*` (selected steps only)
- Backend-aligned API integration for selected resources
- Loading, empty, error, offline, and success states
- Validation for required create/edit inputs
- List, detail, create, edit, and delete flows where backend supports them
- Navigation (Back / Cancel / Save / Continue) with no dead ends
- Parent-child continuity from each selected Tier 8 main screen to selected sub-resources
- Prefill and relationship handling from trusted context:
  - `tenant_id`, `patient_id`, `encounter_id`, `lab_test_id`, `lab_panel_id`, `lab_order_id`, `lab_order_item_id`, `radiology_test_id`, `radiology_order_id`, `imaging_study_id`
- Role-feature access control for logged-in users on all selected Tier 8 routes/actions
- Accessibility control for all selected Tier 8 actions and route states

Frontend integration requirements for alignment with the current codebase:
- Reuse existing feature modules under `src/features/<resource>/*` for selected resources.
- Existing feature modules are available for:
  - `lab-test`, `lab-panel`, `lab-order`, `lab-sample`, `lab-result`, `lab-qc-log`
  - `radiology-test`, `radiology-order`, `radiology-result`, `imaging-study`, `pacs-link`
- If a selected Tier 8 resource hook is missing, create a minimal `useCrud` wrapper hook for that selected resource and export it in `src/hooks/index.js`.
- Do not create broad new abstractions unless inevitable; prefer existing scheduling/clinical resource screen patterns already in the app.

Tab UI guidance:
- Treat "tabs" in Tier 8 as route-backed sub-resource screens.
- Avoid building a new heavy tab UI system unless inevitable.
- Prefer existing list/detail/create/edit route patterns and simple section navigation.

Do NOT implement steps outside the selected Tier 8 step(s).

---

## Backend Reality Check (Mandatory)

- Treat `hms-backend/src/app/router.js` + listed Tier 8 module route files as source of truth.
- Use only mounted top-level resources for selected Tier 8 routes:
  - `/api/v1/lab-tests`
  - `/api/v1/lab-panels`
  - `/api/v1/lab-orders`
  - `/api/v1/lab-samples`
  - `/api/v1/lab-results`
  - `/api/v1/lab-qc-logs`
  - `/api/v1/radiology-tests`
  - `/api/v1/radiology-orders`
  - `/api/v1/radiology-results`
  - `/api/v1/imaging-studies`
  - `/api/v1/pacs-links`

Respect actual filter support:
- Lab tests: `tenant_id`, `name`, `code`, `search`
- Lab panels: `tenant_id`, `name`, `code`, `search`
- Lab orders: `encounter_id`, `patient_id`, `status`, `ordered_at_from`, `ordered_at_to`, `search`
- Lab samples: `lab_order_id`, `status`
- Lab results: `lab_order_item_id`, `status`
- Lab QC logs: `lab_test_id`
- Radiology tests: `tenant_id`, `name`, `code`, `modality`, `search`
- Radiology orders: `encounter_id`, `patient_id`, `radiology_test_id`, `status`, `search`
- Radiology results: `radiology_order_id`, `status`, `search`
- Imaging studies: `radiology_order_id`, `modality`, `performed_at`
- PACS links: `imaging_study_id`, `expires_at`

Status/enum constraints that must match backend schema:
- Lab order `status`: `ORDERED`, `COLLECTED`, `IN_PROCESS`, `COMPLETED`, `CANCELLED`
- Lab sample `status`: `PENDING`, `COLLECTED`, `REJECTED`, `RECEIVED`
- Lab result `status`: `NORMAL`, `ABNORMAL`, `CRITICAL`, `PENDING`
- Radiology test `modality`: `XRAY`, `CT`, `MRI`, `ULTRASOUND`, `PET`, `OTHER`
- Radiology order `status`: `ORDERED`, `IN_PROCESS`, `COMPLETED`, `CANCELLED`
- Radiology result `status`: `DRAFT`, `FINAL`, `AMENDED`
- Imaging study `modality`: `XRAY`, `CT`, `MRI`, `ULTRASOUND`, `PET`, `OTHER`

Non-enum note:
- Lab QC log `status` is free text (`string`, max 80), not a fixed enum.

Do not call frontend endpoint constants that are not mounted by backend routes.
Do not invent nested shortcut endpoints such as:
- `/api/v1/diagnostics/lab-tests`
- `/api/v1/lab-orders/:id/samples`
- `/api/v1/lab-orders/:id/results`
- `/api/v1/radiology-orders/:id/results`
- `/api/v1/radiology-orders/:id/imaging-studies`
- `/api/v1/imaging-studies/:id/pacs-links`

Out-of-scope mounted resources for this command unless explicitly selected as dependency wiring:
- `/api/v1/lab-order-items`
- `/api/v1/imaging-assets`

If backend support does not exist for a selected write action, provide read-only/informational UX and block unsupported writes.

---

## Backend Change Policy (Mandatory)

- Modify backend only when strictly required for selected Tier 8 step(s).
- Any backend modification must follow `hms-backend/.cursor/rules/*`.
- Preserve backend architecture and conventions (versioned routing, module structure, validation, response format, auth/security, tests).
- Do not introduce ad-hoc backend behavior that bypasses established module patterns.

---

## Access Control (Mandatory)

- Enforce access using existing auth/session and role-feature hooks/utilities/patterns already used in the app.
- Use one source of truth per selected module for auth/session + role-feature access.
- Apply access checks to both:
  - UI actions (view/create/edit/delete/retry and action endpoints where applicable)
  - Route navigation (including direct deep links to selected Tier 8 routes)
- Never rely on UI hiding alone; route-level protection must prevent unauthorized access.
- Block unauthorized data actions before API calls and handle backend `401/403` responses with clear feedback.
- For unauthorized routes, redirect to nearest allowed main route and preserve safe navigation.

---

## Navigation + Routing Accessibility (Mandatory)

- Use semantic links for navigation and semantic buttons for actions; no clickable non-semantic containers.
- Ensure current location is perceivable via visible and accessible state.
- For visible-but-blocked actions, use `aria-disabled="true"` on web, prevent execution, and provide an accessible reason.
- Ensure keyboard navigation order, focus visibility, and focus restoration after submit/redirect/error.
- Provide screen-reader friendly feedback for loading, errors, denied actions, and successful actions.

---

## Layout Rules (Strict)

- Reuse existing Main Layout and route-group layout patterns for selected diagnostics groups.
- If `(main)/diagnostics` group/layout is missing, create it using existing composition patterns (no redesign).
- No layout redesign.
- No nested scroll containers.
- No nested sidebars.
- Match current main/settings/dashboard/patients/scheduling/clinical screens visually and structurally.

---

## UI / UX Rules

- Clean, compact, modern UI.
- Fully responsive (mobile, tablet, desktop, web, iOS, Android).
- Clear action hierarchy.
- Human-friendly copy via i18n keys only.
- No duplicate UI.
- No oversized elements.
- No dead-end navigation.

Buttons:
- Use existing module button styles.
- Compact and consistent.

Forms:
- Clear labels and helpful placeholders.
- Inline validation messages.
- Required fields clearly indicated.
- Logical field order.
- Disable invalid submit actions while preserving accessible reason text.
- Enforce safe date-time ordering where required by backend contract, including:
  - `ordered_at_from <= ordered_at_to` (lab order list filters)
  - `collected_at <= received_at` (lab sample values when both are provided)

Tier 8 flow UX:
- Selected Tier 8 flow(s) must be self-directed for first-time staff users without a manual.
- Keep primary actions obvious and reduce cognitive load.
- Explain required relationship context in plain language (lab order, lab order item, radiology order, imaging study).
- Minimize required data entry to backend-required fields only.
- Preserve selected context while navigating between selected sub-resources.

---

## Security by Design (Mandatory)

- Apply secure-by-default behavior across selected Tier 8 screens/actions.
- Collect only data required for the selected step; do not request unnecessary sensitive data.
- Never expose secrets/tokens/PII in logs, analytics, or UI debug text.
- Prevent duplicate/replay-like submissions with pending/disabled action states.
- Validate and sanitize all route/query params before use:
  - `id`, `tenant_id`, `patient_id`, `encounter_id`, `lab_test_id`, `lab_panel_id`, `lab_order_id`, `lab_order_item_id`, `radiology_test_id`, `radiology_order_id`, `imaging_study_id`, pagination/filter values
- Use existing secure auth/session storage and request utilities.
- Enforce route/action guards before API calls, not only via UI visibility.
- For blocked/unauthorized states, show clear non-technical feedback without leaking sensitive details.

---

## Reliability

- Handle API/network errors gracefully.
- Human-readable, actionable error messages.
- Clear success/failure feedback for every supported action.
- Disable duplicate submissions while pending.
- Preserve user state where possible (filters, selected context, pagination).
- Ensure all enabled actions are fully wired to backend endpoints/contracts (no placeholders).
- Keep behavior robust but simple: prefer existing hooks/components/patterns over new abstractions.
- Use existing query/mutation patterns with proper loading, retry, cancellation, and stale-response safety.

---

## Backend Linkage (Mandatory)

Every implemented feature/action must call real backend endpoints for the selected Tier 8 step(s):

- `11.8.1` Lab (main) (`(main)/diagnostics/lab`)
  - At minimum: `GET /api/v1/lab-orders`
  - If showing summary cards, use mounted lab endpoints (`lab-tests`, `lab-panels`, `lab-samples`, `lab-results`, `lab-qc-logs`) with valid filters
  - Do not invent aggregate dashboard endpoints

- `11.8.2.1` Lab Test (`(main)/diagnostics/lab/lab-tests`)
  - `GET /api/v1/lab-tests`
  - `GET /api/v1/lab-tests/:id`
  - `POST /api/v1/lab-tests`
  - `PUT /api/v1/lab-tests/:id`
  - `DELETE /api/v1/lab-tests/:id`

- `11.8.2.2` Lab Panel (`(main)/diagnostics/lab/lab-panels`)
  - `GET /api/v1/lab-panels`
  - `GET /api/v1/lab-panels/:id`
  - `POST /api/v1/lab-panels`
  - `PUT /api/v1/lab-panels/:id`
  - `DELETE /api/v1/lab-panels/:id`

- `11.8.2.3` Lab Order (`(main)/diagnostics/lab/lab-orders`)
  - `GET /api/v1/lab-orders`
  - `GET /api/v1/lab-orders/:id`
  - `POST /api/v1/lab-orders`
  - `PUT /api/v1/lab-orders/:id`
  - `DELETE /api/v1/lab-orders/:id`

- `11.8.2.4` Lab Sample (`(main)/diagnostics/lab/lab-samples`)
  - `GET /api/v1/lab-samples`
  - `GET /api/v1/lab-samples/:id`
  - `POST /api/v1/lab-samples`
  - `PUT /api/v1/lab-samples/:id`
  - `DELETE /api/v1/lab-samples/:id`

- `11.8.2.5` Lab Result (`(main)/diagnostics/lab/lab-results`)
  - `GET /api/v1/lab-results`
  - `GET /api/v1/lab-results/:id`
  - `POST /api/v1/lab-results`
  - `PUT /api/v1/lab-results/:id`
  - `DELETE /api/v1/lab-results/:id`

- `11.8.2.6` Lab QC Log (`(main)/diagnostics/lab/lab-qc-logs`)
  - `GET /api/v1/lab-qc-logs`
  - `GET /api/v1/lab-qc-logs/:id`
  - `POST /api/v1/lab-qc-logs`
  - `PUT /api/v1/lab-qc-logs/:id`
  - `DELETE /api/v1/lab-qc-logs/:id`

- `11.8.3` Radiology (main) (`(main)/diagnostics/radiology`)
  - At minimum: `GET /api/v1/radiology-orders`
  - If showing summary cards, use mounted radiology endpoints (`radiology-tests`, `radiology-results`, `imaging-studies`, `pacs-links`) with valid filters
  - Do not invent aggregate dashboard endpoints

- `11.8.4.1` Radiology Test (`(main)/diagnostics/radiology/radiology-tests`)
  - `GET /api/v1/radiology-tests`
  - `GET /api/v1/radiology-tests/:id`
  - `POST /api/v1/radiology-tests`
  - `PUT /api/v1/radiology-tests/:id`
  - `DELETE /api/v1/radiology-tests/:id`

- `11.8.4.2` Radiology Order (`(main)/diagnostics/radiology/radiology-orders`)
  - `GET /api/v1/radiology-orders`
  - `GET /api/v1/radiology-orders/:id`
  - `POST /api/v1/radiology-orders`
  - `PUT /api/v1/radiology-orders/:id`
  - `DELETE /api/v1/radiology-orders/:id`

- `11.8.4.3` Radiology Result (`(main)/diagnostics/radiology/radiology-results`)
  - `GET /api/v1/radiology-results`
  - `GET /api/v1/radiology-results/:id`
  - `POST /api/v1/radiology-results`
  - `PUT /api/v1/radiology-results/:id`
  - `DELETE /api/v1/radiology-results/:id`

- `11.8.4.4` Imaging Study (`(main)/diagnostics/radiology/imaging-studies`)
  - `GET /api/v1/imaging-studies`
  - `GET /api/v1/imaging-studies/:id`
  - `POST /api/v1/imaging-studies`
  - `PUT /api/v1/imaging-studies/:id`
  - `DELETE /api/v1/imaging-studies/:id`

- `11.8.4.5` PACS Link (`(main)/diagnostics/radiology/pacs-links`)
  - `GET /api/v1/pacs-links`
  - `GET /api/v1/pacs-links/:id`
  - `POST /api/v1/pacs-links`
  - `PUT /api/v1/pacs-links/:id`
  - `DELETE /api/v1/pacs-links/:id`

Keep request/response fields strictly aligned with backend schema/validation rules.
Do not ship mock data, fake success states, or disconnected UI actions.
If backend intentionally lacks support for an action, expose read-only/informational UX and block unsupported writes.

All operations MUST match backend schema and endpoint behavior exactly.

---

## Constraints

Do NOT:

- Modify Tier 1, Tier 2, Tier 3, Tier 4, Tier 5, Tier 6, Tier 7, Tier 9, Tier 10, or Tier 11 screens/flows unless required by selected Tier 8 step(s)
- Change layout or routing architecture outside required Tier 8 route wiring
- Add global components or new platform patterns
- Invent backend fields, endpoints, or behaviors
- Implement screens outside selected Tier 8 step(s)

---

## Acceptance Criteria

- 100% rules compliance
- Existing layout patterns reused
- Backend-aligned functionality for selected Tier 8 step(s)
- Responsive UI with clear validation and feedback
- No nested scroll
- Screen(s) work independently and integrate with current main navigation
- Access control is enforced for actions and routes (including deep links)
- Accessibility is preserved for all states, including unauthorized/disabled states
- Selected Tier 8 flow can be completed without a manual
- Selected Tier 8 flow remains secure by default (no data leakage, no insecure shortcuts)
- All applicable features/actions are fully functional and backend-linked
- Unauthorized users cannot execute restricted actions via URL, keyboard, or direct API-triggering UI paths

---

## Deliverables

Return ONLY:

1. Screen/Page component(s) for selected Tier 8 step(s)
2. Form component(s) (if applicable)
3. API integration hook usage/updates (if applicable)
4. Validation logic (if applicable)
5. State handling logic
6. Loading + empty + error + offline UI
7. Success/failure feedback implementation
8. Navigation handlers
9. Backend contract alignment confirmation
10. Access control implementation confirmation (actions + routes)
11. Accessibility control confirmation for all states
12. Route-guard + navigation accessibility confirmation (keyboard/focus/blocked actions)
13. Action-to-backend linkage confirmation for all enabled features in selected screen(s)
14. Explicit note for any selected action intentionally read-only due to missing backend support

Do NOT include files or logic outside selected Tier 8 screen(s).
