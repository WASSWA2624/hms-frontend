{"version":3,"names":["_react","_interopRequireDefault","require","_reactNative","_reactTestRenderer","_useAsyncState","_jsxRuntime","TestComponent","_ref","onResult","api","useAsyncState","React","useEffect","describe","it","_asyncToGenerator2","default","render","jsx","v","waitFor","expect","isLoading","toBe","errorCode","toBeNull","data","act","start","succeed","ok","toEqual","fail","message","reset"],"sources":["useAsyncState.test.js"],"sourcesContent":["/**\r\n * useAsyncState Hook Tests\r\n * File: useAsyncState.test.js\r\n */\r\nimport React from 'react';\r\nimport { render, waitFor } from '@testing-library/react-native';\r\nimport { act } from 'react-test-renderer';\r\nimport useAsyncState from '@hooks/useAsyncState';\r\n\r\nconst TestComponent = ({ onResult }) => {\r\n  const api = useAsyncState();\r\n  React.useEffect(() => {\r\n    onResult(api);\r\n  });\r\n  return null;\r\n};\r\n\r\ndescribe('useAsyncState', () => {\r\n  it('initial → start → succeed', async () => {\r\n    let api;\r\n    render(<TestComponent onResult={(v) => (api = v)} />);\r\n\r\n    await waitFor(() => {\r\n      expect(api.isLoading).toBe(false);\r\n      expect(api.errorCode).toBeNull();\r\n      expect(api.data).toBeNull();\r\n    });\r\n\r\n    act(() => {\r\n      api.start();\r\n    });\r\n    await waitFor(() => expect(api.isLoading).toBe(true));\r\n\r\n    act(() => {\r\n      api.succeed({ ok: true });\r\n    });\r\n    await waitFor(() => {\r\n      expect(api.isLoading).toBe(false);\r\n      expect(api.errorCode).toBeNull();\r\n      expect(api.data).toEqual({ ok: true });\r\n    });\r\n  });\r\n\r\n  it('initial → start → fail (stores error codes only)', async () => {\r\n    let api;\r\n    render(<TestComponent onResult={(v) => (api = v)} />);\r\n\r\n    act(() => {\r\n      api.start();\r\n      api.fail('NETWORK_ERROR');\r\n    });\r\n\r\n    await waitFor(() => {\r\n      expect(api.isLoading).toBe(false);\r\n      expect(api.errorCode).toBe('NETWORK_ERROR');\r\n    });\r\n\r\n    act(() => {\r\n      api.fail({ message: 'nope' });\r\n    });\r\n\r\n    await waitFor(() => {\r\n      expect(api.errorCode).toBe('UNKNOWN_ERROR');\r\n    });\r\n  });\r\n\r\n  it('fail → reset', async () => {\r\n    let api;\r\n    render(<TestComponent onResult={(v) => (api = v)} />);\r\n\r\n    act(() => {\r\n      api.start();\r\n      api.fail('SERVER_ERROR');\r\n    });\r\n\r\n    await waitFor(() => expect(api.errorCode).toBe('SERVER_ERROR'));\r\n\r\n    act(() => {\r\n      api.reset();\r\n    });\r\n\r\n    await waitFor(() => {\r\n      expect(api.isLoading).toBe(false);\r\n      expect(api.errorCode).toBeNull();\r\n      expect(api.data).toBeNull();\r\n    });\r\n  });\r\n\r\n  it('start() is idempotent and deterministic', async () => {\r\n    let api;\r\n    render(<TestComponent onResult={(v) => (api = v)} />);\r\n\r\n    act(() => {\r\n      api.start();\r\n      api.start();\r\n    });\r\n\r\n    await waitFor(() => {\r\n      expect(api.isLoading).toBe(true);\r\n      expect(api.errorCode).toBeNull();\r\n    });\r\n  });\r\n});\r\n\r\n"],"mappings":"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","ignoreList":[]}