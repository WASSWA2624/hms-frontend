67aad3d5f21555cb56790bb6b0559d71
var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault").default;
var _react = _interopRequireDefault(require("react"));
var _reactRedux = require("react-redux");
var _toolkit = require("@reduxjs/toolkit");
var _reactNative = require("@testing-library/react-native");
var _rootReducer = _interopRequireDefault(require("../../store/rootReducer"));
var _useAuth = _interopRequireDefault(require("../../hooks/useAuth"));
var _jsxRuntime = require("react/jsx-runtime");
var TestComponent = function TestComponent(_ref) {
  var onResult = _ref.onResult;
  var result = (0, _useAuth.default)();
  _react.default.useEffect(function () {
    onResult(result);
  }, [onResult, result]);
  return null;
};
var createStore = function createStore() {
  var preloadedState = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
  return (0, _toolkit.configureStore)({
    reducer: _rootReducer.default,
    preloadedState: Object.assign({
      ui: {
        theme: 'light',
        locale: 'en',
        isLoading: false
      },
      network: {
        isOnline: true
      },
      auth: {
        user: null,
        isAuthenticated: false,
        isLoading: false,
        errorCode: null,
        lastUpdated: null
      }
    }, preloadedState)
  });
};
describe('useAuth', function () {
  it('returns defaults when unauthenticated', function () {
    var store = createStore();
    var result;
    (0, _reactNative.render)((0, _jsxRuntime.jsx)(_reactRedux.Provider, {
      store: store,
      children: (0, _jsxRuntime.jsx)(TestComponent, {
        onResult: function onResult(value) {
          return result = value;
        }
      })
    }));
    expect(result.isAuthenticated).toBe(false);
    expect(result.user).toBeNull();
    expect(result.roles).toEqual([]);
    expect(result.role).toBeNull();
  });
  it('returns normalized roles when authenticated', function () {
    var store = createStore({
      auth: {
        user: {
          id: '1',
          role: 'Patient',
          roles: ['Patient', 'Admin']
        },
        isAuthenticated: true,
        isLoading: false,
        errorCode: null,
        lastUpdated: null
      }
    });
    var result;
    (0, _reactNative.render)((0, _jsxRuntime.jsx)(_reactRedux.Provider, {
      store: store,
      children: (0, _jsxRuntime.jsx)(TestComponent, {
        onResult: function onResult(value) {
          return result = value;
        }
      })
    }));
    expect(result.isAuthenticated).toBe(true);
    expect(result.user).toMatchObject({
      id: '1'
    });
    expect(result.roles).toEqual(['patient', 'admin']);
    expect(result.role).toBe('patient');
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfcmVhY3QiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl9yZWFjdFJlZHV4IiwiX3Rvb2xraXQiLCJfcmVhY3ROYXRpdmUiLCJfcm9vdFJlZHVjZXIiLCJfdXNlQXV0aCIsIl9qc3hSdW50aW1lIiwiVGVzdENvbXBvbmVudCIsIl9yZWYiLCJvblJlc3VsdCIsInJlc3VsdCIsInVzZUF1dGgiLCJSZWFjdCIsInVzZUVmZmVjdCIsImNyZWF0ZVN0b3JlIiwicHJlbG9hZGVkU3RhdGUiLCJhcmd1bWVudHMiLCJsZW5ndGgiLCJ1bmRlZmluZWQiLCJjb25maWd1cmVTdG9yZSIsInJlZHVjZXIiLCJyb290UmVkdWNlciIsIk9iamVjdCIsImFzc2lnbiIsInVpIiwidGhlbWUiLCJsb2NhbGUiLCJpc0xvYWRpbmciLCJuZXR3b3JrIiwiaXNPbmxpbmUiLCJhdXRoIiwidXNlciIsImlzQXV0aGVudGljYXRlZCIsImVycm9yQ29kZSIsImxhc3RVcGRhdGVkIiwiZGVzY3JpYmUiLCJpdCIsInN0b3JlIiwicmVuZGVyIiwianN4IiwiUHJvdmlkZXIiLCJjaGlsZHJlbiIsInZhbHVlIiwiZXhwZWN0IiwidG9CZSIsInRvQmVOdWxsIiwicm9sZXMiLCJ0b0VxdWFsIiwicm9sZSIsImlkIiwidG9NYXRjaE9iamVjdCJdLCJzb3VyY2VzIjpbInVzZUF1dGgudGVzdC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogdXNlQXV0aCBIb29rIFRlc3RzXHJcbiAqIEZpbGU6IHVzZUF1dGgudGVzdC5qc1xyXG4gKi9cclxuaW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0JztcclxuaW1wb3J0IHsgUHJvdmlkZXIgfSBmcm9tICdyZWFjdC1yZWR1eCc7XHJcbmltcG9ydCB7IGNvbmZpZ3VyZVN0b3JlIH0gZnJvbSAnQHJlZHV4anMvdG9vbGtpdCc7XHJcbmltcG9ydCB7IHJlbmRlciB9IGZyb20gJ0B0ZXN0aW5nLWxpYnJhcnkvcmVhY3QtbmF0aXZlJztcclxuaW1wb3J0IHJvb3RSZWR1Y2VyIGZyb20gJ0BzdG9yZS9yb290UmVkdWNlcic7XHJcbmltcG9ydCB1c2VBdXRoIGZyb20gJ0Bob29rcy91c2VBdXRoJztcclxuXHJcbmNvbnN0IFRlc3RDb21wb25lbnQgPSAoeyBvblJlc3VsdCB9KSA9PiB7XHJcbiAgY29uc3QgcmVzdWx0ID0gdXNlQXV0aCgpO1xyXG4gIFJlYWN0LnVzZUVmZmVjdCgoKSA9PiB7XHJcbiAgICBvblJlc3VsdChyZXN1bHQpO1xyXG4gIH0sIFtvblJlc3VsdCwgcmVzdWx0XSk7XHJcbiAgcmV0dXJuIG51bGw7XHJcbn07XHJcblxyXG5jb25zdCBjcmVhdGVTdG9yZSA9IChwcmVsb2FkZWRTdGF0ZSA9IHt9KSA9PlxyXG4gIGNvbmZpZ3VyZVN0b3JlKHtcclxuICAgIHJlZHVjZXI6IHJvb3RSZWR1Y2VyLFxyXG4gICAgcHJlbG9hZGVkU3RhdGU6IHtcclxuICAgICAgdWk6IHtcclxuICAgICAgICB0aGVtZTogJ2xpZ2h0JyxcclxuICAgICAgICBsb2NhbGU6ICdlbicsXHJcbiAgICAgICAgaXNMb2FkaW5nOiBmYWxzZSxcclxuICAgICAgfSxcclxuICAgICAgbmV0d29yazoge1xyXG4gICAgICAgIGlzT25saW5lOiB0cnVlLFxyXG4gICAgICB9LFxyXG4gICAgICBhdXRoOiB7XHJcbiAgICAgICAgdXNlcjogbnVsbCxcclxuICAgICAgICBpc0F1dGhlbnRpY2F0ZWQ6IGZhbHNlLFxyXG4gICAgICAgIGlzTG9hZGluZzogZmFsc2UsXHJcbiAgICAgICAgZXJyb3JDb2RlOiBudWxsLFxyXG4gICAgICAgIGxhc3RVcGRhdGVkOiBudWxsLFxyXG4gICAgICB9LFxyXG4gICAgICAuLi5wcmVsb2FkZWRTdGF0ZSxcclxuICAgIH0sXHJcbiAgfSk7XHJcblxyXG5kZXNjcmliZSgndXNlQXV0aCcsICgpID0+IHtcclxuICBpdCgncmV0dXJucyBkZWZhdWx0cyB3aGVuIHVuYXV0aGVudGljYXRlZCcsICgpID0+IHtcclxuICAgIGNvbnN0IHN0b3JlID0gY3JlYXRlU3RvcmUoKTtcclxuICAgIGxldCByZXN1bHQ7XHJcbiAgICByZW5kZXIoXHJcbiAgICAgIDxQcm92aWRlciBzdG9yZT17c3RvcmV9PlxyXG4gICAgICAgIDxUZXN0Q29tcG9uZW50IG9uUmVzdWx0PXsodmFsdWUpID0+IChyZXN1bHQgPSB2YWx1ZSl9IC8+XHJcbiAgICAgIDwvUHJvdmlkZXI+XHJcbiAgICApO1xyXG4gICAgZXhwZWN0KHJlc3VsdC5pc0F1dGhlbnRpY2F0ZWQpLnRvQmUoZmFsc2UpO1xyXG4gICAgZXhwZWN0KHJlc3VsdC51c2VyKS50b0JlTnVsbCgpO1xyXG4gICAgZXhwZWN0KHJlc3VsdC5yb2xlcykudG9FcXVhbChbXSk7XHJcbiAgICBleHBlY3QocmVzdWx0LnJvbGUpLnRvQmVOdWxsKCk7XHJcbiAgfSk7XHJcblxyXG4gIGl0KCdyZXR1cm5zIG5vcm1hbGl6ZWQgcm9sZXMgd2hlbiBhdXRoZW50aWNhdGVkJywgKCkgPT4ge1xyXG4gICAgY29uc3Qgc3RvcmUgPSBjcmVhdGVTdG9yZSh7XHJcbiAgICAgIGF1dGg6IHtcclxuICAgICAgICB1c2VyOiB7XHJcbiAgICAgICAgICBpZDogJzEnLFxyXG4gICAgICAgICAgcm9sZTogJ1BhdGllbnQnLFxyXG4gICAgICAgICAgcm9sZXM6IFsnUGF0aWVudCcsICdBZG1pbiddLFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgaXNBdXRoZW50aWNhdGVkOiB0cnVlLFxyXG4gICAgICAgIGlzTG9hZGluZzogZmFsc2UsXHJcbiAgICAgICAgZXJyb3JDb2RlOiBudWxsLFxyXG4gICAgICAgIGxhc3RVcGRhdGVkOiBudWxsLFxyXG4gICAgICB9LFxyXG4gICAgfSk7XHJcbiAgICBsZXQgcmVzdWx0O1xyXG4gICAgcmVuZGVyKFxyXG4gICAgICA8UHJvdmlkZXIgc3RvcmU9e3N0b3JlfT5cclxuICAgICAgICA8VGVzdENvbXBvbmVudCBvblJlc3VsdD17KHZhbHVlKSA9PiAocmVzdWx0ID0gdmFsdWUpfSAvPlxyXG4gICAgICA8L1Byb3ZpZGVyPlxyXG4gICAgKTtcclxuICAgIGV4cGVjdChyZXN1bHQuaXNBdXRoZW50aWNhdGVkKS50b0JlKHRydWUpO1xyXG4gICAgZXhwZWN0KHJlc3VsdC51c2VyKS50b01hdGNoT2JqZWN0KHsgaWQ6ICcxJyB9KTtcclxuICAgIGV4cGVjdChyZXN1bHQucm9sZXMpLnRvRXF1YWwoWydwYXRpZW50JywgJ2FkbWluJ10pO1xyXG4gICAgZXhwZWN0KHJlc3VsdC5yb2xlKS50b0JlKCdwYXRpZW50Jyk7XHJcbiAgfSk7XHJcbn0pO1xyXG4iXSwibWFwcGluZ3MiOiI7QUFJQSxJQUFBQSxNQUFBLEdBQUFDLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBQyxXQUFBLEdBQUFELE9BQUE7QUFDQSxJQUFBRSxRQUFBLEdBQUFGLE9BQUE7QUFDQSxJQUFBRyxZQUFBLEdBQUFILE9BQUE7QUFDQSxJQUFBSSxZQUFBLEdBQUFMLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBSyxRQUFBLEdBQUFOLHNCQUFBLENBQUFDLE9BQUE7QUFBcUMsSUFBQU0sV0FBQSxHQUFBTixPQUFBO0FBRXJDLElBQU1PLGFBQWEsR0FBRyxTQUFoQkEsYUFBYUEsQ0FBQUMsSUFBQSxFQUFxQjtFQUFBLElBQWZDLFFBQVEsR0FBQUQsSUFBQSxDQUFSQyxRQUFRO0VBQy9CLElBQU1DLE1BQU0sR0FBRyxJQUFBQyxnQkFBTyxFQUFDLENBQUM7RUFDeEJDLGNBQUssQ0FBQ0MsU0FBUyxDQUFDLFlBQU07SUFDcEJKLFFBQVEsQ0FBQ0MsTUFBTSxDQUFDO0VBQ2xCLENBQUMsRUFBRSxDQUFDRCxRQUFRLEVBQUVDLE1BQU0sQ0FBQyxDQUFDO0VBQ3RCLE9BQU8sSUFBSTtBQUNiLENBQUM7QUFFRCxJQUFNSSxXQUFXLEdBQUcsU0FBZEEsV0FBV0EsQ0FBQTtFQUFBLElBQUlDLGNBQWMsR0FBQUMsU0FBQSxDQUFBQyxNQUFBLFFBQUFELFNBQUEsUUFBQUUsU0FBQSxHQUFBRixTQUFBLE1BQUcsQ0FBQyxDQUFDO0VBQUEsT0FDdEMsSUFBQUcs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