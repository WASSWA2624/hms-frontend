{"version":3,"names":["_getJestObj","mock","loginApi","jest","fn","logoutApi","refreshApi","registerApi","getCurrentUserApi","verifyEmailApi","verifyPhoneApi","resendVerificationApi","forgotPasswordApi","resetPasswordApi","changePasswordApi","tokenManager","setTokens","clearTokens","getRefreshToken","_interopRequireDefault","require","default","_asyncToGenerator2","_auth","_security","_auth2","_require","describe","beforeEach","mockResolvedValue","data","user","id","tokens","accessToken","refreshToken","it","loginUseCase","email","password","tenant_id","expect","toEqual","toHaveBeenCalledWith","registerUseCase","current","loadCurrentUserUseCase","refreshSessionUseCase","logoutUseCase","toHaveBeenCalled","mockRejectedValueOnce","code","rejects","toMatchObject"],"sources":["auth.usecase.test.js"],"sourcesContent":["/**\r\n * Auth Use Case Tests\r\n * File: auth.usecase.test.js\r\n */\r\nimport {\r\n  loginUseCase,\r\n  logoutUseCase,\r\n  refreshSessionUseCase,\r\n  registerUseCase,\r\n  loadCurrentUserUseCase,\r\n} from '@features/auth';\r\nimport { tokenManager } from '@security';\r\nimport {\r\n  loginApi,\r\n  logoutApi,\r\n  refreshApi,\r\n  registerApi,\r\n  getCurrentUserApi,\r\n} from '@features/auth/auth.api';\r\n\r\njest.mock('@features/auth/auth.api', () => ({\r\n  loginApi: jest.fn(),\r\n  logoutApi: jest.fn(),\r\n  refreshApi: jest.fn(),\r\n  registerApi: jest.fn(),\r\n  getCurrentUserApi: jest.fn(),\r\n  verifyEmailApi: jest.fn(),\r\n  verifyPhoneApi: jest.fn(),\r\n  resendVerificationApi: jest.fn(),\r\n  forgotPasswordApi: jest.fn(),\r\n  resetPasswordApi: jest.fn(),\r\n  changePasswordApi: jest.fn(),\r\n}));\r\n\r\njest.mock('@security', () => ({\r\n  tokenManager: {\r\n    setTokens: jest.fn(),\r\n    clearTokens: jest.fn(),\r\n    getRefreshToken: jest.fn(),\r\n  },\r\n}));\r\n\r\ndescribe('auth.usecase', () => {\r\n  beforeEach(() => {\r\n    loginApi.mockResolvedValue({ data: { user: { id: '1' }, tokens: { accessToken: 'a', refreshToken: 'b' } } });\r\n    registerApi.mockResolvedValue({ data: { user: { id: '2' } } });\r\n    logoutApi.mockResolvedValue({ data: {} });\r\n    refreshApi.mockResolvedValue({ data: { tokens: { accessToken: 'a', refreshToken: 'b' } } });\r\n    getCurrentUserApi.mockResolvedValue({ data: { user: { id: '3' } } });\r\n    tokenManager.setTokens.mockResolvedValue(true);\r\n    tokenManager.clearTokens.mockResolvedValue(true);\r\n    tokenManager.getRefreshToken.mockResolvedValue('refresh');\r\n  });\r\n\r\n  it('logs in and stores tokens', async () => {\r\n    const user = await loginUseCase({\r\n      email: 'user@example.com',\r\n      password: 'pass',\r\n      tenant_id: '550e8400-e29b-41d4-a716-446655440000'\r\n    });\r\n    expect(user).toEqual({ id: '1' });\r\n    expect(tokenManager.setTokens).toHaveBeenCalledWith('a', 'b');\r\n  });\r\n\r\n  it('registers and loads current user', async () => {\r\n    const user = await registerUseCase({ email: 'user' });\r\n    expect(user).toEqual({ id: '2' });\r\n    const current = await loadCurrentUserUseCase();\r\n    expect(current).toEqual({ id: '3' });\r\n  });\r\n\r\n  it('refreshes session and logs out', async () => {\r\n    const tokens = await refreshSessionUseCase();\r\n    expect(tokens).toEqual({ accessToken: 'a', refreshToken: 'b' });\r\n    await logoutUseCase();\r\n    expect(tokenManager.clearTokens).toHaveBeenCalled();\r\n  });\r\n\r\n  it('throws normalized errors', async () => {\r\n    loginApi.mockRejectedValueOnce({ code: 'UNAUTHORIZED' });\r\n    await expect(loginUseCase({\r\n      email: 'user@example.com',\r\n      password: 'pass',\r\n      tenant_id: '550e8400-e29b-41d4-a716-446655440000'\r\n    })).rejects.toMatchObject({\r\n      code: 'UNAUTHORIZED',\r\n    });\r\n  });\r\n});\r\n"],"mappings":"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","ignoreList":[]}