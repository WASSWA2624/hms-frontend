562480c8afe9021a87c9eaee8b34cbac
var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault").default;
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.runCrudUsecaseTests = void 0;
var _toConsumableArray2 = _interopRequireDefault(require("@babel/runtime/helpers/toConsumableArray"));
var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));
var runCrudUsecaseTests = exports.runCrudUsecaseTests = function runCrudUsecaseTests(_ref, _ref2) {
  var list = _ref.list,
    get = _ref.get,
    create = _ref.create,
    update = _ref.update,
    remove = _ref.remove,
    _ref$extraActions = _ref.extraActions,
    extraActions = _ref$extraActions === void 0 ? [] : _ref$extraActions;
  var queueRequestIfOffline = _ref2.queueRequestIfOffline,
    _ref2$payload = _ref2.payload,
    payload = _ref2$payload === void 0 ? {
      name: 'value'
    } : _ref2$payload,
    _ref2$id = _ref2.id,
    id = _ref2$id === void 0 ? '1' : _ref2$id,
    _ref2$listParams = _ref2.listParams,
    listParams = _ref2$listParams === void 0 ? {
      page: 1
    } : _ref2$listParams;
  it('runs online usecases', (0, _asyncToGenerator2.default)(function* () {
    queueRequestIfOffline.mockResolvedValue(false);
    if (list) {
      yield expect(list(listParams)).resolves.toBeDefined();
      yield expect(list()).resolves.toBeDefined();
    }
    if (get) {
      yield expect(get(id)).resolves.toBeDefined();
    }
    if (create) {
      yield expect(create(payload)).resolves.toBeDefined();
    }
    if (update) {
      yield expect(update(id, payload)).resolves.toBeDefined();
    }
    if (remove) {
      yield expect(remove(id)).resolves.toBeDefined();
    }
    for (var action of extraActions) {
      yield expect(action.fn.apply(action, (0, _toConsumableArray2.default)(action.args || []))).resolves.toBeDefined();
    }
  }));
  it('queues offline writes', (0, _asyncToGenerator2.default)(function* () {
    queueRequestIfOffline.mockResolvedValue(true);
    if (create) {
      yield expect(create(payload)).resolves.toEqual(payload);
    }
    if (update) {
      yield expect(update(id, payload)).resolves.toEqual(Object.assign({
        id: id
      }, payload));
    }
    if (remove) {
      yield expect(remove(id)).resolves.toEqual({
        id: id
      });
    }
  }));
  if (get) {
    it('rejects invalid ids', (0, _asyncToGenerator2.default)(function* () {
      yield expect(get(null)).rejects.toBeDefined();
    }));
  }
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJydW5DcnVkVXNlY2FzZVRlc3RzIiwiZXhwb3J0cyIsIl9yZWYiLCJfcmVmMiIsImxpc3QiLCJnZXQiLCJjcmVhdGUiLCJ1cGRhdGUiLCJyZW1vdmUiLCJfcmVmJGV4dHJhQWN0aW9ucyIsImV4dHJhQWN0aW9ucyIsInF1ZXVlUmVxdWVzdElmT2ZmbGluZSIsIl9yZWYyJHBheWxvYWQiLCJwYXlsb2FkIiwibmFtZSIsIl9yZWYyJGlkIiwiaWQiLCJfcmVmMiRsaXN0UGFyYW1zIiwibGlzdFBhcmFtcyIsInBhZ2UiLCJpdCIsIl9hc3luY1RvR2VuZXJhdG9yMiIsImRlZmF1bHQiLCJtb2NrUmVzb2x2ZWRWYWx1ZSIsImV4cGVjdCIsInJlc29sdmVzIiwidG9CZURlZmluZWQiLCJhY3Rpb24iLCJmbiIsImFwcGx5IiwiX3RvQ29uc3VtYWJsZUFycmF5MiIsImFyZ3MiLCJ0b0VxdWFsIiwiT2JqZWN0IiwiYXNzaWduIiwicmVqZWN0cyJdLCJzb3VyY2VzIjpbImNydWQtdXNlY2FzZS1ydW5uZXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIENSVUQgVXNlY2FzZSBUZXN0IEhlbHBlcnNcclxuICogRmlsZTogY3J1ZC11c2VjYXNlLXJ1bm5lci5qc1xyXG4gKi9cclxuY29uc3QgcnVuQ3J1ZFVzZWNhc2VUZXN0cyA9IChcclxuICB7XHJcbiAgICBsaXN0LFxyXG4gICAgZ2V0LFxyXG4gICAgY3JlYXRlLFxyXG4gICAgdXBkYXRlLFxyXG4gICAgcmVtb3ZlLFxyXG4gICAgZXh0cmFBY3Rpb25zID0gW10sXHJcbiAgfSxcclxuICB7XHJcbiAgICBxdWV1ZVJlcXVlc3RJZk9mZmxpbmUsXHJcbiAgICBwYXlsb2FkID0geyBuYW1lOiAndmFsdWUnIH0sXHJcbiAgICBpZCA9ICcxJyxcclxuICAgIGxpc3RQYXJhbXMgPSB7IHBhZ2U6IDEgfSxcclxuICB9XHJcbikgPT4ge1xyXG4gIGl0KCdydW5zIG9ubGluZSB1c2VjYXNlcycsIGFzeW5jICgpID0+IHtcclxuICAgIHF1ZXVlUmVxdWVzdElmT2ZmbGluZS5tb2NrUmVzb2x2ZWRWYWx1ZShmYWxzZSk7XHJcblxyXG4gICAgaWYgKGxpc3QpIHtcclxuICAgICAgYXdhaXQgZXhwZWN0KGxpc3QobGlzdFBhcmFtcykpLnJlc29sdmVzLnRvQmVEZWZpbmVkKCk7XHJcbiAgICAgIGF3YWl0IGV4cGVjdChsaXN0KCkpLnJlc29sdmVzLnRvQmVEZWZpbmVkKCk7XHJcbiAgICB9XHJcbiAgICBpZiAoZ2V0KSB7XHJcbiAgICAgIGF3YWl0IGV4cGVjdChnZXQoaWQpKS5yZXNvbHZlcy50b0JlRGVmaW5lZCgpO1xyXG4gICAgfVxyXG4gICAgaWYgKGNyZWF0ZSkge1xyXG4gICAgICBhd2FpdCBleHBlY3QoY3JlYXRlKHBheWxvYWQpKS5yZXNvbHZlcy50b0JlRGVmaW5lZCgpO1xyXG4gICAgfVxyXG4gICAgaWYgKHVwZGF0ZSkge1xyXG4gICAgICBhd2FpdCBleHBlY3QodXBkYXRlKGlkLCBwYXlsb2FkKSkucmVzb2x2ZXMudG9CZURlZmluZWQoKTtcclxuICAgIH1cclxuICAgIGlmIChyZW1vdmUpIHtcclxuICAgICAgYXdhaXQgZXhwZWN0KHJlbW92ZShpZCkpLnJlc29sdmVzLnRvQmVEZWZpbmVkKCk7XHJcbiAgICB9XHJcblxyXG4gICAgZm9yIChjb25zdCBhY3Rpb24gb2YgZXh0cmFBY3Rpb25zKSB7XHJcbiAgICAgIGF3YWl0IGV4cGVjdChhY3Rpb24uZm4oLi4uKGFjdGlvbi5hcmdzIHx8IFtdKSkpLnJlc29sdmVzLnRvQmVEZWZpbmVkKCk7XHJcbiAgICB9XHJcbiAgfSk7XHJcblxyXG4gIGl0KCdxdWV1ZXMgb2ZmbGluZSB3cml0ZXMnLCBhc3luYyAoKSA9PiB7XHJcbiAgICBxdWV1ZVJlcXVlc3RJZk9mZmxpbmUubW9ja1Jlc29sdmVkVmFsdWUodHJ1ZSk7XHJcblxyXG4gICAgaWYgKGNyZWF0ZSkge1xyXG4gICAgICBhd2FpdCBleHBlY3QoY3JlYXRlKHBheWxvYWQpKS5yZXNvbHZlcy50b0VxdWFsKHBheWxvYWQpO1xyXG4gICAgfVxyXG4gICAgaWYgKHVwZGF0ZSkge1xyXG4gICAgICBhd2FpdCBleHBlY3QodXBkYXRlKGlkLCBwYXlsb2FkKSkucmVzb2x2ZXMudG9FcXVhbCh7IGlkLCAuLi5wYXlsb2FkIH0pO1xyXG4gICAgfVxyXG4gICAgaWYgKHJlbW92ZSkge1xyXG4gICAgICBhd2FpdCBleHBlY3QocmVtb3ZlKGlkKSkucmVzb2x2ZXMudG9FcXVhbCh7IGlkIH0pO1xyXG4gICAgfVxyXG4gIH0pO1xyXG5cclxuICBpZiAoZ2V0KSB7XHJcbiAgICBpdCgncmVqZWN0cyBpbnZhbGlkIGlkcycsIGFzeW5jICgpID0+IHtcclxuICAgICAgYXdhaXQgZXhwZWN0KGdldChudWxsKSkucmVqZWN0cy50b0JlRGVmaW5lZCgpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG59O1xyXG5cclxuZXhwb3J0IHsgcnVuQ3J1ZFVzZWNhc2VUZXN0cyB9O1xyXG4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFJQSxJQUFNQSxtQkFBbUIsR0FBQUMsT0FBQSxDQUFBRCxtQkFBQSxHQUFHLFNBQXRCQSxtQkFBbUJBLENBQUFFLElBQUEsRUFBQUMsS0FBQSxFQWVwQjtFQUFBLElBYkRDLElBQUksR0FBQUYsSUFBQSxDQUFKRSxJQUFJO0lBQ0pDLEdBQUcsR0FBQUgsSUFBQSxDQUFIRyxHQUFHO0lBQ0hDLE1BQU0sR0FBQUosSUFBQSxDQUFOSSxNQUFNO0lBQ05DLE1BQU0sR0FBQUwsSUFBQSxDQUFOSyxNQUFNO0lBQ05DLE1BQU0sR0FBQU4sSUFBQSxDQUFOTSxNQUFNO0lBQUFDLGlCQUFBLEdBQUFQLElBQUEsQ0FDTlEsWUFBWTtJQUFaQSxZQUFZLEdBQUFELGlCQUFBLGNBQUcsRUFBRSxHQUFBQSxpQkFBQTtFQUFBLElBR2pCRSxxQkFBcUIsR0FBQVIsS0FBQSxDQUFyQlEscUJBQXFCO0lBQUFDLGFBQUEsR0FBQVQsS0FBQSxDQUNyQlUsT0FBTztJQUFQQSxPQUFPLEdBQUFELGFBQUEsY0FBRztNQUFFRSxJQUFJLEVBQUU7SUFB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