49e2f6890209864d4c8e99f6f40ab1f2
var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault").default;
var _interopRequireWildcard = require("@babel/runtime/helpers/interopRequireWildcard").default;
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
var _slicedToArray2 = _interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));
var _objectWithoutProperties2 = _interopRequireDefault(require("@babel/runtime/helpers/objectWithoutProperties"));
var _react = _interopRequireWildcard(require("react"));
var _expoRouter = require("expo-router");
var _Text = _interopRequireDefault(require("../../display/Text"));
var _Badge = _interopRequireDefault(require("../../display/Badge"));
var _ = require("../..");
var _hooks = require("../../../../hooks");
var _useSidebar2 = _interopRequireDefault(require("./useSidebar"));
var _SidebarWeb = require("./Sidebar.web.styles");
var _jsxRuntime = require("react/jsx-runtime");
var _excluded = ["items", "collapsed", "onItemPress", "isItemVisible", "accessibilityLabel", "testID", "className", "style"];
var SidebarWeb = function SidebarWeb(_ref) {
  var _ref$items = _ref.items,
    items = _ref$items === void 0 ? [] : _ref$items,
    _ref$collapsed = _ref.collapsed,
    collapsed = _ref$collapsed === void 0 ? false : _ref$collapsed,
    onItemPress = _ref.onItemPress,
    isItemVisible = _ref.isItemVisible,
    accessibilityLabel = _ref.accessibilityLabel,
    testID = _ref.testID,
    className = _ref.className,
    style = _ref.style,
    rest = (0, _objectWithoutProperties2.default)(_ref, _excluded);
  var _useI18n = (0, _hooks.useI18n)(),
    t = _useI18n.t;
  var router = (0, _expoRouter.useRouter)();
  var _useSidebar = (0, _useSidebar2.default)({
      items: items,
      onItemPress: onItemPress || function (item) {
        if (item.href) {
          router.push(item.href);
        } else if (item.onPress) {
          item.onPress(item);
        }
      },
      isItemVisible: isItemVisible
    }),
    expandedSections = _useSidebar.expandedSections,
    isItemActive = _useSidebar.isItemActive,
    toggleSection = _useSidebar.toggleSection,
    hookHandleItemPress = _useSidebar.handleItemPress,
    filteredItems = _useSidebar.filteredItems;
  var handlePress = function handlePress(item) {
    if (onItemPress) {
      onItemPress(item);
    } else {
      hookHandleItemPress(item);
    }
  };
  var handleItemKeyDown = function handleItemKeyDown(event, item) {
    if (event.key === 'Enter' || event.key === ' ') {
      event.preventDefault();
      if (item.children && item.children.length > 0) {
        toggleSection(item.id);
      } else {
        handlePress(item);
      }
    }
  };
  var _renderNavItem = function renderNavItem(item) {
    var level = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;
    var hasChildren = item.children && item.children.length > 0;
    var isActive = isItemActive(item);
    var isExpanded = expandedSections[item.id] || false;
    return (0, _jsxRuntime.jsxs)(_react.default.Fragment, {
      children: [(0, _jsxRuntime.jsx)(_SidebarWeb.StyledNavItem, {
        level: level,
        active: isActive,
        onPress: function onPress() {
          if (hasChildren) {
            toggleSection(item.id);
          } else {
            handlePress(item);
          }
        },
        onKeyDown: function onKeyDown(event) {
          return handleItemKeyDown(event, item);
        },
        tabIndex: 0,
        accessibilityRole: "button",
        accessibilityLabel: item.label,
        accessibilityState: {
          selected: isActive
        },
        testID: testID ? `${testID}-item-${item.id}` : undefined,
        children: (0, _jsxRuntime.jsxs)(_SidebarWeb.StyledNavItemContent, {
          children: [item.icon && (0, _jsxRuntime.jsx)(_SidebarWeb.StyledNavItemIcon, {
            children: item.icon
          }), !collapsed && (0, _jsxRuntime.jsxs)(_jsxRuntime.Fragment, {
            children: [(0, _jsxRuntime.jsx)(_SidebarWeb.StyledNavItemLabel, {
              active: isActive,
              children: item.label
            }), item.badge && (0, _jsxRuntime.jsx)(_SidebarWeb.StyledNavItemBadge, {
              children: (0, _jsxRuntime.jsx)(_Badge.default, {
                variant: "primary",
                size: "small",
                children: item.badgeCount || ''
              })
            }), hasChildren && (0, _jsxRuntime.jsx)(_SidebarWeb.StyledExpandIcon, {
              expanded: isExpanded,
              children: "\u25BC"
            })]
          })]
        })
      }), hasChildren && isExpanded && !collapsed && (0, _jsxRuntime.jsx)(_SidebarWeb.StyledNavItemChildren, {
        children: item.children.map(function (child) {
          return _renderNavItem(child, level + 1);
        })
      })]
    }, item.id);
  };
  var groupedItems = (0, _react.useMemo)(function () {
    var groups = {};
    filteredItems.forEach(function (item) {
      var group = item.group || 'main';
      if (!groups[group]) {
        groups[group] = [];
      }
      groups[group].push(item);
    });
    return groups;
  }, [filteredItems]);
  return (0, _jsxRuntime.jsx)(_SidebarWeb.StyledSidebar, Object.assign({
    collapsed: collapsed,
    accessibilityRole: "navigation",
    accessibilityLabel: accessibilityLabel || t('navigation.sidebar.title'),
    testID: testID,
    className: className,
    style: style
  }, rest, {
    children: (0, _jsxRuntime.jsx)(_SidebarWeb.StyledSidebarContent, {
      children: Object.entries(groupedItems).map(function (_ref2) {
        var _ref3 = (0, _slicedToArray2.default)(_ref2, 2),
          groupName = _ref3[0],
          groupItems = _ref3[1];
        return (0, _jsxRuntime.jsxs)(_SidebarWeb.StyledNavSection, {
          children: [!collapsed && groupName !== 'main' && (0, _jsxRuntime.jsx)(_SidebarWeb.StyledNavSectionHeader, {
            children: (0, _jsxRuntime.jsx)(_SidebarWeb.StyledNavSectionTitle, {
              children: groupName
            })
          }), groupItems.map(function (item) {
            return _renderNavItem(item);
          }), groupName !== 'main' && (0, _jsxRuntime.jsx)(_.Divider, {})]
        }, groupName);
      })
    })
  }));
};
var _default = exports.default = SidebarWeb;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfcmVhY3QiLCJfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZCIsInJlcXVpcmUiLCJfZXhwb1JvdXRlciIsIl9UZXh0IiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsIl9CYWRnZSIsIl8iLCJfaG9va3MiLCJfdXNlU2lkZWJhcjIiLCJfU2lkZWJhcldlYiIsIl9qc3hSdW50aW1lIiwiX2V4Y2x1ZGVkIiwiU2lkZWJhcldlYiIsIl9yZWYiLCJfcmVmJGl0ZW1zIiwiaXRlbXMiLCJfcmVmJGNvbGxhcHNlZCIsImNvbGxhcHNlZCIsIm9uSXRlbVByZXNzIiwiaXNJdGVtVmlzaWJsZSIsImFjY2Vzc2liaWxpdHlMYWJlbCIsInRlc3RJRCIsImNsYXNzTmFtZSIsInN0eWxlIiwicmVzdCIsIl9vYmplY3RXaXRob3V0UHJvcGVydGllczIiLCJkZWZhdWx0IiwiX3VzZUkxOG4iLCJ1c2VJMThuIiwidCIsInJvdXRlciIsInVzZVJvdXRlciIsIl91c2VTaWRlYmFyIiwidXNlU2lkZWJhciIsIml0ZW0iLCJocmVmIiwicHVzaCIsIm9uUHJlc3MiLCJleHBhbmRlZFNlY3Rpb25zIiwiaXNJdGVtQWN0aXZlIiwidG9nZ2xlU2VjdGlvbiIsImhvb2tIYW5kbGVJdGVtUHJlc3MiLCJoYW5kbGVJdGVtUHJlc3MiLCJmaWx0ZXJlZEl0ZW1zIiwiaGFuZGxlUHJlc3MiLCJoYW5kbGVJdGVtS2V5RG93biIsImV2ZW50Iiwia2V5IiwicHJldmVudERlZmF1bHQiLCJjaGlsZHJlbiIsImxlbmd0aCIsImlkIiwicmVuZGVyTmF2SXRlbSIsImxldmVsIiwiYXJndW1lbnRzIiwidW5kZWZpbmVkIiwiaGFzQ2hpbGRyZW4iLCJpc0FjdGl2ZSIsImlzRXhwYW5kZWQiLCJqc3hzIiwiRnJhZ21lbnQiLCJqc3giLCJTdHlsZWROYXZJdGVtIiwiYWN0aXZlIiwib25LZXlEb3duIiwidGFiSW5kZXgiLCJhY2Nlc3NpYmlsaXR5Um9sZSIsImxhYmVsIiwiYWNjZXNzaWJpbGl0eVN0YXRlIiwic2VsZWN0ZWQiLCJTdHlsZWROYXZJdGVtQ29udGVudCIsImljb24iLCJTdHlsZWROYXZJdGVtSWNvbiIsIlN0eWxlZE5hdkl0ZW1MYWJlbCIsImJhZGdlIiwiU3R5bGVkTmF2SXRlbUJhZGdlIiwidmFyaWFudCIsInNpemUiLCJiYWRnZUNvdW50IiwiU3R5bGVkRXhwYW5kSWNvbiIsImV4cGFuZGVkIiwiU3R5bGVkTmF2SXRlbUNoaWxkcmVuIiwibWFwIiwiY2hpbGQiLCJncm91cGVkSXRlbXMiLCJ1c2VNZW1vIiwiZ3JvdXBzIiwiZm9yRWFjaCIsImdyb3VwIiwiU3R5bGVkU2lkZWJhciIsIk9iamVjdCIsImFzc2lnbiIsIlN0eWxlZFNpZGViYXJDb250ZW50IiwiZW50cmllcyIsIl9yZWYyIiwiX3JlZjMiLCJfc2xpY2VkVG9BcnJheTIiLCJncm91cE5hbWUiLCJncm91cEl0ZW1zIiwiU3R5bGVkTmF2U2VjdGlvbiIsIlN0eWxlZE5hdlNlY3Rpb25IZWFkZXIiLCJTdHlsZWROYXZTZWN0aW9uVGl0bGUiLCJEaXZpZGVyIiwiX2RlZmF1bHQiLCJleHBvcnRzIl0sInNvdXJjZXMiOlsiU2lkZWJhci53ZWIuanN4Il0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBTaWRlYmFyIENvbXBvbmVudCAtIFdlYlxyXG4gKiBEZXNrdG9wIG5hdmlnYXRpb24gc2lkZWJhciB3aXRoIGNvbGxhcHNpYmxlIHNlY3Rpb25zXHJcbiAqIEZpbGU6IFNpZGViYXIud2ViLmpzeFxyXG4gKi9cclxuaW1wb3J0IFJlYWN0LCB7IHVzZU1lbW8gfSBmcm9tICdyZWFjdCc7XHJcbmltcG9ydCB7IHVzZVJvdXRlciB9IGZyb20gJ2V4cG8tcm91dGVyJztcclxuaW1wb3J0IFRleHQgZnJvbSAnQHBsYXRmb3JtL2NvbXBvbmVudHMvZGlzcGxheS9UZXh0JztcclxuaW1wb3J0IEJhZGdlIGZyb20gJ0BwbGF0Zm9ybS9jb21wb25lbnRzL2Rpc3BsYXkvQmFkZ2UnO1xyXG5pbXBvcnQgeyBEaXZpZGVyIH0gZnJvbSAnQHBsYXRmb3JtL2NvbXBvbmVudHMnO1xyXG5pbXBvcnQgeyB1c2VJMThuIH0gZnJvbSAnQGhvb2tzJztcclxuaW1wb3J0IHVzZVNpZGViYXIgZnJvbSAnLi91c2VTaWRlYmFyJztcclxuaW1wb3J0IHtcclxuICBTdHlsZWRTaWRlYmFyLFxyXG4gIFN0eWxlZFNpZGViYXJDb250ZW50LFxyXG4gIFN0eWxlZE5hdlNlY3Rpb24sXHJcbiAgU3R5bGVkTmF2U2VjdGlvbkhlYWRlcixcclxuICBTdHlsZWROYXZTZWN0aW9uVGl0bGUsXHJcbiAgU3R5bGVkTmF2SXRlbSxcclxuICBTdHlsZWROYXZJdGVtQ29udGVudCxcclxuICBTdHlsZWROYXZJdGVtSWNvbixcclxuICBTdHlsZWROYXZJdGVtTGFiZWwsXHJcbiAgU3R5bGVkTmF2SXRlbUJhZGdlLFxyXG4gIFN0eWxlZE5hdkl0ZW1DaGlsZHJlbixcclxuICBTdHlsZWRFeHBhbmRJY29uLFxyXG59IGZyb20gJy4vU2lkZWJhci53ZWIuc3R5bGVzJztcclxuXHJcbi8qKlxyXG4gKiBTaWRlYmFyIGNvbXBvbmVudCBmb3IgV2ViXHJcbiAqIEBwYXJhbSB7T2JqZWN0fSBwcm9wcyAtIFNpZGViYXIgcHJvcHNcclxuICogQHBhcmFtIHtBcnJheX0gcHJvcHMuaXRlbXMgLSBOYXZpZ2F0aW9uIGl0ZW1zXHJcbiAqIEBwYXJhbSB7Ym9vbGVhbn0gcHJvcHMuY29sbGFwc2VkIC0gQ29sbGFwc2VkIHN0YXRlXHJcbiAqIEBwYXJhbSB7RnVuY3Rpb259IHByb3BzLm9uSXRlbVByZXNzIC0gSXRlbSBwcmVzcyBoYW5kbGVyXHJcbiAqIEBwYXJhbSB7RnVuY3Rpb259IHByb3BzLmlzSXRlbVZpc2libGUgLSBGdW5jdGlvbiB0byBjaGVjayBpdGVtIHZpc2liaWxpdHlcclxuICogQHBhcmFtIHtzdHJpbmd9IHByb3BzLmFjY2Vzc2liaWxpdHlMYWJlbCAtIEFjY2Vzc2liaWxpdHkgbGFiZWxcclxuICogQHBhcmFtIHtzdHJpbmd9IHByb3BzLnRlc3RJRCAtIFRlc3QgaWRlbnRpZmllclxyXG4gKiBAcGFyYW0ge3N0cmluZ30gcHJvcHMuY2xhc3NOYW1lIC0gQWRkaXRpb25hbCBDU1MgY2xhc3NcclxuICogQHBhcmFtIHtPYmplY3R9IHByb3BzLnN0eWxlIC0gQWRkaXRpb25hbCBzdHlsZXNcclxuICovXHJcbmNvbnN0IFNpZGViYXJXZWIgPSAoe1xyXG4gIGl0ZW1zID0gW10sXHJcbiAgY29sbGFwc2VkID0gZmFsc2UsXHJcbiAgb25JdGVtUHJlc3MsXHJcbiAgaXNJdGVtVmlzaWJsZSxcclxuICBhY2Nlc3NpYmlsaXR5TGFiZWwsXHJcbiAgdGVzdElELFxyXG4gIGNsYXNzTmFtZSxcclxuICBzdHlsZSxcclxuICAuLi5yZXN0XHJcbn0pID0+IHtcclxuICBjb25zdCB7IHQgfSA9IHVzZUkxOG4oKTtcclxuICBjb25zdCByb3V0ZXIgPSB1c2VSb3V0ZXIoKTtcclxuICBjb25zdCB7XHJcbiAgICBleHBhbmRlZFNlY3Rpb25zLFxyXG4gICAgaXNJdGVtQWN0aXZlLFxyXG4gICAgdG9nZ2xlU2VjdGlvbixcclxuICAgIGhhbmRsZUl0ZW1QcmVzczogaG9va0hhbmRsZUl0ZW1QcmVzcyxcclxuICAgIGZpbHRlcmVkSXRlbXMsXHJcbiAgfSA9IHVzZVNpZGViYXIoe1xyXG4gICAgaXRlbXMsXHJcbiAgICBvbkl0ZW1QcmVzczogb25JdGVtUHJlc3MgfHwgKChpdGVtKSA9PiB7XHJcbiAgICAgIGlmIChpdGVtLmhyZWYpIHtcclxuICAgICAgICByb3V0ZXIucHVzaChpdGVtLmhyZWYpO1xyXG4gICAgICB9IGVsc2UgaWYgKGl0ZW0ub25QcmVzcykge1xyXG4gICAgICAgIGl0ZW0ub25QcmVzcyhpdGVtKTtcclxuICAgICAgfVxyXG4gICAgfSksXHJcbiAgICBpc0l0ZW1WaXNpYmxlLFxyXG4gIH0pO1xyXG5cclxuICBjb25zdCBoYW5kbGVQcmVzcyA9IChpdGVtKSA9PiB7XHJcbiAgICBpZiAob25JdGVtUHJlc3MpIHtcclxuICAgICAgb25JdGVtUHJlc3MoaXRlbSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBob29rSGFuZGxlSXRlbVByZXNzKGl0ZW0pO1xyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIGNvbnN0IGhhbmRsZUl0ZW1LZXlEb3duID0gKGV2ZW50LCBpdGVtKSA9PiB7XHJcbiAgICAvLyBIYW5kbGUgRW50ZXIgYW5kIFNwYWNlIGtleXMgZm9yIGtleWJvYXJkIG5hdmlnYXRpb25cclxuICAgIGlmIChldmVudC5rZXkgPT09ICdFbnRlcicgfHwgZXZlbnQua2V5ID09PSAnICcpIHtcclxuICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgaWYgKGl0ZW0uY2hpbGRyZW4gJiYgaXRlbS5jaGlsZHJlbi5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgdG9nZ2xlU2VjdGlvbihpdGVtLmlkKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBoYW5kbGVQcmVzcyhpdGVtKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIGNvbnN0IHJlbmRlck5hdkl0ZW0gPSAoaXRlbSwgbGV2ZWwgPSAwKSA9PiB7XHJcbiAgICBjb25zdCBoYXNDaGlsZHJlbiA9IGl0ZW0uY2hpbGRyZW4gJiYgaXRlbS5jaGlsZHJlbi5sZW5ndGggPiAwO1xyXG4gICAgY29uc3QgaXNBY3RpdmUgPSBpc0l0ZW1BY3RpdmUoaXRlbSk7XHJcbiAgICBjb25zdCBpc0V4cGFuZGVkID0gZXhwYW5kZWRTZWN0aW9uc1tpdGVtLmlkXSB8fCBmYWxzZTtcclxuXHJcbiAgICByZXR1cm4gKFxyXG4gICAgICA8UmVhY3QuRnJhZ21lbnQga2V5PXtpdGVtLmlkfT5cclxuICAgICAgICA8U3R5bGVkTmF2SXRlbVxyXG4gICAgICAgICAgbGV2ZWw9e2xldmVsfVxyXG4gICAgICAgICAgYWN0aXZlPXtpc0FjdGl2ZX1cclxuICAgICAgICAgIG9uUHJlc3M9eygpID0+IHtcclxuICAgICAgICAgICAgaWYgKGhhc0NoaWxkcmVuKSB7XHJcbiAgICAgICAgICAgICAgdG9nZ2xlU2VjdGlvbihpdGVtLmlkKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICBoYW5kbGVQcmVzcyhpdGVtKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfX1cclxuICAgICAgICAgIG9uS2V5RG93bj17KGV2ZW50KSA9PiBoYW5kbGVJdGVtS2V5RG93bihldmVudCwgaXRlbSl9XHJcbiAgICAgICAgICB0YWJJbmRleD17MH1cclxuICAgICAgICAgIGFjY2Vzc2liaWxpdHlSb2xlPVwiYnV0dG9uXCJcclxuICAgICAgICAgIGFjY2Vzc2liaWxpdHlMYWJlbD17aXRlbS5sYWJlbH1cclxuICAgICAgICAgIGFjY2Vzc2liaWxpdHlTdGF0ZT17eyBzZWxlY3RlZDogaXNBY3RpdmUgfX1cclxuICAgICAgICAgIHRlc3RJRD17dGVzdElEID8gYCR7dGVzdElEfS1pdGVtLSR7aXRlbS5pZH1gIDogdW5kZWZpbmVkfVxyXG4gICAgICAgID5cclxuICAgICAgICAgIDxTdHlsZWROYXZJdGVtQ29udGVudD5cclxuICAgICAgICAgICAge2l0ZW0uaWNvbiAmJiA8U3R5bGVkTmF2SXRlbUljb24+e2l0ZW0uaWNvbn08L1N0eWxlZE5hdkl0ZW1JY29uPn1cclxuICAgICAgICAgICAgeyFjb2xsYXBzZWQgJiYgKFxyXG4gICAgICAgICAgICAgIDw+XHJcbiAgICAgICAgICAgICAgICA8U3R5bGVkTmF2SXRlbUxhYmVsIGFjdGl2ZT17aXNBY3RpdmV9PntpdGVtLmxhYmVsfTwvU3R5bGVkTmF2SXRlbUxhYmVsPlxyXG4gICAgICAgICAgICAgICAge2l0ZW0uYmFkZ2UgJiYgKFxyXG4gICAgICAgICAgICAgICAgICA8U3R5bGVkTmF2SXRlbUJhZGdlPlxyXG4gICAgICAgICAgICAgICAgICAgIDxCYWRnZSB2YXJpYW50PVwicHJpbWFyeVwiIHNpemU9XCJzbWFsbFwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAge2l0ZW0uYmFkZ2VDb3VudCB8fCAnJ31cclxuICAgICAgICAgICAgICAgICAgICA8L0JhZGdlPlxyXG4gICAgICAgICAgICAgICAgICA8L1N0eWxlZE5hdkl0ZW1CYWRnZT5cclxuICAgICAgICAgICAgICAgICl9XHJcbiAgICAgICAgICAgICAgICB7aGFzQ2hpbGRyZW4gJiYgKFxyXG4gICAgICAgICAgICAgICAgICA8U3R5bGVkRXhwYW5kSWNvbiBleHBhbmRlZD17aXNFeHBhbmRlZH0+4pa8PC9TdHlsZWRFeHBhbmRJY29uPlxyXG4gICAgICAgICAgICAgICAgKX1cclxuICAgICAgICAgICAgICA8Lz5cclxuICAgICAgICAgICAgKX1cclxuICAgICAgICAgIDwvU3R5bGVkTmF2SXRlbUNvbnRlbnQ+XHJcbiAgICAgICAgPC9TdHlsZWROYXZJdGVtPlxyXG4gICAgICAgIHtoYXNDaGlsZHJlbiAmJiBpc0V4cGFuZGVkICYmICFjb2xsYXBzZWQgJiYgKFxyXG4gICAgICAgICAgPFN0eWxlZE5hdkl0ZW1DaGlsZHJlbj5cclxuICAgICAgICAgICAge2l0ZW0uY2hpbGRyZW4ubWFwKChjaGlsZCkgPT4gcmVuZGVyTmF2SXRlbShjaGlsZCwgbGV2ZWwgKyAxKSl9XHJcbiAgICAgICAgICA8L1N0eWxlZE5hdkl0ZW1DaGlsZHJlbj5cclxuICAgICAgICApfVxyXG4gICAgICA8L1JlYWN0LkZyYWdtZW50PlxyXG4gICAgKTtcclxuICB9O1xyXG5cclxuICBjb25zdCBncm91cGVkSXRlbXMgPSB1c2VNZW1vKCgpID0+IHtcclxuICAgIGNvbnN0IGdyb3VwcyA9IHt9O1xyXG4gICAgZmlsdGVyZWRJdGVtcy5mb3JFYWNoKChpdGVtKSA9PiB7XHJcbiAgICAgIGNvbnN0IGdyb3VwID0gaXRlbS5ncm91cCB8fCAnbWFpbic7XHJcbiAgICAgIGlmICghZ3JvdXBzW2dyb3VwXSkge1xyXG4gICAgICAgIGdyb3Vwc1tncm91cF0gPSBbXTtcclxuICAgICAgfVxyXG4gICAgICBncm91cHNbZ3JvdXBdLnB1c2goaXRlbSk7XHJcbiAgICB9KTtcclxuICAgIHJldHVybiBncm91cHM7XHJcbiAgfSwgW2ZpbHRlcmVkSXRlbXNdKTtcclxuXHJcbiAgcmV0dXJuIChcclxuICAgIDxTdHlsZWRTaWRlYmFyXHJcbiAgICAgIGNvbGxhcHNlZD17Y29sbGFwc2VkfVxyXG4gICAgICBhY2Nlc3NpYmlsaXR5Um9sZT1cIm5hdmlnYXRpb25cIlxyXG4gICAgICBhY2Nlc3NpYmlsaXR5TGFiZWw9e2FjY2Vzc2liaWxpdHlMYWJlbCB8fCB0KCduYXZpZ2F0aW9uLnNpZGViYXIudGl0bGUnKX1cclxuICAgICAgdGVzdElEPXt0ZXN0SUR9XHJcbiAgICAgIGNsYXNzTmFtZT17Y2xhc3NOYW1lfVxyXG4gICAgICBzdHlsZT17c3R5bGV9XHJcbiAgICAgIHsuLi5yZXN0fVxyXG4gICAgPlxyXG4gICAgICA8U3R5bGVkU2lkZWJhckNvbnRlbnQ+XHJcbiAgICAgICAge09iamVjdC5lbnRyaWVzKGdyb3VwZWRJdGVtcykubWFwKChbZ3JvdXBOYW1lLCBncm91cEl0ZW1zXSkgPT4gKFxyXG4gICAgICAgICAgPFN0eWxlZE5hdlNlY3Rpb24ga2V5PXtncm91cE5hbWV9PlxyXG4gICAgICAgICAgICB7IWNvbGxhcHNlZCAmJiBncm91cE5hbWUgIT09ICdtYWluJyAmJiAoXHJcbiAgICAgICAgICAgICAgPFN0eWxlZE5hdlNlY3Rpb25IZWFkZXI+XHJcbiAgICAgICAgICAgICAgICA8U3R5bGVkTmF2U2VjdGlvblRpdGxlPntncm91cE5hbWV9PC9TdHlsZWROYXZTZWN0aW9uVGl0bGU+XHJcbiAgICAgICAgICAgICAgPC9TdHlsZWROYXZTZWN0aW9uSGVhZGVyPlxyXG4gICAgICAgICAgICApfVxyXG4gICAgICAgICAgICB7Z3JvdXBJdGVtcy5tYXAoKGl0ZW0pID0+IHJlbmRlck5hdkl0ZW0oaXRlbSkpfVxyXG4gICAgICAgICAgICB7Z3JvdXBOYW1lICE9PSAnbWFpbicgJiYgPERpdmlkZXIgLz59XHJcbiAgICAgICAgICA8L1N0eWxlZE5hdlNlY3Rpb24+XHJcbiAgICAgICAgKSl9XHJcbiAgICAgIDwvU3R5bGVkU2lkZWJhckNvbnRlbnQ+XHJcbiAgICA8L1N0eWxlZFNpZGViYXI+XHJcbiAgKTtcclxufTtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IFNpZGViYXJXZWI7XHJcblxyXG4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBS0EsSUFBQUEsTUFBQSxHQUFBQyx1QkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUMsV0FBQSxHQUFBRCxPQUFBO0FBQ0EsSUFBQUUsS0FBQSxHQUFBQyxzQkFBQSxDQUFBSCxPQUFBO0FBQ0EsSUFBQUksTUFBQSxHQUFBRCxzQkFBQSxDQUFBSCxPQUFBO0FBQ0EsSUFBQUssQ0FBQSxHQUFBTCxPQUFBO0FBQ0EsSUFBQU0sTUFBQSxHQUFBTixPQUFBO0FBQ0EsSUFBQU8sWUFBQSxHQUFBSixzQkFBQSxDQUFBSCxPQUFBO0FBQ0EsSUFBQVEsV0FBQSxHQUFBUixPQUFBO0FBYThCLElBQUFTLFdBQUEsR0FBQVQsT0FBQTtBQUFBLElBQUFVLFNBQUE7QUFjOUIsSUFBTUMsVUFBVSxHQUFHLFNBQWJBLFVBQVVBLENBQUFDLElBQUEsRUFVVjtFQUFBLElBQUFDLFVBQUEsR0FBQUQsSUFBQSxDQVRKRSxLQUFLO0lBQUxBLEtBQUssR0FBQUQsVUFBQSxjQUFHLEVBQUUsR0FBQUEsVUFBQTtJQUFBRSxjQUFBLEdBQUFILElBQUEsQ0FDVkksU0FBUztJQUFUQSxTQUFTLEdBQUFELGNBQUEsY0FBRyxLQUFLLEdBQUFBLGNBQUE7SUFDakJFLFdBQVcsR0FBQUwsSUFBQSxDQUFYSyxXQUFXO0lBQ1hDLGFBQWEsR0FBQU4sSUFBQSxDQUFiTSxhQUFhO0lBQ2JDLGtCQUFrQixHQUFBUCxJQUFBLENBQWxCTyxrQkFBa0I7SUFDbEJDLE1BQU0sR0FBQVIsSUFBQSxDQUFOUSxNQUFNO0lBQ05DLFNBQVMsR0FBQVQsSUFBQSxDQUFUUyxTQUFTO0lBQ1RDLEtBQUssR0FBQVYsSUFBQSxDQUFMVSxLQUFLO0lBQ0ZDLElBQUksT0FBQUMseUJBQUEsQ0FBQUMsT0FBQSxFQUFBYixJQUFBLEVBQUFGLFNBQUE7RUFFUCxJQUFBZ0IsUUFBQSxH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QWpDLFdBQUEsQ0FBQW1ELEdBQUEsRUFBQ3BELFdBQUEsQ0FBQWdGLGFBQWEsRUFBQUMsTUFBQSxDQUFBQyxNQUFBO0lBQ1oxRSxTQUFTLEVBQUVBLFNBQVU7SUFDckJpRCxpQkFBaUIsRUFBQyxZQUFZO0lBQzlCOUMsa0JBQWtCLEVBQUVBLGtCQUFrQixJQUFJUyxDQUFDLENBQUMsMEJBQTBCLENBQUU7SUFDeEVSLE1BQU0sRUFBRUEsTUFBTztJQUNmQyxTQUFTLEVBQUVBLFNBQVU7SUFDckJDLEtBQUssRUFBRUE7RUFBTSxHQUNUQyxJQUFJO0lBQUF5QixRQUFBLEVBRVIsSUFBQXZDLFdBQUEsQ0FBQW1ELEdBQUEsRUFBQ3BELFdBQUEsQ0FBQW1GLG9CQUFvQjtNQUFBM0MsUUFBQSxFQUNsQnlDLE1BQU0sQ0FBQ0csT0FBTyxDQUFDVCxZQUFZLENBQUMsQ0FBQ0YsR0FBRyxDQUFDLFVBQUFZLEtBQUE7UUFBQSxJQUFBQyxLQUFBLE9BQUFDLGVBQUEsQ0FBQXRFLE9BQUEsRUFBQW9FLEtBQUE7VUFBRUcsU0FBUyxHQUFBRixLQUFBO1VBQUVHLFVBQVUsR0FBQUgsS0FBQTtRQUFBLE9BQ3ZELElBQUFyRixXQUFBLENBQUFpRCxJQUFBLEVBQUNsRCxXQUFBLENBQUEwRixnQkFBZ0I7VUFBQWxELFFBQUEsR0FDZCxDQUFDaEMsU0FBUyxJQUFJZ0YsU0FBUyxLQUFLLE1BQU0sSUFDakMsSUFBQXZGLFdBQUEsQ0FBQW1ELEdBQUEsRUFBQ3BELFdBQUEsQ0FBQTJGLHNCQUFzQjtZQUFBbkQsUUFBQSxFQUNyQixJQUFBdkMsV0FBQSxDQUFBbUQsR0FBQSxFQUFDcEQsV0FBQSxDQUFBNEYscUJBQXFCO2NBQUFwRCxRQUFBLEVBQUVnRDtZQUFTLENBQXdCO1VBQUMsQ0FDcEMsQ0FDekIsRUFDQUMsVUFBVSxDQUFDaEIsR0FBRyxDQUFDLFVBQUNoRCxJQUFJO1lBQUEsT0FBS2tCLGNBQWEsQ0FBQ2xCLElBQUksQ0FBQztVQUFBLEVBQUMsRUFDN0MrRCxTQUFTLEtBQUssTUFBTSxJQUFJLElBQUF2RixXQUFBLENBQUFtRCxHQUFBLEVBQUN2RCxDQUFBLENBQUFnRyxPQUFPLElBQUUsQ0FBQztRQUFBLEdBUGZMLFNBUUwsQ0FBQztNQUFBLENBQ3BCO0lBQUMsQ0FDa0I7RUFBQyxFQUNWLENBQUM7QUFFcEIsQ0FBQztBQUFDLElBQUFNLFFBQUEsR0FBQUMsT0FBQSxDQUFBOUUsT0FBQSxHQUVhZCxVQUFVIiwiaWdub3JlTGlzdCI6W119