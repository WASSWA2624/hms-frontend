38b4228937f87705c699d488194b3dd0
var _interopRequireWildcard = require("@babel/runtime/helpers/interopRequireWildcard").default;
var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault").default;
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
var _slicedToArray2 = _interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));
var _react = _interopRequireWildcard(require("react"));
var _hooks = require("../../../../hooks");
var _SelectWeb = require("./Select.web.styles");
var _useSelect2 = _interopRequireDefault(require("./useSelect"));
var _types = require("./types");
var _jsxRuntime = require("react/jsx-runtime");
var SelectWeb = function SelectWeb(_ref) {
  var label = _ref.label,
    placeholder = _ref.placeholder,
    _ref$options = _ref.options,
    options = _ref$options === void 0 ? [] : _ref$options,
    value = _ref.value,
    onValueChange = _ref.onValueChange,
    _ref$required = _ref.required,
    required = _ref$required === void 0 ? false : _ref$required,
    _ref$disabled = _ref.disabled,
    disabled = _ref$disabled === void 0 ? false : _ref$disabled,
    validationState = _ref.validationState,
    errorMessage = _ref.errorMessage,
    helperText = _ref.helperText,
    validate = _ref.validate,
    accessibilityLabel = _ref.accessibilityLabel,
    accessibilityHint = _ref.accessibilityHint,
    testID = _ref.testID,
    className = _ref.className,
    style = _ref.style;
  var _useI18n = (0, _hooks.useI18n)(),
    t = _useI18n.t;
  var defaultPlaceholder = placeholder || t('common.selectPlaceholder');
  var _useSelect = (0, _useSelect2.default)({
      value: value,
      options: options,
      onValueChange: onValueChange,
      required: required,
      validate: validate
    }),
    open = _useSelect.open,
    isFocused = _useSelect.isFocused,
    internalValidationState = _useSelect.validationState,
    internalErrorMessage = _useSelect.errorMessage,
    selectedOption = _useSelect.selectedOption,
    openSelect = _useSelect.openSelect,
    closeSelect = _useSelect.closeSelect,
    toggleSelect = _useSelect.toggleSelect,
    handleFocus = _useSelect.handleFocus,
    handleBlur = _useSelect.handleBlur,
    handleSelect = _useSelect.handleSelect;
  var finalValidationState = validationState || (disabled ? _types.VALIDATION_STATES.DISABLED : internalValidationState);
  var finalErrorMessage = errorMessage || internalErrorMessage;
  var displayHelperText = finalErrorMessage || helperText;
  var rootRef = (0, _react.useRef)(null);
  var menuRef = (0, _react.useRef)(null);
  var _React$useState = _react.default.useState(-1),
    _React$useState2 = (0, _slicedToArray2.default)(_React$useState, 2),
    focusedIndex = _React$useState2[0],
    setFocusedIndex = _React$useState2[1];
  (0, _react.useEffect)(function () {
    if (!open) return;
    var handleClickOutside = function handleClickOutside(event) {
      if (rootRef.current && !rootRef.current.contains(event.target)) {
        closeSelect();
      }
    };
    document.addEventListener('mousedown', handleClickOutside);
    return function () {
      return document.removeEventListener('mousedown', handleClickOutside);
    };
  }, [closeSelect, open]);
  (0, _react.useEffect)(function () {
    if (open) {
      setFocusedIndex(-1);
    }
  }, [open]);
  (0, _react.useEffect)(function () {
    if (open && menuRef.current) {
      var firstOption = menuRef.current.querySelector('[role="option"]:not([aria-disabled="true"])');
      if (firstOption) {
        firstOption.focus();
      }
    }
  }, [open]);
  var handleTriggerKeyDown = function handleTriggerKeyDown(e) {
    if (disabled) return;
    if (e.key === 'Enter' || e.key === ' ') {
      e.preventDefault();
      toggleSelect();
    }
    if (e.key === 'ArrowDown') {
      e.preventDefault();
      openSelect();
    }
    if (e.key === 'Escape') {
      e.preventDefault();
      closeSelect();
    }
  };
  var handleMenuKeyDown = function handleMenuKeyDown(e) {
    if (disabled) return;
    var enabledOptions = options.filter(function (opt) {
      return !opt.disabled;
    });
    var currentIndex = enabledOptions.findIndex(function (opt, idx) {
      var optionIndex = options.indexOf(opt);
      return optionIndex === focusedIndex;
    });
    if (e.key === 'ArrowDown') {
      e.preventDefault();
      var nextIndex = currentIndex < enabledOptions.length - 1 ? currentIndex + 1 : 0;
      var nextOption = enabledOptions[nextIndex];
      var nextOptionIndex = options.indexOf(nextOption);
      setFocusedIndex(nextOptionIndex);
      if (menuRef.current) {
        var optionElement = testID ? menuRef.current.querySelector(`[data-testid="${testID}-option-${nextOptionIndex}"]`) : menuRef.current.querySelectorAll('[role="option"]')[nextOptionIndex];
        if (optionElement) {
          optionElement.focus();
        }
      }
    } else if (e.key === 'ArrowUp') {
      e.preventDefault();
      var prevIndex = currentIndex > 0 ? currentIndex - 1 : enabledOptions.length - 1;
      var prevOption = enabledOptions[prevIndex];
      var prevOptionIndex = options.indexOf(prevOption);
      setFocusedIndex(prevOptionIndex);
      if (menuRef.current) {
        var _optionElement = testID ? menuRef.current.querySelector(`[data-testid="${testID}-option-${prevOptionIndex}"]`) : menuRef.current.querySelectorAll('[role="option"]')[prevOptionIndex];
        if (_optionElement) {
          _optionElement.focus();
        }
      }
    } else if (e.key === 'Enter' || e.key === ' ') {
      e.preventDefault();
      if (currentIndex >= 0 && currentIndex < enabledOptions.length) {
        handleSelect(enabledOptions[currentIndex].value);
      }
    } else if (e.key === 'Escape') {
      e.preventDefault();
      closeSelect();
      if (rootRef.current) {
        var trigger = rootRef.current.querySelector('[role="combobox"]');
        if (trigger) {
          trigger.focus();
        }
      }
    }
  };
  return (0, _jsxRuntime.jsxs)(_SelectWeb.StyledContainer, {
    ref: rootRef,
    style: style,
    className: className,
    children: [label ? (0, _jsxRuntime.jsxs)(_SelectWeb.StyledLabelRow, {
      children: [(0, _jsxRuntime.jsx)(_SelectWeb.StyledLabel, {
        children: label
      }), required ? (0, _jsxRuntime.jsx)(_SelectWeb.StyledRequired, {
        children: " *"
      }) : null]
    }) : null, (0, _jsxRuntime.jsxs)(_SelectWeb.StyledTrigger, {
      onClick: disabled ? undefined : toggleSelect,
      onFocus: handleFocus,
      onBlur: handleBlur,
      onKeyDown: handleTriggerKeyDown,
      disabled: disabled,
      $validationState: finalValidationState,
      $isFocused: isFocused,
      role: "combobox",
      "aria-label": accessibilityLabel || label || defaultPlaceholder,
      "aria-describedby": displayHelperText ? `${testID || 'select'}-helper` : undefined,
      "aria-expanded": open,
      "aria-haspopup": "listbox",
      "aria-invalid": finalValidationState === 'error',
      "aria-required": required,
      "data-testid": testID,
      children: [(0, _jsxRuntime.jsx)(_SelectWeb.StyledTriggerText, {
        disabled: disabled,
        $isPlaceholder: !selectedOption,
        children: selectedOption ? selectedOption.label : defaultPlaceholder
      }), (0, _jsxRuntime.jsx)(_SelectWeb.StyledChevron, {
        "aria-hidden": "true",
        children: "\u25BE"
      })]
    }), open ? (0, _jsxRuntime.jsx)(_SelectWeb.StyledMenu, {
      ref: menuRef,
      role: "listbox",
      onKeyDown: handleMenuKeyDown,
      "data-testid": testID ? `${testID}-menu` : undefined,
      children: options.map(function (opt, index) {
        return (0, _jsxRuntime.jsx)(_SelectWeb.StyledOption, {
          disabled: !!opt.disabled,
          onClick: function onClick() {
            if (opt.disabled) return;
            handleSelect(opt.value);
          },
          onFocus: function onFocus() {
            return setFocusedIndex(index);
          },
          role: "option",
          "aria-selected": value === opt.value,
          "aria-disabled": opt.disabled,
          "aria-label": opt.label,
          tabIndex: opt.disabled ? -1 : index === 0 ? 0 : -1,
          "data-testid": testID ? `${testID}-option-${index}` : undefined,
          children: (0, _jsxRuntime.jsx)(_SelectWeb.StyledOptionText, {
            children: opt.label
          })
        }, `${String(opt.value)}-${index}`);
      })
    }) : null, displayHelperText ? (0, _jsxRuntime.jsx)(_SelectWeb.StyledHelperText, {
      $validationState: finalValidationState,
      id: testID ? `${testID}-helper` : undefined,
      children: displayHelperText
    }) : null]
  });
};
var _default = exports.default = SelectWeb;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfcmVhY3QiLCJfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZCIsInJlcXVpcmUiLCJfaG9va3MiLCJfU2VsZWN0V2ViIiwiX3VzZVNlbGVjdDIiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwiX3R5cGVzIiwiX2pzeFJ1bnRpbWUiLCJTZWxlY3RXZWIiLCJfcmVmIiwibGFiZWwiLCJwbGFjZWhvbGRlciIsIl9yZWYkb3B0aW9ucyIsIm9wdGlvbnMiLCJ2YWx1ZSIsIm9uVmFsdWVDaGFuZ2UiLCJfcmVmJHJlcXVpcmVkIiwicmVxdWlyZWQiLCJfcmVmJGRpc2FibGVkIiwiZGlzYWJsZWQiLCJ2YWxpZGF0aW9uU3RhdGUiLCJlcnJvck1lc3NhZ2UiLCJoZWxwZXJUZXh0IiwidmFsaWRhdGUiLCJhY2Nlc3NpYmlsaXR5TGFiZWwiLCJhY2Nlc3NpYmlsaXR5SGludCIsInRlc3RJRCIsImNsYXNzTmFtZSIsInN0eWxlIiwiX3VzZUkxOG4iLCJ1c2VJMThuIiwidCIsImRlZmF1bHRQbGFjZWhvbGRlciIsIl91c2VTZWxlY3QiLCJ1c2VTZWxlY3QiLCJvcGVuIiwiaXNGb2N1c2VkIiwiaW50ZXJuYWxWYWxpZGF0aW9uU3RhdGUiLCJpbnRlcm5hbEVycm9yTWVzc2FnZSIsInNlbGVjdGVkT3B0aW9uIiwib3BlblNlbGVjdCIsImNsb3NlU2VsZWN0IiwidG9nZ2xlU2VsZWN0IiwiaGFuZGxlRm9jdXMiLCJoYW5kbGVCbHVyIiwiaGFuZGxlU2VsZWN0IiwiZmluYWxWYWxpZGF0aW9uU3RhdGUiLCJWQUxJREFUSU9OX1NUQVRFUyIsIkRJU0FCTEVEIiwiZmluYWxFcnJvck1lc3NhZ2UiLCJkaXNwbGF5SGVscGVyVGV4dCIsInJvb3RSZWYiLCJ1c2VSZWYiLCJtZW51UmVmIiwiX1JlYWN0JHVzZVN0YXRlIiwiUmVhY3QiLCJ1c2VTdGF0ZSIsIl9SZWFjdCR1c2VTdGF0ZTIiLCJfc2xpY2VkVG9BcnJheTIiLCJkZWZhdWx0IiwiZm9jdXNlZEluZGV4Iiwic2V0Rm9jdXNlZEluZGV4IiwidXNlRWZmZWN0IiwiaGFuZGxlQ2xpY2tPdXRzaWRlIiwiZXZlbnQiLCJjdXJyZW50IiwiY29udGFpbnMiLCJ0YXJnZXQiLCJkb2N1bWVudCIsImFkZEV2ZW50TGlzdGVuZXIiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiZmlyc3RPcHRpb24iLCJxdWVyeVNlbGVjdG9yIiwiZm9jdXMiLCJoYW5kbGVUcmlnZ2VyS2V5RG93biIsImUiLCJrZXkiLCJwcmV2ZW50RGVmYXVsdCIsImhhbmRsZU1lbnVLZXlEb3duIiwiZW5hYmxlZE9wdGlvbnMiLCJmaWx0ZXIiLCJvcHQiLCJjdXJyZW50SW5kZXgiLCJmaW5kSW5kZXgiLCJpZHgiLCJvcHRpb25JbmRleCIsImluZGV4T2YiLCJuZXh0SW5kZXgiLCJsZW5ndGgiLCJuZXh0T3B0aW9uIiwibmV4dE9wdGlvbkluZGV4Iiwib3B0aW9uRWxlbWVudCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJwcmV2SW5kZXgiLCJwcmV2T3B0aW9uIiwicHJldk9wdGlvbkluZGV4IiwidHJpZ2dlciIsImpzeHMiLCJTdHlsZWRDb250YWluZXIiLCJyZWYiLCJjaGlsZHJlbiIsIlN0eWxlZExhYmVsUm93IiwianN4IiwiU3R5bGVkTGFiZWwiLCJTdHlsZWRSZXF1aXJlZCIsIlN0eWxlZFRyaWdnZXIiLCJvbkNsaWNrIiwidW5kZWZpbmVkIiwib25Gb2N1cyIsIm9uQmx1ciIsIm9uS2V5RG93biIsIiR2YWxpZGF0aW9uU3RhdGUiLCIkaXNGb2N1c2VkIiwicm9sZSIsIlN0eWxlZFRyaWdnZXJUZXh0IiwiJGlzUGxhY2Vob2xkZXIiLCJTdHlsZWRDaGV2cm9uIiwiU3R5bGVkTWVudSIsIm1hcCIsImluZGV4IiwiU3R5bGVkT3B0aW9uIiwidGFiSW5kZXgiLCJTdHlsZWRPcHRpb25UZXh0IiwiU3RyaW5nIiwiU3R5bGVkSGVscGVyVGV4dCIsImlkIiwiX2RlZmF1bHQiLCJleHBvcnRzIl0sInNvdXJjZXMiOlsiU2VsZWN0LndlYi5qc3giXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIFNlbGVjdCBDb21wb25lbnQgLSBXZWJcclxuICogUGlja2VyL2Ryb3Bkb3duIHByaW1pdGl2ZSBmb3IgV2ViIHBsYXRmb3JtIChrZXlib2FyZCBhY2Nlc3NpYmxlKVxyXG4gKiBGaWxlOiBTZWxlY3Qud2ViLmpzeFxyXG4gKi9cclxuLy8gMS4gRXh0ZXJuYWwgZGVwZW5kZW5jaWVzXHJcbmltcG9ydCBSZWFjdCwgeyB1c2VFZmZlY3QsIHVzZVJlZiB9IGZyb20gJ3JlYWN0JztcclxuXHJcbi8vIDIuIFBsYXRmb3JtIGNvbXBvbmVudHMgKGZyb20gYmFycmVsIGZpbGUpIC0gTi9BIGZvciBTZWxlY3RcclxuXHJcbi8vIDMuIEhvb2tzIGFuZCB1dGlsaXRpZXMgKGFic29sdXRlIGltcG9ydHMgdmlhIGFsaWFzZXMpXHJcbmltcG9ydCB7IHVzZUkxOG4gfSBmcm9tICdAaG9va3MnO1xyXG5cclxuLy8gNC4gU3R5bGVzIChyZWxhdGl2ZSBpbXBvcnQgLSBwbGF0Zm9ybS1zcGVjaWZpYylcclxuaW1wb3J0IHtcclxuICBTdHlsZWRDb250YWluZXIsXHJcbiAgU3R5bGVkTGFiZWxSb3csXHJcbiAgU3R5bGVkTGFiZWwsXHJcbiAgU3R5bGVkUmVxdWlyZWQsXHJcbiAgU3R5bGVkVHJpZ2dlcixcclxuICBTdHlsZWRUcmlnZ2VyVGV4dCxcclxuICBTdHlsZWRDaGV2cm9uLFxyXG4gIFN0eWxlZE1lbnUsXHJcbiAgU3R5bGVkT3B0aW9uLFxyXG4gIFN0eWxlZE9wdGlvblRleHQsXHJcbiAgU3R5bGVkSGVscGVyVGV4dCxcclxufSBmcm9tICcuL1NlbGVjdC53ZWIuc3R5bGVzJztcclxuXHJcbi8vIDUuIENvbXBvbmVudC1zcGVjaWZpYyBob29rIChyZWxhdGl2ZSBpbXBvcnQpXHJcbmltcG9ydCB1c2VTZWxlY3QgZnJvbSAnLi91c2VTZWxlY3QnO1xyXG5cclxuLy8gNi4gVHlwZXMgYW5kIGNvbnN0YW50cyAocmVsYXRpdmUgaW1wb3J0KVxyXG5pbXBvcnQgeyBWQUxJREFUSU9OX1NUQVRFUyB9IGZyb20gJy4vdHlwZXMnO1xyXG5cclxuLyoqXHJcbiAqIEB0eXBlZGVmIHtPYmplY3R9IFNlbGVjdE9wdGlvblxyXG4gKiBAcHJvcGVydHkge3N0cmluZ30gbGFiZWxcclxuICogQHByb3BlcnR5IHtzdHJpbmd8bnVtYmVyfSB2YWx1ZVxyXG4gKiBAcHJvcGVydHkge2Jvb2xlYW59IFtkaXNhYmxlZF1cclxuICovXHJcblxyXG4vKipcclxuICogQHBhcmFtIHtPYmplY3R9IHByb3BzXHJcbiAqIEBwYXJhbSB7c3RyaW5nfSBbcHJvcHMubGFiZWxdXHJcbiAqIEBwYXJhbSB7c3RyaW5nfSBbcHJvcHMucGxhY2Vob2xkZXJdXHJcbiAqIEBwYXJhbSB7U2VsZWN0T3B0aW9uW119IHByb3BzLm9wdGlvbnNcclxuICogQHBhcmFtIHtzdHJpbmd8bnVtYmVyfG51bGx8dW5kZWZpbmVkfSBwcm9wcy52YWx1ZVxyXG4gKiBAcGFyYW0geyh2YWx1ZTogYW55KSA9PiB2b2lkfSBwcm9wcy5vblZhbHVlQ2hhbmdlXHJcbiAqIEBwYXJhbSB7Ym9vbGVhbn0gW3Byb3BzLnJlcXVpcmVkXVxyXG4gKiBAcGFyYW0ge2Jvb2xlYW59IFtwcm9wcy5kaXNhYmxlZF1cclxuICogQHBhcmFtIHtzdHJpbmd9IFtwcm9wcy52YWxpZGF0aW9uU3RhdGVdXHJcbiAqIEBwYXJhbSB7c3RyaW5nfSBbcHJvcHMuZXJyb3JNZXNzYWdlXVxyXG4gKiBAcGFyYW0ge3N0cmluZ30gW3Byb3BzLmhlbHBlclRleHRdXHJcbiAqIEBwYXJhbSB7KHZhbHVlOiBhbnkpID0+IGJvb2xlYW58e3ZhbGlkOiBib29sZWFuLCBlcnJvcj86IHN0cmluZ319IFtwcm9wcy52YWxpZGF0ZV1cclxuICogQHBhcmFtIHtzdHJpbmd9IFtwcm9wcy5hY2Nlc3NpYmlsaXR5TGFiZWxdXHJcbiAqIEBwYXJhbSB7c3RyaW5nfSBbcHJvcHMuYWNjZXNzaWJpbGl0eUhpbnRdXHJcbiAqIEBwYXJhbSB7c3RyaW5nfSBbcHJvcHMudGVzdElEXVxyXG4gKiBAcGFyYW0ge3N0cmluZ30gW3Byb3BzLmNsYXNzTmFtZV1cclxuICogQHBhcmFtIHtPYmplY3R9IFtwcm9wcy5zdHlsZV1cclxuICovXHJcbmNvbnN0IFNlbGVjdFdlYiA9ICh7XHJcbiAgbGFiZWwsXHJcbiAgcGxhY2Vob2xkZXIsXHJcbiAgb3B0aW9ucyA9IFtdLFxyXG4gIHZhbHVlLFxyXG4gIG9uVmFsdWVDaGFuZ2UsXHJcbiAgcmVxdWlyZWQgPSBmYWxzZSxcclxuICBkaXNhYmxlZCA9IGZhbHNlLFxyXG4gIHZhbGlkYXRpb25TdGF0ZSxcclxuICBlcnJvck1lc3NhZ2UsXHJcbiAgaGVscGVyVGV4dCxcclxuICB2YWxpZGF0ZSxcclxuICBhY2Nlc3NpYmlsaXR5TGFiZWwsXHJcbiAgYWNjZXNzaWJpbGl0eUhpbnQsXHJcbiAgdGVzdElELFxyXG4gIGNsYXNzTmFtZSxcclxuICBzdHlsZSxcclxufSkgPT4ge1xyXG4gIGNvbnN0IHsgdCB9ID0gdXNlSTE4bigpO1xyXG4gIGNvbnN0IGRlZmF1bHRQbGFjZWhvbGRlciA9IHBsYWNlaG9sZGVyIHx8IHQoJ2NvbW1vbi5zZWxlY3RQbGFjZWhvbGRlcicpO1xyXG4gIFxyXG4gIGNvbnN0IHtcclxuICAgIG9wZW4sXHJcbiAgICBpc0ZvY3VzZWQsXHJcbiAgICB2YWxpZGF0aW9uU3RhdGU6IGludGVybmFsVmFsaWRhdGlvblN0YXRlLFxyXG4gICAgZXJyb3JNZXNzYWdlOiBpbnRlcm5hbEVycm9yTWVzc2FnZSxcclxuICAgIHNlbGVjdGVkT3B0aW9uLFxyXG4gICAgb3BlblNlbGVjdCxcclxuICAgIGNsb3NlU2VsZWN0LFxyXG4gICAgdG9nZ2xlU2VsZWN0LFxyXG4gICAgaGFuZGxlRm9jdXMsXHJcbiAgICBoYW5kbGVCbHVyLFxyXG4gICAgaGFuZGxlU2VsZWN0LFxyXG4gIH0gPSB1c2VTZWxlY3QoeyB2YWx1ZSwgb3B0aW9ucywgb25WYWx1ZUNoYW5nZSwgcmVxdWlyZWQsIHZhbGlkYXRlIH0pO1xyXG5cclxuICBjb25zdCBmaW5hbFZhbGlkYXRpb25TdGF0ZSA9IHZhbGlkYXRpb25TdGF0ZSB8fCAoZGlzYWJsZWQgPyBWQUxJREFUSU9OX1NUQVRFUy5ESVNBQkxFRCA6IGludGVybmFsVmFsaWRhdGlvblN0YXRlKTtcclxuICBjb25zdCBmaW5hbEVycm9yTWVzc2FnZSA9IGVycm9yTWVzc2FnZSB8fCBpbnRlcm5hbEVycm9yTWVzc2FnZTtcclxuICBjb25zdCBkaXNwbGF5SGVscGVyVGV4dCA9IGZpbmFsRXJyb3JNZXNzYWdlIHx8IGhlbHBlclRleHQ7XHJcblxyXG4gIGNvbnN0IHJvb3RSZWYgPSB1c2VSZWYobnVsbCk7XHJcbiAgY29uc3QgbWVudVJlZiA9IHVzZVJlZihudWxsKTtcclxuICBjb25zdCBbZm9jdXNlZEluZGV4LCBzZXRGb2N1c2VkSW5kZXhdID0gUmVhY3QudXNlU3RhdGUoLTEpO1xyXG5cclxuICAvLyBDbG9zZSBvbiBvdXRzaWRlIGNsaWNrXHJcbiAgdXNlRWZmZWN0KCgpID0+IHtcclxuICAgIGlmICghb3BlbikgcmV0dXJuO1xyXG5cclxuICAgIGNvbnN0IGhhbmRsZUNsaWNrT3V0c2lkZSA9IChldmVudCkgPT4ge1xyXG4gICAgICBpZiAocm9vdFJlZi5jdXJyZW50ICYmICFyb290UmVmLmN1cnJlbnQuY29udGFpbnMoZXZlbnQudGFyZ2V0KSkge1xyXG4gICAgICAgIGNsb3NlU2VsZWN0KCk7XHJcbiAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgaGFuZGxlQ2xpY2tPdXRzaWRlKTtcclxuICAgIHJldHVybiAoKSA9PiBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCBoYW5kbGVDbGlja091dHNpZGUpO1xyXG4gIH0sIFtjbG9zZVNlbGVjdCwgb3Blbl0pO1xyXG5cclxuICAvLyBSZXNldCBmb2N1c2VkIGluZGV4IHdoZW4gbWVudSBvcGVucy9jbG9zZXNcclxuICB1c2VFZmZlY3QoKCkgPT4ge1xyXG4gICAgaWYgKG9wZW4pIHtcclxuICAgICAgc2V0Rm9jdXNlZEluZGV4KC0xKTtcclxuICAgIH1cclxuICB9LCBbb3Blbl0pO1xyXG5cclxuICAvLyBGb2N1cyBmaXJzdCBvcHRpb24gd2hlbiBtZW51IG9wZW5zXHJcbiAgdXNlRWZmZWN0KCgpID0+IHtcclxuICAgIGlmIChvcGVuICYmIG1lbnVSZWYuY3VycmVudCkge1xyXG4gICAgICBjb25zdCBmaXJzdE9wdGlvbiA9IG1lbnVSZWYuY3VycmVudC5xdWVyeVNlbGVjdG9yKCdbcm9sZT1cIm9wdGlvblwiXTpub3QoW2FyaWEtZGlzYWJsZWQ9XCJ0cnVlXCJdKScpO1xyXG4gICAgICBpZiAoZmlyc3RPcHRpb24pIHtcclxuICAgICAgICBmaXJzdE9wdGlvbi5mb2N1cygpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfSwgW29wZW5dKTtcclxuXHJcbiAgY29uc3QgaGFuZGxlVHJpZ2dlcktleURvd24gPSAoZSkgPT4ge1xyXG4gICAgaWYgKGRpc2FibGVkKSByZXR1cm47XHJcbiAgICBpZiAoZS5rZXkgPT09ICdFbnRlcicgfHwgZS5rZXkgPT09ICcgJykge1xyXG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIHRvZ2dsZVNlbGVjdCgpO1xyXG4gICAgfVxyXG4gICAgaWYgKGUua2V5ID09PSAnQXJyb3dEb3duJykge1xyXG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIG9wZW5TZWxlY3QoKTtcclxuICAgIH1cclxuICAgIGlmIChlLmtleSA9PT0gJ0VzY2FwZScpIHtcclxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICBjbG9zZVNlbGVjdCgpO1xyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIGNvbnN0IGhhbmRsZU1lbnVLZXlEb3duID0gKGUpID0+IHtcclxuICAgIGlmIChkaXNhYmxlZCkgcmV0dXJuO1xyXG5cclxuICAgIGNvbnN0IGVuYWJsZWRPcHRpb25zID0gb3B0aW9ucy5maWx0ZXIoKG9wdCkgPT4gIW9wdC5kaXNhYmxlZCk7XHJcbiAgICBjb25zdCBjdXJyZW50SW5kZXggPSBlbmFibGVkT3B0aW9ucy5maW5kSW5kZXgoKG9wdCwgaWR4KSA9PiB7XHJcbiAgICAgIGNvbnN0IG9wdGlvbkluZGV4ID0gb3B0aW9ucy5pbmRleE9mKG9wdCk7XHJcbiAgICAgIHJldHVybiBvcHRpb25JbmRleCA9PT0gZm9jdXNlZEluZGV4O1xyXG4gICAgfSk7XHJcblxyXG4gICAgaWYgKGUua2V5ID09PSAnQXJyb3dEb3duJykge1xyXG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIGNvbnN0IG5leHRJbmRleCA9IGN1cnJlbnRJbmRleCA8IGVuYWJsZWRPcHRpb25zLmxlbmd0aCAtIDEgPyBjdXJyZW50SW5kZXggKyAxIDogMDtcclxuICAgICAgY29uc3QgbmV4dE9wdGlvbiA9IGVuYWJsZWRPcHRpb25zW25leHRJbmRleF07XHJcbiAgICAgIGNvbnN0IG5leHRPcHRpb25JbmRleCA9IG9wdGlvbnMuaW5kZXhPZihuZXh0T3B0aW9uKTtcclxuICAgICAgc2V0Rm9jdXNlZEluZGV4KG5leHRPcHRpb25JbmRleCk7XHJcbiAgICAgIGlmIChtZW51UmVmLmN1cnJlbnQpIHtcclxuICAgICAgICBjb25zdCBvcHRpb25FbGVtZW50ID0gdGVzdElEXHJcbiAgICAgICAgICA/IG1lbnVSZWYuY3VycmVudC5xdWVyeVNlbGVjdG9yKGBbZGF0YS10ZXN0aWQ9XCIke3Rlc3RJRH0tb3B0aW9uLSR7bmV4dE9wdGlvbkluZGV4fVwiXWApXHJcbiAgICAgICAgICA6IG1lbnVSZWYuY3VycmVudC5xdWVyeVNlbGVjdG9yQWxsKCdbcm9sZT1cIm9wdGlvblwiXScpW25leHRPcHRpb25JbmRleF07XHJcbiAgICAgICAgaWYgKG9wdGlvbkVsZW1lbnQpIHtcclxuICAgICAgICAgIG9wdGlvbkVsZW1lbnQuZm9jdXMoKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH0gZWxzZSBpZiAoZS5rZXkgPT09ICdBcnJvd1VwJykge1xyXG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIGNvbnN0IHByZXZJbmRleCA9IGN1cnJlbnRJbmRleCA+IDAgPyBjdXJyZW50SW5kZXggLSAxIDogZW5hYmxlZE9wdGlvbnMubGVuZ3RoIC0gMTtcclxuICAgICAgY29uc3QgcHJldk9wdGlvbiA9IGVuYWJsZWRPcHRpb25zW3ByZXZJbmRleF07XHJcbiAgICAgIGNvbnN0IHByZXZPcHRpb25JbmRleCA9IG9wdGlvbnMuaW5kZXhPZihwcmV2T3B0aW9uKTtcclxuICAgICAgc2V0Rm9jdXNlZEluZGV4KHByZXZPcHRpb25JbmRleCk7XHJcbiAgICAgIGlmIChtZW51UmVmLmN1cnJlbnQpIHtcclxuICAgICAgICBjb25zdCBvcHRpb25FbGVtZW50ID0gdGVzdElEXHJcbiAgICAgICAgICA/IG1lbnVSZWYuY3VycmVudC5xdWVyeVNlbGVjdG9yKGBbZGF0YS10ZXN0aWQ9XCIke3Rlc3RJRH0tb3B0aW9uLSR7cHJldk9wdGlvbkluZGV4fVwiXWApXHJcbiAgICAgICAgICA6IG1lbnVSZWYuY3VycmVudC5xdWVyeVNlbGVjdG9yQWxsKCdbcm9sZT1cIm9wdGlvblwiXScpW3ByZXZPcHRpb25JbmRleF07XHJcbiAgICAgICAgaWYgKG9wdGlvbkVsZW1lbnQpIHtcclxuICAgICAgICAgIG9wdGlvbkVsZW1lbnQuZm9jdXMoKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH0gZWxzZSBpZiAoZS5rZXkgPT09ICdFbnRlcicgfHwgZS5rZXkgPT09ICcgJykge1xyXG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIGlmIChjdXJyZW50SW5kZXggPj0gMCAmJiBjdXJyZW50SW5kZXggPCBlbmFibGVkT3B0aW9ucy5sZW5ndGgpIHtcclxuICAgICAgICBoYW5kbGVTZWxlY3QoZW5hYmxlZE9wdGlvbnNbY3VycmVudEluZGV4XS52YWx1ZSk7XHJcbiAgICAgIH1cclxuICAgIH0gZWxzZSBpZiAoZS5rZXkgPT09ICdFc2NhcGUnKSB7XHJcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgY2xvc2VTZWxlY3QoKTtcclxuICAgICAgaWYgKHJvb3RSZWYuY3VycmVudCkge1xyXG4gICAgICAgIGNvbnN0IHRyaWdnZXIgPSByb290UmVmLmN1cnJlbnQucXVlcnlTZWxlY3RvcignW3JvbGU9XCJjb21ib2JveFwiXScpO1xyXG4gICAgICAgIGlmICh0cmlnZ2VyKSB7XHJcbiAgICAgICAgICB0cmlnZ2VyLmZvY3VzKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgcmV0dXJuIChcclxuICAgIDxTdHlsZWRDb250YWluZXIgcmVmPXtyb290UmVmfSBzdHlsZT17c3R5bGV9IGNsYXNzTmFtZT17Y2xhc3NOYW1lfT5cclxuICAgICAge2xhYmVsID8gKFxyXG4gICAgICAgIDxTdHlsZWRMYWJlbFJvdz5cclxuICAgICAgICAgIDxTdHlsZWRMYWJlbD57bGFiZWx9PC9TdHlsZWRMYWJlbD5cclxuICAgICAgICAgIHtyZXF1aXJlZCA/IDxTdHlsZWRSZXF1aXJlZD4gKjwvU3R5bGVkUmVxdWlyZWQ+IDogbnVsbH1cclxuICAgICAgICA8L1N0eWxlZExhYmVsUm93PlxyXG4gICAgICApIDogbnVsbH1cclxuXHJcbiAgICAgIDxTdHlsZWRUcmlnZ2VyXHJcbiAgICAgICAgb25DbGljaz17ZGlzYWJsZWQgPyB1bmRlZmluZWQgOiB0b2dnbGVTZWxlY3R9XHJcbiAgICAgICAgb25Gb2N1cz17aGFuZGxlRm9jdXN9XHJcbiAgICAgICAgb25CbHVyPXtoYW5kbGVCbHVyfVxyXG4gICAgICAgIG9uS2V5RG93bj17aGFuZGxlVHJpZ2dlcktleURvd259XHJcbiAgICAgICAgZGlzYWJsZWQ9e2Rpc2FibGVkfVxyXG4gICAgICAgICR2YWxpZGF0aW9uU3RhdGU9e2ZpbmFsVmFsaWRhdGlvblN0YXRlfVxyXG4gICAgICAgICRpc0ZvY3VzZWQ9e2lzRm9jdXNlZH1cclxuICAgICAgICByb2xlPVwiY29tYm9ib3hcIlxyXG4gICAgICAgIGFyaWEtbGFiZWw9e2FjY2Vzc2liaWxpdHlMYWJlbCB8fCBsYWJlbCB8fCBkZWZhdWx0UGxhY2Vob2xkZXJ9XHJcbiAgICAgICAgYXJpYS1kZXNjcmliZWRieT17ZGlzcGxheUhlbHBlclRleHQgPyBgJHt0ZXN0SUQgfHwgJ3NlbGVjdCd9LWhlbHBlcmAgOiB1bmRlZmluZWR9XHJcbiAgICAgICAgYXJpYS1leHBhbmRlZD17b3Blbn1cclxuICAgICAgICBhcmlhLWhhc3BvcHVwPVwibGlzdGJveFwiXHJcbiAgICAgICAgYXJpYS1pbnZhbGlkPXtmaW5hbFZhbGlkYXRpb25TdGF0ZSA9PT0gJ2Vycm9yJ31cclxuICAgICAgICBhcmlhLXJlcXVpcmVkPXtyZXF1aXJlZH1cclxuICAgICAgICBkYXRhLXRlc3RpZD17dGVzdElEfVxyXG4gICAgICA+XHJcbiAgICAgICAgPFN0eWxlZFRyaWdnZXJUZXh0IGRpc2FibGVkPXtkaXNhYmxlZH0gJGlzUGxhY2Vob2xkZXI9eyFzZWxlY3RlZE9wdGlvbn0+XHJcbiAgICAgICAgICB7c2VsZWN0ZWRPcHRpb24gPyBzZWxlY3RlZE9wdGlvbi5sYWJlbCA6IGRlZmF1bHRQbGFjZWhvbGRlcn1cclxuICAgICAgICA8L1N0eWxlZFRyaWdnZXJUZXh0PlxyXG4gICAgICAgIDxTdHlsZWRDaGV2cm9uIGFyaWEtaGlkZGVuPVwidHJ1ZVwiPuKWvjwvU3R5bGVkQ2hldnJvbj5cclxuICAgICAgPC9TdHlsZWRUcmlnZ2VyPlxyXG5cclxuICAgICAge29wZW4gPyAoXHJcbiAgICAgICAgPFN0eWxlZE1lbnVcclxuICAgICAgICAgIHJlZj17bWVudVJlZn1cclxuICAgICAgICAgIHJvbGU9XCJsaXN0Ym94XCJcclxuICAgICAgICAgIG9uS2V5RG93bj17aGFuZGxlTWVudUtleURvd259XHJcbiAgICAgICAgICBkYXRhLXRlc3RpZD17dGVzdElEID8gYCR7dGVzdElEfS1tZW51YCA6IHVuZGVmaW5lZH1cclxuICAgICAgICA+XHJcbiAgICAgICAgICB7b3B0aW9ucy5tYXAoKG9wdCwgaW5kZXgpID0+IChcclxuICAgICAgICAgICAgPFN0eWxlZE9wdGlvblxyXG4gICAgICAgICAgICAgIGtleT17YCR7U3RyaW5nKG9wdC52YWx1ZSl9LSR7aW5kZXh9YH1cclxuICAgICAgICAgICAgICBkaXNhYmxlZD17ISFvcHQuZGlzYWJsZWR9XHJcbiAgICAgICAgICAgICAgb25DbGljaz17KCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKG9wdC5kaXNhYmxlZCkgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgaGFuZGxlU2VsZWN0KG9wdC52YWx1ZSk7XHJcbiAgICAgICAgICAgICAgfX1cclxuICAgICAgICAgICAgICBvbkZvY3VzPXsoKSA9PiBzZXRGb2N1c2VkSW5kZXgoaW5kZXgpfVxyXG4gICAgICAgICAgICAgIHJvbGU9XCJvcHRpb25cIlxyXG4gICAgICAgICAgICAgIGFyaWEtc2VsZWN0ZWQ9e3ZhbHVlID09PSBvcHQudmFsdWV9XHJcbiAgICAgICAgICAgICAgYXJpYS1kaXNhYmxlZD17b3B0LmRpc2FibGVkfVxyXG4gICAgICAgICAgICAgIGFyaWEtbGFiZWw9e29wdC5sYWJlbH1cclxuICAgICAgICAgICAgICB0YWJJbmRleD17b3B0LmRpc2FibGVkID8gLTEgOiBpbmRleCA9PT0gMCA/IDAgOiAtMX1cclxuICAgICAgICAgICAgICBkYXRhLXRlc3RpZD17dGVzdElEID8gYCR7dGVzdElEfS1vcHRpb24tJHtpbmRleH1gIDogdW5kZWZpbmVkfVxyXG4gICAgICAgICAgICA+XHJcbiAgICAgICAgICAgICAgPFN0eWxlZE9wdGlvblRleHQ+e29wdC5sYWJlbH08L1N0eWxlZE9wdGlvblRleHQ+XHJcbiAgICAgICAgICAgIDwvU3R5bGVkT3B0aW9uPlxyXG4gICAgICAgICAgKSl9XHJcbiAgICAgICAgPC9TdHlsZWRNZW51PlxyXG4gICAgICApIDogbnVsbH1cclxuXHJcbiAgICAgIHtkaXNwbGF5SGVscGVyVGV4dCA/IChcclxuICAgICAgICA8U3R5bGVkSGVscGVyVGV4dFxyXG4gICAgICAgICAgJHZhbGlkYXRpb25TdGF0ZT17ZmluYWxWYWxpZGF0aW9uU3RhdGV9XHJcbiAgICAgICAgICBpZD17dGVzdElEID8gYCR7dGVzdElEfS1oZWxwZXJgIDogdW5kZWZpbmVkfVxyXG4gICAgICAgID5cclxuICAgICAgICAgIHtkaXNwbGF5SGVscGVyVGV4dH1cclxuICAgICAgICA8L1N0eWxlZEhlbHBlclRleHQ+XHJcbiAgICAgICkgOiBudWxsfVxyXG4gICAgPC9TdHlsZWRDb250YWluZXI+XHJcbiAgKTtcclxufTtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IFNlbGVjdFdlYjtcclxuXHJcblxyXG4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFNQSxJQUFBQSxNQUFBLEdBQUFDLHVCQUFBLENBQUFDLE9BQUE7QUFLQSxJQUFBQyxNQUFBLEdBQUFELE9BQUE7QUFHQSxJQUFBRSxVQUFBLEdBQUFGLE9BQUE7QUFlQSxJQUFBRyxXQUFBLEdBQUFDLHNCQUFBLENBQUFKLE9BQUE7QUFHQSxJQUFBSyxNQUFBLEdBQUFMLE9BQUE7QUFBNEMsSUFBQU0sV0FBQSxHQUFBTixPQUFBO0FBNEI1QyxJQUFNTyxTQUFTLEdBQUcsU0FBWkEsU0FBU0EsQ0FBQUMsSUFBQSxFQWlCVDtFQUFBLElBaEJKQyxLQUFLLEdBQUFELElBQUEsQ0FBTEMsS0FBSztJQUNMQyxXQUFXLEdBQUFGLElBQUEsQ0FBWEUsV0FBVztJQUFBQyxZQUFBLEdBQUFILElBQUEsQ0FDWEksT0FBTztJQUFQQSxPQUFPLEdBQUFELFlBQUEsY0FBRyxFQUFFLEdBQUFBLFlBQUE7SUFDWkUsS0FBSyxHQUFBTCxJQUFBLENBQUxLLEtBQUs7SUFDTEMsYUFBYSxHQUFBTixJQUFBLENBQWJNLGFBQWE7SUFBQUMsYUFBQSxHQUFBUCxJQUFBLENBQ2JRLFFBQVE7SUFBUkEsUUFBUSxHQUFBRCxhQUFBLGNBQUcsS0FBSyxHQUFBQSxhQUFBO0lBQUFFLGFBQUEsR0FBQVQsSUFBQSxDQUNoQlUsUUFBUTtJQUFSQSxRQUFRLEdB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