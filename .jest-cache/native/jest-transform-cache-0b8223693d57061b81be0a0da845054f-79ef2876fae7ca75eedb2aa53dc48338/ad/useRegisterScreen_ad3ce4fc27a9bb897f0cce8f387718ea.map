{"version":3,"names":["_react","require","_expoRouter","_hooks","_config","_utils","_types","resolveErrorMessage","t","errorCode","key","resolved","useRegisterScreen","_useI18n","useI18n","router","useRouter","_useNetwork","useNetwork","isOffline","_useAuth","useAuth","register","clearError","isLoading","isAuthenticated","roles","canAccessRegister","useMemo","_AUTH$REGISTER_ROLES","AUTH","REGISTER_ROLES","length","some","role","includes","accessErrorMessage","_useState","useState","STEPS","ORGANIZATION","_useState2","_slicedToArray2","default","step","setStep","_useState3","_useState4","email","setEmail","_useState5","_useState6","password","setPassword","_useState7","_useState8","tenantId","setTenantId","_useState9","_useState0","facilityId","setFacilityId","_useState1","_useState10","phone","setPhone","_useState11","_useState12","tenantIdError","setTenantIdError","_useState13","_useState14","facilityIdError","setFacilityIdError","errorMessage","isTenantValid","isValidUuid","isFacilityValid","canProceed","Boolean","canSubmit","DETAILS","resolveTenantError","useCallback","trim","resolveFacilityError","handleContinue","nextTenantError","nextFacilityError","handleSubmit","_asyncToGenerator2","normalizedPhone","normalizePhoneNumber","tenant_id","facility_id","undefined","handleChangeEmail","value","handleChangePassword","handleChangeTenantId","handleChangeFacilityId","handleChangePhone","handleGoToLogin","push","handleBack","_default","exports"],"sources":["useRegisterScreen.js"],"sourcesContent":["/**\r\n * useRegisterScreen Hook\r\n * Shared behavior/logic for RegisterScreen across all platforms.\r\n * File: useRegisterScreen.js\r\n */\r\nimport { useCallback, useMemo, useState } from 'react';\r\nimport { useRouter } from 'expo-router';\r\nimport { useAuth, useI18n, useNetwork } from '@hooks';\r\nimport { AUTH } from '@config';\r\nimport { isValidUuid, normalizePhoneNumber } from '@utils';\r\nimport { STEPS } from './types';\r\n\r\nconst resolveErrorMessage = (t, errorCode) => {\r\n  if (!errorCode) return null;\r\n  const key = `errors.codes.${errorCode}`;\r\n  const resolved = t(key);\r\n  return resolved === key ? t('errors.codes.UNKNOWN_ERROR') : resolved;\r\n};\r\n\r\nconst useRegisterScreen = () => {\r\n  const { t } = useI18n();\r\n  const router = useRouter();\r\n  const { isOffline } = useNetwork();\r\n  const {\r\n    register,\r\n    clearError,\r\n    isLoading,\r\n    errorCode,\r\n    isAuthenticated,\r\n    roles,\r\n  } = useAuth();\r\n  const canAccessRegister = useMemo(() => {\r\n    if (!isAuthenticated) return false;\r\n    if (!AUTH.REGISTER_ROLES?.length) return false;\r\n    return AUTH.REGISTER_ROLES.some((role) => roles.includes(role));\r\n  }, [isAuthenticated, roles]);\r\n\r\n  const accessErrorMessage = useMemo(() => {\r\n    if (canAccessRegister) return null;\r\n    return t('errors.codes.FORBIDDEN');\r\n  }, [canAccessRegister, t]);\r\n  const [step, setStep] = useState(STEPS.ORGANIZATION);\r\n  const [email, setEmail] = useState('');\r\n  const [password, setPassword] = useState('');\r\n  const [tenantId, setTenantId] = useState('');\r\n  const [facilityId, setFacilityId] = useState('');\r\n  const [phone, setPhone] = useState('');\r\n  const [tenantIdError, setTenantIdError] = useState(null);\r\n  const [facilityIdError, setFacilityIdError] = useState(null);\r\n\r\n  const errorMessage = useMemo(\r\n    () => resolveErrorMessage(t, errorCode),\r\n    [errorCode, t]\r\n  );\r\n\r\n  const isTenantValid = useMemo(() => isValidUuid(tenantId), [tenantId]);\r\n  const isFacilityValid = useMemo(\r\n    () => (facilityId ? isValidUuid(facilityId) : true),\r\n    [facilityId]\r\n  );\r\n\r\n  const canProceed = useMemo(\r\n    () => Boolean(isTenantValid && isFacilityValid) && !isLoading && !isOffline && canAccessRegister,\r\n    [canAccessRegister, isFacilityValid, isLoading, isOffline, isTenantValid]\r\n  );\r\n\r\n  const canSubmit = useMemo(\r\n    () => Boolean(email && password && tenantId) && !isLoading && !isOffline && step === STEPS.DETAILS && canAccessRegister,\r\n    [canAccessRegister, email, isLoading, isOffline, password, step, tenantId]\r\n  );\r\n\r\n  const resolveTenantError = useCallback(() => {\r\n    if (!tenantId.trim()) return t('forms.validation.required');\r\n    if (!isValidUuid(tenantId)) return t('forms.validation.invalidUuid');\r\n    return null;\r\n  }, [t, tenantId]);\r\n\r\n  const resolveFacilityError = useCallback(() => {\r\n    if (!facilityId.trim()) return null;\r\n    if (!isValidUuid(facilityId)) return t('forms.validation.invalidUuid');\r\n    return null;\r\n  }, [facilityId, t]);\r\n\r\n  const handleContinue = useCallback(() => {\r\n    const nextTenantError = resolveTenantError();\r\n    const nextFacilityError = resolveFacilityError();\r\n    setTenantIdError(nextTenantError);\r\n    setFacilityIdError(nextFacilityError);\r\n    if (nextTenantError || nextFacilityError) {\r\n      return false;\r\n    }\r\n    setStep(STEPS.DETAILS);\r\n    return true;\r\n  }, [resolveFacilityError, resolveTenantError]);\r\n\r\n  const handleSubmit = useCallback(async () => {\r\n    if (!canSubmit) return false;\r\n    clearError();\r\n    const normalizedPhone = phone ? normalizePhoneNumber(phone) : '';\r\n    await register({\r\n      email: email.trim(),\r\n      password,\r\n      tenant_id: tenantId.trim(),\r\n      facility_id: facilityId.trim() || undefined,\r\n      phone: normalizedPhone || undefined,\r\n    });\r\n    return true;\r\n  }, [canSubmit, clearError, email, facilityId, password, phone, register, tenantId]);\r\n\r\n  const handleChangeEmail = useCallback((value) => {\r\n    setEmail(value);\r\n  }, []);\r\n\r\n  const handleChangePassword = useCallback((value) => {\r\n    setPassword(value);\r\n  }, []);\r\n\r\n  const handleChangeTenantId = useCallback((value) => {\r\n    setTenantId(value);\r\n    setTenantIdError(null);\r\n  }, []);\r\n\r\n  const handleChangeFacilityId = useCallback((value) => {\r\n    setFacilityId(value);\r\n    setFacilityIdError(null);\r\n  }, []);\r\n\r\n  const handleChangePhone = useCallback((value) => {\r\n    setPhone(value);\r\n  }, []);\r\n\r\n  const handleGoToLogin = useCallback(() => {\r\n    router.push('/login');\r\n  }, [router]);\r\n\r\n  const handleBack = useCallback(() => {\r\n    setStep(STEPS.ORGANIZATION);\r\n  }, []);\r\n\r\n  return {\r\n    step,\r\n    email,\r\n    password,\r\n    tenantId,\r\n    facilityId,\r\n    phone,\r\n    tenantIdError,\r\n    facilityIdError,\r\n    accessErrorMessage,\r\n    errorMessage,\r\n    isLoading,\r\n    isOffline,\r\n    canProceed,\r\n    canSubmit,\r\n    handleContinue,\r\n    handleSubmit,\r\n    handleChangeEmail,\r\n    handleChangePassword,\r\n    handleChangeTenantId,\r\n    handleChangeFacilityId,\r\n    handleChangePhone,\r\n    handleGoToLogin,\r\n    handleBack,\r\n  };\r\n};\r\n\r\nexport default useRegisterScreen;\r\n\r\n"],"mappings":"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","ignoreList":[]}