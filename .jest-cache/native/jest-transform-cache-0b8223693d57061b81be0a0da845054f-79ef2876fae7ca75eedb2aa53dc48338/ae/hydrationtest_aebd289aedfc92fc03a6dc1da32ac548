bc45cecce2f731a789f2dfb7b39e3a74
_getJestObj().mock("../../offline/queue", function () {
  return {
    getQueue: jest.fn()
  };
});
_getJestObj().mock("../../errors", function () {
  return {
    handleError: jest.fn()
  };
});
_getJestObj().mock("../../logging", function () {
  return {
    logger: {
      info: jest.fn(),
      error: jest.fn(),
      debug: jest.fn(),
      warn: jest.fn()
    }
  };
});
var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault").default;
var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));
var _errors = require("../../errors");
var _logging = require("../../logging");
var _queue = require("../../offline/queue");
var _hydration = require("../../offline/hydration");
function _getJestObj() {
  var _require = require("@jest/globals"),
    jest = _require.jest;
  _getJestObj = function _getJestObj() {
    return jest;
  };
  return jest;
}
describe('Hydration', function () {
  beforeEach(function () {
    jest.clearAllMocks();
  });
  describe('hydrate', function () {
    it('hydrates queue from storage', (0, _asyncToGenerator2.default)(function* () {
      var queue = [{
        id: '1',
        url: '/api/test1'
      }, {
        id: '2',
        url: '/api/test2'
      }];
      _queue.getQueue.mockResolvedValue(queue);
      var result = yield (0, _hydration.hydrate)();
      expect(result).toEqual({
        queue: queue
      });
      expect(_queue.getQueue).toHaveBeenCalled();
      expect(_logging.logger.info).toHaveBeenCalledWith('Hydrated offline queue', {
        count: 2
      });
      expect(_errors.handleError).not.toHaveBeenCalled();
    }));
    it('returns empty queue when no items exist', (0, _asyncToGenerator2.default)(function* () {
      _queue.getQueue.mockResolvedValue([]);
      yield expect((0, _hydration.hydrate)()).resolves.toEqual({
        queue: []
      });
      expect(_logging.logger.info).toHaveBeenCalledWith('Hydrated offline queue', {
        count: 0
      });
    }));
    it('handles errors gracefully (returns empty queue + reports)', (0, _asyncToGenerator2.default)(function* () {
      _queue.getQueue.mockRejectedValue(new Error('Storage error'));
      var result = yield (0, _hydration.hydrate)();
      expect(result).toEqual({
        queue: []
      });
      expect(_errors.handleError).toHaveBeenCalled();
    }));
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfZ2V0SmVzdE9iaiIsIm1vY2siLCJnZXRRdWV1ZSIsImplc3QiLCJmbiIsImhhbmRsZUVycm9yIiwibG9nZ2VyIiwiaW5mbyIsImVycm9yIiwiZGVidWciLCJ3YXJuIiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsInJlcXVpcmUiLCJkZWZhdWx0IiwiX2FzeW5jVG9HZW5lcmF0b3IyIiwiX2Vycm9ycyIsIl9sb2dnaW5nIiwiX3F1ZXVlIiwiX2h5ZHJhdGlvbiIsIl9yZXF1aXJlIiwiZGVzY3JpYmUiLCJiZWZvcmVFYWNoIiwiY2xlYXJBbGxNb2NrcyIsIml0IiwicXVldWUiLCJpZCIsInVybCIsIm1vY2tSZXNvbHZlZFZhbHVlIiwicmVzdWx0IiwiaHlkcmF0ZSIsImV4cGVjdCIsInRvRXF1YWwiLCJ0b0hhdmVCZWVuQ2FsbGVkIiwidG9IYXZlQmVlbkNhbGxlZFdpdGgiLCJjb3VudCIsIm5vdCIsInJlc29sdmVzIiwibW9ja1JlamVjdGVkVmFsdWUiLCJFcnJvciJdLCJzb3VyY2VzIjpbImh5ZHJhdGlvbi50ZXN0LmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBIeWRyYXRpb24gVGVzdHNcclxuICogRmlsZTogaHlkcmF0aW9uLnRlc3QuanNcclxuICovXHJcbmltcG9ydCB7IGhhbmRsZUVycm9yIH0gZnJvbSAnQGVycm9ycyc7XHJcbmltcG9ydCB7IGxvZ2dlciB9IGZyb20gJ0Bsb2dnaW5nJztcclxuaW1wb3J0IHsgZ2V0UXVldWUgfSBmcm9tICdAb2ZmbGluZS9xdWV1ZSc7XHJcbmltcG9ydCB7IGh5ZHJhdGUgfSBmcm9tICdAb2ZmbGluZS9oeWRyYXRpb24nO1xyXG5cclxuamVzdC5tb2NrKCdAb2ZmbGluZS9xdWV1ZScsICgpID0+ICh7XHJcbiAgZ2V0UXVldWU6IGplc3QuZm4oKSxcclxufSkpO1xyXG5cclxuamVzdC5tb2NrKCdAZXJyb3JzJywgKCkgPT4gKHtcclxuICBoYW5kbGVFcnJvcjogamVzdC5mbigpLFxyXG59KSk7XHJcblxyXG5qZXN0Lm1vY2soJ0Bsb2dnaW5nJywgKCkgPT4gKHtcclxuICBsb2dnZXI6IHsgaW5mbzogamVzdC5mbigpLCBlcnJvcjogamVzdC5mbigpLCBkZWJ1ZzogamVzdC5mbigpLCB3YXJuOiBqZXN0LmZuKCkgfSxcclxufSkpO1xyXG5cclxuZGVzY3JpYmUoJ0h5ZHJhdGlvbicsICgpID0+IHtcclxuICBiZWZvcmVFYWNoKCgpID0+IHtcclxuICAgIGplc3QuY2xlYXJBbGxNb2NrcygpO1xyXG4gIH0pO1xyXG5cclxuICBkZXNjcmliZSgnaHlkcmF0ZScsICgpID0+IHtcclxuICAgIGl0KCdoeWRyYXRlcyBxdWV1ZSBmcm9tIHN0b3JhZ2UnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IHF1ZXVlID0gW1xyXG4gICAgICAgIHsgaWQ6ICcxJywgdXJsOiAnL2FwaS90ZXN0MScgfSxcclxuICAgICAgICB7IGlkOiAnMicsIHVybDogJy9hcGkvdGVzdDInIH0sXHJcbiAgICAgIF07XHJcbiAgICAgIGdldFF1ZXVlLm1vY2tSZXNvbHZlZFZhbHVlKHF1ZXVlKTtcclxuXHJcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGh5ZHJhdGUoKTtcclxuXHJcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwoeyBxdWV1ZSB9KTtcclxuICAgICAgZXhwZWN0KGdldFF1ZXVlKS50b0hhdmVCZWVuQ2FsbGVkKCk7XHJcbiAgICAgIGV4cGVjdChsb2dnZXIuaW5mbykudG9IYXZlQmVlbkNhbGxlZFdpdGgoJ0h5ZHJhdGVkIG9mZmxpbmUgcXVldWUnLCB7IGNvdW50OiAyIH0pO1xyXG4gICAgICBleHBlY3QoaGFuZGxlRXJyb3IpLm5vdC50b0hhdmVCZWVuQ2FsbGVkKCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgncmV0dXJucyBlbXB0eSBxdWV1ZSB3aGVuIG5vIGl0ZW1zIGV4aXN0JywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICBnZXRRdWV1ZS5tb2NrUmVzb2x2ZWRWYWx1ZShbXSk7XHJcbiAgICAgIGF3YWl0IGV4cGVjdChoeWRyYXRlKCkpLnJlc29sdmVzLnRvRXF1YWwoeyBxdWV1ZTogW10gfSk7XHJcbiAgICAgIGV4cGVjdChsb2dnZXIuaW5mbykudG9IYXZlQmVlbkNhbGxlZFdpdGgoJ0h5ZHJhdGVkIG9mZmxpbmUgcXVldWUnLCB7IGNvdW50OiAwIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ2hhbmRsZXMgZXJyb3JzIGdyYWNlZnVsbHkgKHJldHVybnMgZW1wdHkgcXVldWUgKyByZXBvcnRzKScsIGFzeW5jICgpID0+IHtcclxuICAgICAgZ2V0UXVldWUubW9ja1JlamVjdGVkVmFsdWUobmV3IEVycm9yKCdTdG9yYWdlIGVycm9yJykpO1xyXG5cclxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgaHlkcmF0ZSgpO1xyXG5cclxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbCh7IHF1ZXVlOiBbXSB9KTtcclxuICAgICAgZXhwZWN0KGhhbmRsZUVycm9yKS50b0hhdmVCZWVuQ2FsbGVkKCk7XHJcbiAgICB9KTtcclxuICB9KTtcclxufSk7XHJcblxyXG4iXSwibWFwcGluZ3MiOiJBQVNBQSxXQUFBLEdBQUtDLElBQUksd0JBQW1CO0VBQUEsT0FBTztJQUNqQ0MsUUFBUSxFQUFFQyxJQUFJLENBQUNDLEVBQUUsQ0FBQztFQUNwQixDQUFDO0FBQUEsQ0FBQyxDQUFDO0FBRUhKLFdBQUEsR0FBS0MsSUFBSSxpQkFBWTtFQUFBLE9BQU87SUFDMUJJLFdBQVcsRUFBRUYsSUFBSSxDQUFDQyxFQUFFLENBQUM7RUFDdkIsQ0FBQztBQUFBLENBQUMsQ0FBQztBQUVISixXQUFBLEdBQUtDLElBQUksa0JBQWE7RUFBQSxPQUFPO0lBQzNCSyxNQUFNLEVBQUU7TUFBRUMsSUFBSSxFQUFFSixJQUFJLENBQUNDLEVBQUUsQ0FBQyxDQUFDO01BQUVJLEtBQUssRUFBRUwsSUFBSSxDQUFDQyxFQUFFLENBQUMsQ0FBQztNQUFFSyxLQUFLLEVBQUVOLElBQUksQ0FBQ0MsRUFBRSxDQUFDLENBQUM7TUFBRU0sSUFBSSxFQUFFUCxJQUFJLENBQUNDLEVBQUUsQ0FBQztJQUFFO0VBQ2pGLENBQUM7QUFBQSxDQUFDLENBQUM7QUFBQyxJQUFBTyxzQkFBQSxHQUFBQyxPQUFBLGlEQUFBQyxPQUFBO0FBQUEsSUFBQUMsa0JBQUEsR0FBQUgsc0JBQUEsQ0FBQUMsT0FBQTtBQWZKLElBQUFHLE9BQUEsR0FBQUgsT0FBQTtBQUNBLElBQUFJLFFBQUEsR0FBQUosT0FBQTtBQUNBLElBQUFLLE1BQUEsR0FBQUwsT0FBQTtBQUNBLElBQUFNLFVBQUEsR0FBQU4sT0FBQTtBQUE2QyxTQUFBWixZQUFBO0VBQUEsSUFBQW1CLFFBQUEsR0FBQVAsT0FBQTtJQUFBVCxJQUFBLEdBQUFnQixRQUFBLENBQUFoQixJQUFBO0VBQUFILFdBQUEsWUFBQUEsWUFBQTtJQUFBLE9BQUFHLElBQUE7RUFBQTtFQUFBLE9BQUFBLElBQUE7QUFBQTtBQWM3Q2lCLFFBQVEsQ0FBQyxXQUFXLEVBQUUsWUFBTTtFQUMxQkMsVUFBVSxDQUFDLFlBQU07SUFDZmxCLElBQUksQ0FBQ21CLGFBQWEsQ0FBQyxDQUFDO0VBQ3RCLENBQUMsQ0FBQztFQUVGRixRQUFRLENBQUMsU0FBUyxFQUFFLFlBQU07SUFDeEJHLEVBQUUsQ0FBQyw2QkFBNkIsTUFBQVQsa0JBQUEsQ0FBQUQsT0FBQSxFQUFFLGFBQVk7TUFDNUMsSUFBTVcsS0FBSyxHQUFHLENBQ1o7UUFBRUMsRUFBRSxFQUFFLEdBQUc7UUFBRUMsR0FBRyxFQUFFO01BQWEsQ0FBQyxFQUM5QjtRQUFFRCxFQUFFLEVBQUUsR0FBRztRQUFFQyxHQUFHLEVBQUU7TUFBYSxDQUFDLENBQy9CO01BQ0R4QixlQUFRLENBQUN5QixpQkFBaUIsQ0FBQ0gsS0FBSyxDQUFDO01BRWpDLElBQU1JLE1BQU0sU0FBUyxJQUFBQyxrQkFBTyxFQUFDLENBQUM7TUFFOUJDLE1BQU0sQ0FBQ0YsTUFBTSxDQUFDLENBQUNHLE9BQU8sQ0FBQztRQUFFUCxLQUFLLEVBQUxBO01BQU0sQ0FBQyxDQUFDO01BQ2pDTSxNQUFNLENBQUM1QixlQUFRLENBQUMsQ0FBQzhCLGdCQUFnQixDQUFDLENBQUM7TUFDbkNGLE1BQU0sQ0FBQ3hCLGVBQU0sQ0FBQ0MsSUFBSSxDQUFDLENBQUMwQixvQkFBb0IsQ0FBQyx3QkFBd0IsRUFBRTtRQUFFQyxLQUFLLEVBQUU7TUFBRSxDQUFDLENBQUM7TUFDaEZKLE1BQU0sQ0FBQ3pCLG1CQUFXLENBQUMsQ0FBQzhCLEdBQUcsQ0FBQ0gsZ0JBQWdCLENBQUMsQ0FBQztJQUM1QyxDQUFDLEVBQUM7SUFFRlQsRUFBRSxDQUFDLHlDQUF5QyxNQUFBVCxrQkFBQSxDQUFBRCxPQUFBLEVBQUUsYUFBWTtNQUN4RFgsZUFBUSxDQUFDeUIsaUJBQWlCLENBQUMsRUFBRSxDQUFDO01BQzlCLE1BQU1HLE1BQU0sQ0FBQyxJQUFBRCxrQkFBTyxFQUFDLENBQUMsQ0FBQyxDQUFDTyxRQUFRLENBQUNMLE9BQU8sQ0FBQztRQUFFUCxLQUFLLEVBQUU7TUFBRyxDQUFDLENBQUM7TUFDdkRNLE1BQU0sQ0FBQ3hCLGVBQU0sQ0FBQ0MsSUFBSSxDQUFDLENBQUMwQixvQkFBb0IsQ0FBQyx3QkFBd0IsRUFBRTtRQUFFQyxLQUFLLEVBQUU7TUFBRSxDQUFDLENBQUM7SUFDbEYsQ0FBQyxFQUFDO0lBRUZYLEVBQUUsQ0FBQywyREFBMkQsTUFBQVQsa0JBQUEsQ0FBQUQsT0FBQSxFQUFFLGFBQVk7TUFDMUVYLGVBQVEsQ0FBQ21DLGlCQUFpQixDQUFDLElBQUlDLEtBQUssQ0FBQyxlQUFlLENBQUMsQ0FBQztNQUV0RCxJQUFNVixNQUFNLFNBQVMsSUFBQUMsa0JBQU8sRUFBQyxDQUFDO01BRTlCQyxNQUFNLENBQUNGLE1BQU0sQ0FBQyxDQUFDRyxPQUFPLENBQUM7UUFBRVAsS0FBSyxFQUFFO01BQUcsQ0FBQyxDQUFDO01BQ3JDTSxNQUFNLENBQUN6QixtQkFBVyxDQUFDLENBQUMyQixnQkFBZ0IsQ0FBQyxDQUFDO0lBQ3hDLENBQUMsRUFBQztFQUNKLENBQUMsQ0FBQztBQUNKLENBQUMsQ0FBQyIsImlnbm9yZUxpc3QiOltdfQ==