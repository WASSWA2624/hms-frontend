{"version":3,"names":["useCallback","useMemo","useState","useRouter","useI18n","useNetwork","useAuth","cov_ltlaa7isj","s","useFacilitySelectionScreen","f","_ref","t","router","_ref2","isOffline","_ref3","login","_ref4","_ref5","_slicedToArray","facilities","setFacilities","_ref6","_ref7","selectedFacilityId","setSelectedFacilityId","_ref8","_ref9","isLoading","setIsLoading","_ref0","_ref1","errorMessage","setErrorMessage","_ref10","_ref11","loginPayload","setLoginPayload","canSubmit","b","Boolean","initialize","facilitiesList","payload","length","id","handleSelectFacility","facilityId","handleSubmit","_asyncToGenerator","Object","assign","facility_id","replace","error","message","handleGoBack","back"],"sources":["useFacilitySelectionScreen.js"],"sourcesContent":["/**\r\n * useFacilitySelectionScreen Hook\r\n * Shared behavior/logic for FacilitySelectionScreen across all platforms.\r\n * File: useFacilitySelectionScreen.js\r\n */\r\nimport { useCallback, useMemo, useState } from 'react';\r\nimport { useRouter } from 'expo-router';\r\nimport { useI18n, useNetwork, useAuth } from '@hooks';\r\n\r\nconst useFacilitySelectionScreen = () => {\r\n  const { t } = useI18n();\r\n  const router = useRouter();\r\n  const { isOffline } = useNetwork();\r\n  const { login } = useAuth();\r\n  const [facilities, setFacilities] = useState([]);\r\n  const [selectedFacilityId, setSelectedFacilityId] = useState('');\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [errorMessage, setErrorMessage] = useState(null);\r\n  const [loginPayload, setLoginPayload] = useState(null);\r\n\r\n  const canSubmit = useMemo(\r\n    () => Boolean(selectedFacilityId) && !isLoading && !isOffline,\r\n    [selectedFacilityId, isLoading, isOffline]\r\n  );\r\n\r\n  const initialize = useCallback((facilitiesList, payload) => {\r\n    setFacilities(facilitiesList || []);\r\n    setLoginPayload(payload);\r\n    if (facilitiesList && facilitiesList.length === 1) {\r\n      // Auto-select if only one facility\r\n      setSelectedFacilityId(facilitiesList[0].id);\r\n    }\r\n  }, []);\r\n\r\n  const handleSelectFacility = useCallback((facilityId) => {\r\n    setSelectedFacilityId(facilityId);\r\n  }, []);\r\n\r\n  const handleSubmit = useCallback(async () => {\r\n    if (!canSubmit || !loginPayload) return false;\r\n\r\n    setIsLoading(true);\r\n    setErrorMessage(null);\r\n\r\n    try {\r\n      await login({\r\n        ...loginPayload,\r\n        facility_id: selectedFacilityId,\r\n      });\r\n      router.replace('/home');\r\n    } catch (error) {\r\n      setErrorMessage(error?.message || t('auth.facilitySelection.error'));\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n\r\n    return true;\r\n  }, [canSubmit, selectedFacilityId, loginPayload, login, router, t]);\r\n\r\n  const handleGoBack = useCallback(() => {\r\n    router.back();\r\n  }, [router]);\r\n\r\n  return {\r\n    facilities,\r\n    selectedFacilityId,\r\n    isLoading,\r\n    isOffline,\r\n    errorMessage,\r\n    canSubmit,\r\n    initialize,\r\n    handleSelectFacility,\r\n    handleSubmit,\r\n    handleGoBack,\r\n  };\r\n};\r\n\r\nexport default useFacilitySelectionScreen;\r\n"],"mappings":"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","ignoreList":[]}