5541cb631696dae8eb9ed27538482c77
_getJestObj().mock("../../offline/queue", function () {
  return {
    getQueue: jest.fn()
  };
});
_getJestObj().mock("../../errors", function () {
  return {
    handleError: jest.fn()
  };
});
var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault").default;
var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));
var _errors = require("../../errors");
var _queue = require("../../offline/queue");
var _hydration = require("../../offline/hydration");
function _getJestObj() {
  var _require = require("@jest/globals"),
    jest = _require.jest;
  _getJestObj = function _getJestObj() {
    return jest;
  };
  return jest;
}
describe('Hydration', function () {
  beforeEach(function () {
    jest.clearAllMocks();
  });
  describe('hydrate', function () {
    it('hydrates queue from storage', (0, _asyncToGenerator2.default)(function* () {
      var queue = [{
        id: '1',
        url: '/api/test1'
      }, {
        id: '2',
        url: '/api/test2'
      }];
      _queue.getQueue.mockResolvedValue(queue);
      var result = yield (0, _hydration.hydrate)();
      expect(result).toEqual({
        queue: queue
      });
      expect(_queue.getQueue).toHaveBeenCalled();
      expect(_errors.handleError).not.toHaveBeenCalled();
    }));
    it('returns empty queue when no items exist', (0, _asyncToGenerator2.default)(function* () {
      _queue.getQueue.mockResolvedValue([]);
      yield expect((0, _hydration.hydrate)()).resolves.toEqual({
        queue: []
      });
    }));
    it('handles errors gracefully (returns empty queue + reports)', (0, _asyncToGenerator2.default)(function* () {
      _queue.getQueue.mockRejectedValue(new Error('Storage error'));
      var result = yield (0, _hydration.hydrate)();
      expect(result).toEqual({
        queue: []
      });
      expect(_errors.handleError).toHaveBeenCalled();
    }));
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfZ2V0SmVzdE9iaiIsIm1vY2siLCJnZXRRdWV1ZSIsImplc3QiLCJmbiIsImhhbmRsZUVycm9yIiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsInJlcXVpcmUiLCJkZWZhdWx0IiwiX2FzeW5jVG9HZW5lcmF0b3IyIiwiX2Vycm9ycyIsIl9xdWV1ZSIsIl9oeWRyYXRpb24iLCJfcmVxdWlyZSIsImRlc2NyaWJlIiwiYmVmb3JlRWFjaCIsImNsZWFyQWxsTW9ja3MiLCJpdCIsInF1ZXVlIiwiaWQiLCJ1cmwiLCJtb2NrUmVzb2x2ZWRWYWx1ZSIsInJlc3VsdCIsImh5ZHJhdGUiLCJleHBlY3QiLCJ0b0VxdWFsIiwidG9IYXZlQmVlbkNhbGxlZCIsIm5vdCIsInJlc29sdmVzIiwibW9ja1JlamVjdGVkVmFsdWUiLCJFcnJvciJdLCJzb3VyY2VzIjpbImh5ZHJhdGlvbi50ZXN0LmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBIeWRyYXRpb24gVGVzdHNcclxuICogRmlsZTogaHlkcmF0aW9uLnRlc3QuanNcclxuICovXHJcbmltcG9ydCB7IGhhbmRsZUVycm9yIH0gZnJvbSAnQGVycm9ycyc7XHJcbmltcG9ydCB7IGdldFF1ZXVlIH0gZnJvbSAnQG9mZmxpbmUvcXVldWUnO1xyXG5pbXBvcnQgeyBoeWRyYXRlIH0gZnJvbSAnQG9mZmxpbmUvaHlkcmF0aW9uJztcclxuXHJcbmplc3QubW9jaygnQG9mZmxpbmUvcXVldWUnLCAoKSA9PiAoe1xyXG4gIGdldFF1ZXVlOiBqZXN0LmZuKCksXHJcbn0pKTtcclxuXHJcbmplc3QubW9jaygnQGVycm9ycycsICgpID0+ICh7XHJcbiAgaGFuZGxlRXJyb3I6IGplc3QuZm4oKSxcclxufSkpO1xyXG5cclxuZGVzY3JpYmUoJ0h5ZHJhdGlvbicsICgpID0+IHtcclxuICBiZWZvcmVFYWNoKCgpID0+IHtcclxuICAgIGplc3QuY2xlYXJBbGxNb2NrcygpO1xyXG4gIH0pO1xyXG5cclxuICBkZXNjcmliZSgnaHlkcmF0ZScsICgpID0+IHtcclxuICAgIGl0KCdoeWRyYXRlcyBxdWV1ZSBmcm9tIHN0b3JhZ2UnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IHF1ZXVlID0gW1xyXG4gICAgICAgIHsgaWQ6ICcxJywgdXJsOiAnL2FwaS90ZXN0MScgfSxcclxuICAgICAgICB7IGlkOiAnMicsIHVybDogJy9hcGkvdGVzdDInIH0sXHJcbiAgICAgIF07XHJcbiAgICAgIGdldFF1ZXVlLm1vY2tSZXNvbHZlZFZhbHVlKHF1ZXVlKTtcclxuXHJcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGh5ZHJhdGUoKTtcclxuXHJcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwoeyBxdWV1ZSB9KTtcclxuICAgICAgZXhwZWN0KGdldFF1ZXVlKS50b0hhdmVCZWVuQ2FsbGVkKCk7XHJcbiAgICAgIGV4cGVjdChoYW5kbGVFcnJvcikubm90LnRvSGF2ZUJlZW5DYWxsZWQoKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdyZXR1cm5zIGVtcHR5IHF1ZXVlIHdoZW4gbm8gaXRlbXMgZXhpc3QnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIGdldFF1ZXVlLm1vY2tSZXNvbHZlZFZhbHVlKFtdKTtcclxuICAgICAgYXdhaXQgZXhwZWN0KGh5ZHJhdGUoKSkucmVzb2x2ZXMudG9FcXVhbCh7IHF1ZXVlOiBbXSB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdoYW5kbGVzIGVycm9ycyBncmFjZWZ1bGx5IChyZXR1cm5zIGVtcHR5IHF1ZXVlICsgcmVwb3J0cyknLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIGdldFF1ZXVlLm1vY2tSZWplY3RlZFZhbHVlKG5ldyBFcnJvcignU3RvcmFnZSBlcnJvcicpKTtcclxuXHJcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGh5ZHJhdGUoKTtcclxuXHJcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwoeyBxdWV1ZTogW10gfSk7XHJcbiAgICAgIGV4cGVjdChoYW5kbGVFcnJvcikudG9IYXZlQmVlbkNhbGxlZCgpO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcbn0pO1xyXG5cclxuIl0sIm1hcHBpbmdzIjoiQUFRQUEsV0FBQSxHQUFLQyxJQUFJLHdCQUFtQjtFQUFBLE9BQU87SUFDakNDLFFBQVEsRUFBRUMsSUFBSSxDQUFDQyxFQUFFLENBQUM7RUFDcEIsQ0FBQztBQUFBLENBQUMsQ0FBQztBQUVISixXQUFBLEdBQUtDLElBQUksaUJBQVk7RUFBQSxPQUFPO0lBQzFCSSxXQUFXLEVBQUVGLElBQUksQ0FBQ0MsRUFBRSxDQUFDO0VBQ3ZCLENBQUM7QUFBQSxDQUFDLENBQUM7QUFBQyxJQUFBRSxzQkFBQSxHQUFBQyxPQUFBLGlEQUFBQyxPQUFBO0FBQUEsSUFBQUMsa0JBQUEsR0FBQUgsc0JBQUEsQ0FBQUMsT0FBQTtBQVZKLElBQUFHLE9BQUEsR0FBQUgsT0FBQTtBQUNBLElBQUFJLE1BQUEsR0FBQUosT0FBQTtBQUNBLElBQUFLLFVBQUEsR0FBQUwsT0FBQTtBQUE2QyxTQUFBUCxZQUFBO0VBQUEsSUFBQWEsUUFBQSxHQUFBTixPQUFBO0lBQUFKLElBQUEsR0FBQVUsUUFBQSxDQUFBVixJQUFBO0VBQUFILFdBQUEsWUFBQUEsWUFBQTtJQUFBLE9BQUFHLElBQUE7RUFBQTtFQUFBLE9BQUFBLElBQUE7QUFBQTtBQVU3Q1csUUFBUSxDQUFDLFdBQVcsRUFBRSxZQUFNO0VBQzFCQyxVQUFVLENBQUMsWUFBTTtJQUNmWixJQUFJLENBQUNhLGFBQWEsQ0FBQyxDQUFDO0VBQ3RCLENBQUMsQ0FBQztFQUVGRixRQUFRLENBQUMsU0FBUyxFQUFFLFlBQU07SUFDeEJHLEVBQUUsQ0FBQyw2QkFBNkIsTUFBQVIsa0JBQUEsQ0FBQUQsT0FBQSxFQUFFLGFBQVk7TUFDNUMsSUFBTVUsS0FBSyxHQUFHLENBQ1o7UUFBRUMsRUFBRSxFQUFFLEdBQUc7UUFBRUMsR0FBRyxFQUFFO01BQWEsQ0FBQyxFQUM5QjtRQUFFRCxFQUFFLEVBQUUsR0FBRztRQUFFQyxHQUFHLEVBQUU7TUFBYSxDQUFDLENBQy9CO01BQ0RsQixlQUFRLENBQUNtQixpQkFBaUIsQ0FBQ0gsS0FBSyxDQUFDO01BRWpDLElBQU1JLE1BQU0sU0FBUyxJQUFBQyxrQkFBTyxFQUFDLENBQUM7TUFFOUJDLE1BQU0sQ0FBQ0YsTUFBTSxDQUFDLENBQUNHLE9BQU8sQ0FBQztRQUFFUCxLQUFLLEVBQUxBO01BQU0sQ0FBQyxDQUFDO01BQ2pDTSxNQUFNLENBQUN0QixlQUFRLENBQUMsQ0FBQ3dCLGdCQUFnQixDQUFDLENBQUM7TUFDbkNGLE1BQU0sQ0FBQ25CLG1CQUFXLENBQUMsQ0FBQ3NCLEdBQUcsQ0FBQ0QsZ0JBQWdCLENBQUMsQ0FBQztJQUM1QyxDQUFDLEVBQUM7SUFFRlQsRUFBRSxDQUFDLHlDQUF5QyxNQUFBUixrQkFBQSxDQUFBRCxPQUFBLEVBQUUsYUFBWTtNQUN4RE4sZUFBUSxDQUFDbUIsaUJBQWlCLENBQUMsRUFBRSxDQUFDO01BQzlCLE1BQU1HLE1BQU0sQ0FBQyxJQUFBRCxrQkFBTyxFQUFDLENBQUMsQ0FBQyxDQUFDSyxRQUFRLENBQUNILE9BQU8sQ0FBQztRQUFFUCxLQUFLLEVBQUU7TUFBRyxDQUFDLENBQUM7SUFDekQsQ0FBQyxFQUFDO0lBRUZELEVBQUUsQ0FBQywyREFBMkQsTUFBQVIsa0JBQUEsQ0FBQUQsT0FBQSxFQUFFLGFBQVk7TUFDMUVOLGVBQVEsQ0FBQzJCLGlCQUFpQixDQUFDLElBQUlDLEtBQUssQ0FBQyxlQUFlLENBQUMsQ0FBQztNQUV0RCxJQUFNUixNQUFNLFNBQVMsSUFBQUMsa0JBQU8sRUFBQyxDQUFDO01BRTlCQyxNQUFNLENBQUNGLE1BQU0sQ0FBQyxDQUFDRyxPQUFPLENBQUM7UUFBRVAsS0FBSyxFQUFFO01BQUcsQ0FBQyxDQUFDO01BQ3JDTSxNQUFNLENBQUNuQixtQkFBVyxDQUFDLENBQUNxQixnQkFBZ0IsQ0FBQyxDQUFDO0lBQ3hDLENBQUMsRUFBQztFQUNKLENBQUMsQ0FBQztBQUNKLENBQUMsQ0FBQyIsImlnbm9yZUxpc3QiOltdfQ==