{"version":3,"names":["React","useEffect","useRef","Slot","useRouter","useShellBanners","useUiState","useAuthGuard","AuthFrame","LoadingOverlay","NoticeSurface","ShellBanners","GlobalFooter","FOOTER_VARIANTS","jsx","_jsx","cov_giatckpvh","s","AuthLayout","f","router","_ref","skipRedirect","authenticated","_ref2","isLoading","banners","hasRedirected","b","current","replace","bannerSlot","length","testID","overlaySlot","visible","banner","overlay","notices","footer","variant","AUTH","children"],"sources":["_layout.jsx"],"sourcesContent":["import React, { useEffect, useRef } from 'react';\r\nimport { Slot, useRouter } from 'expo-router';\r\nimport { useShellBanners, useUiState } from '@hooks';\r\nimport { useAuthGuard } from '@navigation/guards';\r\nimport { AuthFrame } from '@platform/layouts';\r\nimport { LoadingOverlay, NoticeSurface, ShellBanners } from '@platform/components';\r\nimport GlobalFooter, { FOOTER_VARIANTS } from '@platform/components/navigation/GlobalFooter';\r\n\r\n/**\r\n * Auth Group Layout\r\n * \r\n * Layout wrapper for authentication routes (login, register, etc.).\r\n * \r\n * Per app-router.mdc:\r\n * - Layouts use `_layout.jsx`, default exports, `<Slot />` for child routes\r\n * - Guard placement: guards in layouts, not screens\r\n * \r\n * This layout redirects authenticated users away from auth routes (e.g., login when already logged in).\r\n * Per Step 7.14: Uses useAuthGuard hook with skipRedirect option to get auth state,\r\n * then handles redirect of authenticated users to home route.\r\n */\r\nconst AuthLayout = () => {\r\n  const router = useRouter();\r\n  const { authenticated } = useAuthGuard({ skipRedirect: true });\r\n  const { isLoading } = useUiState();\r\n  const banners = useShellBanners();\r\n  \r\n  // Use ref to track if redirect has been performed to prevent multiple redirects\r\n  const hasRedirected = useRef(false);\r\n  \r\n  useEffect(() => {\r\n    // Redirect authenticated users to home route\r\n    if (authenticated && !hasRedirected.current) {\r\n      hasRedirected.current = true;\r\n      router.replace('/home');\r\n    } else if (!authenticated) {\r\n      // Reset redirect flag when unauthenticated\r\n      hasRedirected.current = false;\r\n    }\r\n  }, [authenticated, router]);\r\n  \r\n  const bannerSlot = banners.length ? <ShellBanners banners={banners} testID=\"auth-shell-banners\" /> : null;\r\n  const overlaySlot = isLoading ? <LoadingOverlay visible testID=\"auth-loading-overlay\" /> : null;\r\n\r\n  return (\r\n    <AuthFrame\r\n      testID=\"auth-route-layout\"\r\n      banner={bannerSlot}\r\n      overlay={overlaySlot}\r\n      notices={<NoticeSurface testID=\"auth-notice-surface\" />}\r\n      footer={(\r\n        <GlobalFooter\r\n          variant={FOOTER_VARIANTS.AUTH}\r\n          testID=\"auth-footer\"\r\n        />\r\n      )}\r\n    >\r\n      <Slot />\r\n    </AuthFrame>\r\n  );\r\n};\r\n\r\nexport default AuthLayout;\r\n\r\n"],"mappings":"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","ignoreList":[]}