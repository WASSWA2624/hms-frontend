{"version":3,"names":["_getJestObj","mock","networkListener","startListening","jest","fn","subscribe","checkConnectivity","syncManager","startSync","hydration","hydrate","dispatch","actions","setOnline","isOnline","type","payload","logger","info","error","debug","warn","_interopRequireDefault","require","default","_asyncToGenerator2","_init","_offline","_store","_network","_logging","_require","describe","beforeEach","clearAllMocks","mockResolvedValue","queue","it","initOffline","expect","toHaveBeenCalledTimes","networkChangeCallback","mockImplementation","callback","toHaveBeenCalledWith","any","Function","store","mockQueue","id","url","Error","resolves","not","toThrow","mockReturnValue","undefined","mockRejectedValue"],"sources":["init.offline.test.js"],"sourcesContent":["/**\r\n * Offline Initialization Tests\r\n * File: init.offline.test.js\r\n */\r\nimport { initOffline } from '@bootstrap/init.offline';\r\nimport { networkListener, syncManager, hydration } from '@offline';\r\nimport store from '@store';\r\nimport { actions } from '@store/slices/network.slice';\r\nimport { logger } from '@logging';\r\n\r\njest.mock('@offline', () => ({\r\n  networkListener: {\r\n    startListening: jest.fn(),\r\n    subscribe: jest.fn(),\r\n    checkConnectivity: jest.fn(),\r\n  },\r\n  syncManager: {\r\n    startSync: jest.fn(),\r\n  },\r\n  hydration: {\r\n    hydrate: jest.fn(),\r\n  },\r\n}));\r\n\r\njest.mock('@store', () => ({\r\n  dispatch: jest.fn(),\r\n}));\r\n\r\njest.mock('@store/slices/network.slice', () => ({\r\n  actions: {\r\n    setOnline: jest.fn((isOnline) => ({ type: 'network/setOnline', payload: isOnline })),\r\n  },\r\n}));\r\n\r\njest.mock('@logging', () => ({\r\n  logger: {\r\n    info: jest.fn(),\r\n    error: jest.fn(),\r\n    debug: jest.fn(),\r\n    warn: jest.fn(),\r\n  },\r\n}));\r\n\r\ndescribe('Offline Initialization', () => {\r\n  beforeEach(() => {\r\n    jest.clearAllMocks();\r\n    networkListener.checkConnectivity.mockResolvedValue(true);\r\n    hydration.hydrate.mockResolvedValue({ queue: [] });\r\n  });\r\n\r\n  it('initializes network listener and sync manager', async () => {\r\n    await initOffline();\r\n\r\n    expect(networkListener.startListening).toHaveBeenCalledTimes(1);\r\n    expect(syncManager.startSync).toHaveBeenCalledTimes(1);\r\n  });\r\n\r\n  it('subscribes to network changes and updates Redux store', async () => {\r\n    let networkChangeCallback;\r\n    networkListener.subscribe.mockImplementation((callback) => {\r\n      networkChangeCallback = callback;\r\n      return jest.fn(); // unsubscribe function\r\n    });\r\n\r\n    await initOffline();\r\n\r\n    expect(networkListener.subscribe).toHaveBeenCalledTimes(1);\r\n    expect(networkListener.subscribe).toHaveBeenCalledWith(expect.any(Function));\r\n\r\n    // Simulate network status change\r\n    networkChangeCallback(false);\r\n    expect(store.dispatch).toHaveBeenCalledWith(actions.setOnline(false));\r\n\r\n    networkChangeCallback(true);\r\n    expect(store.dispatch).toHaveBeenCalledWith(actions.setOnline(true));\r\n  });\r\n\r\n  it('initializes current network status in Redux store', async () => {\r\n    networkListener.checkConnectivity.mockResolvedValue(true);\r\n\r\n    await initOffline();\r\n\r\n    expect(networkListener.checkConnectivity).toHaveBeenCalledTimes(1);\r\n    expect(store.dispatch).toHaveBeenCalledWith(actions.setOnline(true));\r\n  });\r\n\r\n  it('initializes network status as offline when connectivity check returns false', async () => {\r\n    networkListener.checkConnectivity.mockResolvedValue(false);\r\n\r\n    await initOffline();\r\n\r\n    expect(store.dispatch).toHaveBeenCalledWith(actions.setOnline(false));\r\n  });\r\n\r\n  it('triggers state hydration', async () => {\r\n    const mockQueue = [{ id: '1', url: '/api/test' }];\r\n    hydration.hydrate.mockResolvedValue({ queue: mockQueue });\r\n\r\n    await initOffline();\r\n\r\n    expect(hydration.hydrate).toHaveBeenCalledTimes(1);\r\n  });\r\n\r\n  it('handles errors gracefully without throwing', async () => {\r\n    const error = new Error('Offline initialization error');\r\n    networkListener.startListening.mockImplementation(() => {\r\n      throw error;\r\n    });\r\n\r\n    await expect(initOffline()).resolves.not.toThrow();\r\n\r\n    expect(logger.error).toHaveBeenCalledWith('Offline initialization failed', {\r\n      error: 'Offline initialization error',\r\n    });\r\n  });\r\n\r\n  it('handles network connectivity check errors gracefully', async () => {\r\n    networkListener.startListening.mockReturnValue(undefined);\r\n    networkListener.subscribe.mockReturnValue(jest.fn());\r\n    networkListener.checkConnectivity.mockRejectedValue(new Error('Connectivity check failed'));\r\n\r\n    await expect(initOffline()).resolves.not.toThrow();\r\n\r\n    expect(logger.error).toHaveBeenCalledWith('Offline initialization failed', {\r\n      error: 'Connectivity check failed',\r\n    });\r\n  });\r\n\r\n  it('handles hydration errors gracefully', async () => {\r\n    networkListener.startListening.mockReturnValue(undefined);\r\n    networkListener.subscribe.mockReturnValue(jest.fn());\r\n    networkListener.checkConnectivity.mockResolvedValue(true);\r\n    hydration.hydrate.mockRejectedValue(new Error('Hydration failed'));\r\n\r\n    await expect(initOffline()).resolves.not.toThrow();\r\n\r\n    expect(logger.error).toHaveBeenCalledWith('Offline initialization failed', {\r\n      error: 'Hydration failed',\r\n    });\r\n  });\r\n\r\n  it('logs success when initialization completes', async () => {\r\n    await initOffline();\r\n\r\n    expect(logger.info).toHaveBeenCalledWith('Offline system initialized successfully');\r\n  });\r\n});\r\n\r\n"],"mappings":"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","ignoreList":[]}