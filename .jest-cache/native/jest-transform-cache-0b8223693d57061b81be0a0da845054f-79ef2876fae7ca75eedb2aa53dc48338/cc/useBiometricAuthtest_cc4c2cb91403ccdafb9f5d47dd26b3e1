02f96d50dcfd747d2a585857607dc428
_getJestObj().mock("../../hooks", function () {
  return {
    useI18n: jest.fn()
  };
});
_getJestObj().mock("../../security", function () {
  return {
    authenticateBiometric: jest.fn(),
    isBiometricEnrolled: jest.fn(),
    isBiometricSupported: jest.fn()
  };
});
var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault").default;
var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));
function _getJestObj() {
  var _require3 = require("@jest/globals"),
    jest = _require3.jest;
  _getJestObj = function _getJestObj() {
    return jest;
  };
  return jest;
}
var React = require('react');
var TestRenderer = require('react-test-renderer');
var _require = require("../../hooks"),
  useI18n = _require.useI18n;
var _require2 = require("../../security"),
  authenticateBiometric = _require2.authenticateBiometric,
  isBiometricEnrolled = _require2.isBiometricEnrolled,
  isBiometricSupported = _require2.isBiometricSupported;
var useBiometricAuth = require("../../hooks/useBiometricAuth").default;
var act = TestRenderer.act;
var renderHook = function renderHook(hook) {
  var result = {};
  var renderer;
  var HookHarness = function HookHarness() {
    var hookResult = hook();
    Object.assign(result, hookResult);
    return null;
  };
  act(function () {
    renderer = TestRenderer.create(React.createElement(HookHarness));
  });
  return {
    result: {
      current: result
    },
    unmount: function unmount() {
      act(function () {
        renderer.unmount();
      });
    }
  };
};
describe('useBiometricAuth Hook', function () {
  var t = jest.fn(function (key) {
    return key;
  });
  beforeEach(function () {
    jest.clearAllMocks();
    useI18n.mockReturnValue({
      t: t
    });
  });
  it('exposes availability after checks', (0, _asyncToGenerator2.default)(function* () {
    isBiometricSupported.mockResolvedValue(true);
    isBiometricEnrolled.mockResolvedValue(true);
    var _renderHook = renderHook(function () {
        return useBiometricAuth();
      }),
      result = _renderHook.result;
    yield act((0, _asyncToGenerator2.default)(function* () {
      yield Promise.resolve();
    }));
    expect(result.current.isAvailable).toBe(true);
    expect(result.current.isChecking).toBe(false);
  }));
  it('returns error message on failed authentication', (0, _asyncToGenerator2.default)(function* () {
    isBiometricSupported.mockResolvedValue(true);
    isBiometricEnrolled.mockResolvedValue(true);
    authenticateBiometric.mockResolvedValue({
      success: false
    });
    var _renderHook2 = renderHook(function () {
        return useBiometricAuth();
      }),
      result = _renderHook2.result;
    yield act((0, _asyncToGenerator2.default)(function* () {
      yield Promise.resolve();
    }));
    var authResult;
    yield act((0, _asyncToGenerator2.default)(function* () {
      authResult = yield result.current.authenticate();
    }));
    expect(authResult).toBe(false);
    expect(result.current.errorMessage).toBe('auth.login.biometric.error');
  }));
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfZ2V0SmVzdE9iaiIsIm1vY2siLCJ1c2VJMThuIiwiamVzdCIsImZuIiwiYXV0aGVudGljYXRlQmlvbWV0cmljIiwiaXNCaW9tZXRyaWNFbnJvbGxlZCIsImlzQmlvbWV0cmljU3VwcG9ydGVkIiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsInJlcXVpcmUiLCJkZWZhdWx0IiwiX2FzeW5jVG9HZW5lcmF0b3IyIiwiX3JlcXVpcmUzIiwiUmVhY3QiLCJUZXN0UmVuZGVyZXIiLCJfcmVxdWlyZSIsIl9yZXF1aXJlMiIsInVzZUJpb21ldHJpY0F1dGgiLCJhY3QiLCJyZW5kZXJIb29rIiwiaG9vayIsInJlc3VsdCIsInJlbmRlcmVyIiwiSG9va0hhcm5lc3MiLCJob29rUmVzdWx0IiwiT2JqZWN0IiwiYXNzaWduIiwiY3JlYXRlIiwiY3JlYXRlRWxlbWVudCIsImN1cnJlbnQiLCJ1bm1vdW50IiwiZGVzY3JpYmUiLCJ0Iiwia2V5IiwiYmVmb3JlRWFjaCIsImNsZWFyQWxsTW9ja3MiLCJtb2NrUmV0dXJuVmFsdWUiLCJpdCIsIm1vY2tSZXNvbHZlZFZhbHVlIiwiX3JlbmRlckhvb2siLCJQcm9taXNlIiwicmVzb2x2ZSIsImV4cGVjdCIsImlzQXZhaWxhYmxlIiwidG9CZSIsImlzQ2hlY2tpbmciLCJzdWNjZXNzIiwiX3JlbmRlckhvb2syIiwiYXV0aFJlc3VsdCIsImF1dGhlbnRpY2F0ZSIsImVycm9yTWVzc2FnZSJdLCJzb3VyY2VzIjpbInVzZUJpb21ldHJpY0F1dGgudGVzdC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogdXNlQmlvbWV0cmljQXV0aCBIb29rIFRlc3RzXHJcbiAqIEZpbGU6IHVzZUJpb21ldHJpY0F1dGgudGVzdC5qc1xyXG4gKi9cclxuY29uc3QgUmVhY3QgPSByZXF1aXJlKCdyZWFjdCcpO1xyXG5jb25zdCBUZXN0UmVuZGVyZXIgPSByZXF1aXJlKCdyZWFjdC10ZXN0LXJlbmRlcmVyJyk7XHJcbmNvbnN0IHsgdXNlSTE4biB9ID0gcmVxdWlyZSgnQGhvb2tzJyk7XHJcbmNvbnN0IHtcclxuICBhdXRoZW50aWNhdGVCaW9tZXRyaWMsXHJcbiAgaXNCaW9tZXRyaWNFbnJvbGxlZCxcclxuICBpc0Jpb21ldHJpY1N1cHBvcnRlZCxcclxufSA9IHJlcXVpcmUoJ0BzZWN1cml0eScpO1xyXG5cclxuY29uc3QgdXNlQmlvbWV0cmljQXV0aCA9IHJlcXVpcmUoJ0Bob29rcy91c2VCaW9tZXRyaWNBdXRoJykuZGVmYXVsdDtcclxuXHJcbmplc3QubW9jaygnQGhvb2tzJywgKCkgPT4gKHtcclxuICB1c2VJMThuOiBqZXN0LmZuKCksXHJcbn0pKTtcclxuXHJcbmplc3QubW9jaygnQHNlY3VyaXR5JywgKCkgPT4gKHtcclxuICBhdXRoZW50aWNhdGVCaW9tZXRyaWM6IGplc3QuZm4oKSxcclxuICBpc0Jpb21ldHJpY0Vucm9sbGVkOiBqZXN0LmZuKCksXHJcbiAgaXNCaW9tZXRyaWNTdXBwb3J0ZWQ6IGplc3QuZm4oKSxcclxufSkpO1xyXG5cclxuY29uc3QgYWN0ID0gVGVzdFJlbmRlcmVyLmFjdDtcclxuY29uc3QgcmVuZGVySG9vayA9IChob29rKSA9PiB7XHJcbiAgY29uc3QgcmVzdWx0ID0ge307XHJcbiAgbGV0IHJlbmRlcmVyO1xyXG5cclxuICBjb25zdCBIb29rSGFybmVzcyA9ICgpID0+IHtcclxuICAgIGNvbnN0IGhvb2tSZXN1bHQgPSBob29rKCk7XHJcbiAgICBPYmplY3QuYXNzaWduKHJlc3VsdCwgaG9va1Jlc3VsdCk7XHJcbiAgICByZXR1cm4gbnVsbDtcclxuICB9O1xyXG5cclxuICBhY3QoKCkgPT4ge1xyXG4gICAgcmVuZGVyZXIgPSBUZXN0UmVuZGVyZXIuY3JlYXRlKFJlYWN0LmNyZWF0ZUVsZW1lbnQoSG9va0hhcm5lc3MpKTtcclxuICB9KTtcclxuXHJcbiAgcmV0dXJuIHtcclxuICAgIHJlc3VsdDogeyBjdXJyZW50OiByZXN1bHQgfSxcclxuICAgIHVubW91bnQ6ICgpID0+IHtcclxuICAgICAgYWN0KCgpID0+IHtcclxuICAgICAgICByZW5kZXJlci51bm1vdW50KCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSxcclxuICB9O1xyXG59O1xyXG5cclxuZGVzY3JpYmUoJ3VzZUJpb21ldHJpY0F1dGggSG9vaycsICgpID0+IHtcclxuICBjb25zdCB0ID0gamVzdC5mbigoa2V5KSA9PiBrZXkpO1xyXG5cclxuICBiZWZvcmVFYWNoKCgpID0+IHtcclxuICAgIGplc3QuY2xlYXJBbGxNb2NrcygpO1xyXG4gICAgdXNlSTE4bi5tb2NrUmV0dXJuVmFsdWUoeyB0IH0pO1xyXG4gIH0pO1xyXG5cclxuICBpdCgnZXhwb3NlcyBhdmFpbGFiaWxpdHkgYWZ0ZXIgY2hlY2tzJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgaXNCaW9tZXRyaWNTdXBwb3J0ZWQubW9ja1Jlc29sdmVkVmFsdWUodHJ1ZSk7XHJcbiAgICBpc0Jpb21ldHJpY0Vucm9sbGVkLm1vY2tSZXNvbHZlZFZhbHVlKHRydWUpO1xyXG5cclxuICAgIGNvbnN0IHsgcmVzdWx0IH0gPSByZW5kZXJIb29rKCgpID0+IHVzZUJpb21ldHJpY0F1dGgoKSk7XHJcbiAgICBhd2FpdCBhY3QoYXN5bmMgKCkgPT4ge1xyXG4gICAgICBhd2FpdCBQcm9taXNlLnJlc29sdmUoKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGV4cGVjdChyZXN1bHQuY3VycmVudC5pc0F2YWlsYWJsZSkudG9CZSh0cnVlKTtcclxuICAgIGV4cGVjdChyZXN1bHQuY3VycmVudC5pc0NoZWNraW5nKS50b0JlKGZhbHNlKTtcclxuICB9KTtcclxuXHJcbiAgaXQoJ3JldHVybnMgZXJyb3IgbWVzc2FnZSBvbiBmYWlsZWQgYXV0aGVudGljYXRpb24nLCBhc3luYyAoKSA9PiB7XHJcbiAgICBpc0Jpb21ldHJpY1N1cHBvcnRlZC5tb2NrUmVzb2x2ZWRWYWx1ZSh0cnVlKTtcclxuICAgIGlzQmlvbWV0cmljRW5yb2xsZWQubW9ja1Jlc29sdmVkVmFsdWUodHJ1ZSk7XHJcbiAgICBhdXRoZW50aWNhdGVCaW9tZXRyaWMubW9ja1Jlc29sdmVkVmFsdWUoeyBzdWNjZXNzOiBmYWxzZSB9KTtcclxuXHJcbiAgICBjb25zdCB7IHJlc3VsdCB9ID0gcmVuZGVySG9vaygoKSA9PiB1c2VCaW9tZXRyaWNBdXRoKCkpO1xyXG4gICAgYXdhaXQgYWN0KGFzeW5jICgpID0+IHtcclxuICAgICAgYXdhaXQgUHJvbWlzZS5yZXNvbHZlKCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBsZXQgYXV0aFJlc3VsdDtcclxuICAgIGF3YWl0IGFjdChhc3luYyAoKSA9PiB7XHJcbiAgICAgIGF1dGhSZXN1bHQgPSBhd2FpdCByZXN1bHQuY3VycmVudC5hdXRoZW50aWNhdGUoKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGV4cGVjdChhdXRoUmVzdWx0KS50b0JlKGZhbHNlKTtcclxuICAgIGV4cGVjdChyZXN1bHQuY3VycmVudC5lcnJvck1lc3NhZ2UpLnRvQmUoJ2F1dGgubG9naW4uYmlvbWV0cmljLmVycm9yJyk7XHJcbiAgfSk7XHJcbn0pO1xyXG4iXSwibWFwcGluZ3MiOiJBQWVBQSxXQUFBLEdBQUtDLElBQUksZ0JBQVc7RUFBQSxPQUFPO0lBQ3pCQyxPQUFPLEVBQUVDLElBQUksQ0FBQ0MsRUFBRSxDQUFDO0VBQ25CLENBQUM7QUFBQSxDQUFDLENBQUM7QUFFSEosV0FBQSxHQUFLQyxJQUFJLG1CQUFjO0VBQUEsT0FBTztJQUM1QkkscUJBQXFCLEVBQUVGLElBQUksQ0FBQ0MsRUFBRSxDQUFDLENBQUM7SUFDaENFLG1CQUFtQixFQUFFSCxJQUFJLENBQUNDLEVBQUUsQ0FBQyxDQUFDO0lBQzlCRyxvQkFBb0IsRUFBRUosSUFBSSxDQUFDQyxFQUFFLENBQUM7RUFDaEMsQ0FBQztBQUFBLENBQUMsQ0FBQztBQUFDLElBQUFJLHNCQUFBLEdBQUFDLE9BQUEsaURBQUFDLE9BQUE7QUFBQSxJQUFBQyxrQkFBQSxHQUFBSCxzQkFBQSxDQUFBQyxPQUFBO0FBQUEsU0FBQVQsWUFBQTtFQUFBLElBQUFZLFNBQUEsR0FBQUgsT0FB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