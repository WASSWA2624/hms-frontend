{"version":3,"names":["_i18n","require","describe","mockStorage","getItem","jest","fn","setItem","beforeEach","clearAllMocks","mockResolvedValue","it","i18n","createI18n","storage","expect","toBeDefined","getDeviceLocale","toBe","getCurrentLocale","setLocale","t","tSync","locale","originalIntl","global","Intl","DateTimeFormat","resolvedOptions","_asyncToGenerator2","default","toHaveBeenCalledWith","rejects","toThrow","not","toHaveBeenCalled","translation","supportedLocales","toEqual"],"sources":["index.test.js"],"sourcesContent":["/**\r\n * i18n Tests\r\n * File: index.test.js\r\n * \r\n * NOTE: During Phase 1, only 'en' locale is created and tested.\r\n * All other locales will be created in Phase 12 (Finalization).\r\n */\r\nimport { createI18n } from '@i18n';\r\n\r\ndescribe('i18n System', () => {\r\n  const mockStorage = {\r\n    getItem: jest.fn(),\r\n    setItem: jest.fn(),\r\n  };\r\n\r\n  beforeEach(() => {\r\n    jest.clearAllMocks();\r\n    mockStorage.getItem.mockResolvedValue(null);\r\n    mockStorage.setItem.mockResolvedValue(true);\r\n  });\r\n\r\n  describe('createI18n', () => {\r\n    it('should create i18n instance', () => {\r\n      const i18n = createI18n({ storage: mockStorage });\r\n      expect(i18n).toBeDefined();\r\n      expect(typeof i18n.getDeviceLocale).toBe('function');\r\n      expect(typeof i18n.getCurrentLocale).toBe('function');\r\n      expect(typeof i18n.setLocale).toBe('function');\r\n      expect(typeof i18n.t).toBe('function');\r\n      expect(typeof i18n.tSync).toBe('function');\r\n    });\r\n\r\n    it('should create i18n instance without storage', () => {\r\n      const i18n = createI18n();\r\n      expect(i18n).toBeDefined();\r\n    });\r\n  });\r\n\r\n  describe('getDeviceLocale', () => {\r\n    it('should return default locale (en) when device locale not supported', () => {\r\n      const i18n = createI18n({ storage: mockStorage });\r\n      const locale = i18n.getDeviceLocale();\r\n      // During Phase 1, only 'en' is supported, so it should return 'en'\r\n      expect(locale).toBe('en');\r\n    });\r\n\r\n    it('should return en when device locale is en', () => {\r\n      // Mock Intl to return 'en'\r\n      const originalIntl = global.Intl;\r\n      global.Intl = {\r\n        DateTimeFormat: jest.fn(() => ({\r\n          resolvedOptions: jest.fn(() => ({ locale: 'en' })),\r\n        })),\r\n      };\r\n\r\n      const i18n = createI18n({ storage: mockStorage });\r\n      const locale = i18n.getDeviceLocale();\r\n      expect(locale).toBe('en');\r\n\r\n      global.Intl = originalIntl;\r\n    });\r\n\r\n    it('should fallback to en when device locale is unsupported', () => {\r\n      // Mock Intl to return unsupported locale\r\n      const originalIntl = global.Intl;\r\n      global.Intl = {\r\n        DateTimeFormat: jest.fn(() => ({\r\n          resolvedOptions: jest.fn(() => ({ locale: 'ja' })),\r\n        })),\r\n      };\r\n\r\n      const i18n = createI18n({ storage: mockStorage });\r\n      const locale = i18n.getDeviceLocale();\r\n      expect(locale).toBe('en');\r\n\r\n      global.Intl = originalIntl;\r\n    });\r\n  });\r\n\r\n  describe('getCurrentLocale', () => {\r\n    it('should return saved locale from storage when en', async () => {\r\n      const i18n = createI18n({ storage: mockStorage });\r\n      mockStorage.getItem.mockResolvedValue('en');\r\n      const locale = await i18n.getCurrentLocale();\r\n      expect(locale).toBe('en');\r\n      expect(mockStorage.getItem).toHaveBeenCalledWith('user_locale');\r\n    });\r\n\r\n    it('should return device locale when no saved locale', async () => {\r\n      mockStorage.getItem.mockResolvedValue(null);\r\n      const i18n = createI18n({ storage: mockStorage });\r\n      const locale = await i18n.getCurrentLocale();\r\n      expect(locale).toBe('en');\r\n    });\r\n\r\n    it('should work without storage', async () => {\r\n      const i18n = createI18n();\r\n      const locale = await i18n.getCurrentLocale();\r\n      expect(locale).toBe('en');\r\n    });\r\n  });\r\n\r\n  describe('setLocale', () => {\r\n    it('should save en locale to storage', async () => {\r\n      const i18n = createI18n({ storage: mockStorage });\r\n      await i18n.setLocale('en');\r\n      expect(mockStorage.setItem).toHaveBeenCalledWith('user_locale', 'en');\r\n    });\r\n\r\n    it('should throw error for unsupported locale', async () => {\r\n      const i18n = createI18n({ storage: mockStorage });\r\n      await expect(i18n.setLocale('fr')).rejects.toThrow('Unsupported locale: fr');\r\n      expect(mockStorage.setItem).not.toHaveBeenCalled();\r\n    });\r\n\r\n    it('should work without storage', async () => {\r\n      const i18n = createI18n();\r\n      await i18n.setLocale('en');\r\n      // Should not throw\r\n    });\r\n  });\r\n\r\n  describe('t (translation function)', () => {\r\n    it('should translate key to en locale', async () => {\r\n      const i18n = createI18n({ storage: mockStorage });\r\n      mockStorage.getItem.mockResolvedValue('en');\r\n      const translation = await i18n.t('common.save');\r\n      expect(translation).toBe('Save');\r\n    });\r\n\r\n    it('should replace parameters in translation', async () => {\r\n      const i18n = createI18n({ storage: mockStorage });\r\n      mockStorage.getItem.mockResolvedValue('en');\r\n      // Test with a key that has parameters (if exists in en.json)\r\n      // For now, test that it doesn't crash\r\n      const translation = await i18n.t('common.save', {});\r\n      expect(typeof translation).toBe('string');\r\n    });\r\n\r\n    it('should fallback to key when translation not found', async () => {\r\n      const i18n = createI18n({ storage: mockStorage });\r\n      mockStorage.getItem.mockResolvedValue('en');\r\n      const translation = await i18n.t('nonexistent.key');\r\n      expect(translation).toBe('nonexistent.key');\r\n    });\r\n  });\r\n\r\n  describe('tSync (synchronous translation function)', () => {\r\n    it('should translate key synchronously', () => {\r\n      const i18n = createI18n({ storage: mockStorage });\r\n      const translation = i18n.tSync('common.save');\r\n      expect(translation).toBe('Save');\r\n    });\r\n\r\n    it('should replace parameters in translation', () => {\r\n      const i18n = createI18n({ storage: mockStorage });\r\n      // Test parameter interpolation\r\n      const translation = i18n.tSync('common.save', {});\r\n      expect(typeof translation).toBe('string');\r\n    });\r\n\r\n    it('should fallback to key when translation not found', () => {\r\n      const i18n = createI18n({ storage: mockStorage });\r\n      const translation = i18n.tSync('nonexistent.key');\r\n      expect(translation).toBe('nonexistent.key');\r\n    });\r\n  });\r\n\r\n  describe('supportedLocales', () => {\r\n    it('should export list of supported locales (only en in Phase 1)', () => {\r\n      const i18n = createI18n({ storage: mockStorage });\r\n      expect(i18n.supportedLocales).toEqual(['en']);\r\n    });\r\n  });\r\n});\r\n\r\n"],"mappings":"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","ignoreList":[]}