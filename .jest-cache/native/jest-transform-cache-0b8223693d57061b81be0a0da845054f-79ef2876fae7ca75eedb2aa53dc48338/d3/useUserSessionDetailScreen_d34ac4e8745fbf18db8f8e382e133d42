fee69ed483feb449486f5ff9ca1478e3
var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault").default;
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));
var _react = require("react");
var _expoRouter = require("expo-router");
var _hooks = require("../../../../hooks");
var resolveErrorMessage = function resolveErrorMessage(t, errorCode) {
  if (!errorCode) return null;
  var key = `errors.codes.${errorCode}`;
  var resolved = t(key);
  return resolved === key ? t('errors.codes.UNKNOWN_ERROR') : resolved;
};
var useUserSessionDetailScreen = function useUserSessionDetailScreen() {
  var _useI18n = (0, _hooks.useI18n)(),
    t = _useI18n.t;
  var router = (0, _expoRouter.useRouter)();
  var _useLocalSearchParams = (0, _expoRouter.useLocalSearchParams)(),
    id = _useLocalSearchParams.id;
  var _useNetwork = (0, _hooks.useNetwork)(),
    isOffline = _useNetwork.isOffline;
  var _useUserSession = (0, _hooks.useUserSession)(),
    get = _useUserSession.get,
    revoke = _useUserSession.revoke,
    data = _useUserSession.data,
    isLoading = _useUserSession.isLoading,
    errorCode = _useUserSession.errorCode,
    reset = _useUserSession.reset;
  var session = data && typeof data === 'object' && !Array.isArray(data) ? data : null;
  var errorMessage = (0, _react.useMemo)(function () {
    return resolveErrorMessage(t, errorCode);
  }, [t, errorCode]);
  var fetchDetail = (0, _react.useCallback)(function () {
    if (!id) return;
    reset();
    get(id);
  }, [id, get, reset]);
  (0, _react.useEffect)(function () {
    fetchDetail();
  }, [fetchDetail]);
  var handleRetry = (0, _react.useCallback)(function () {
    fetchDetail();
  }, [fetchDetail]);
  var handleBack = (0, _react.useCallback)(function () {
    router.push('/settings/user-sessions');
  }, [router]);
  var handleRevoke = (0, _react.useCallback)((0, _asyncToGenerator2.default)(function* () {
    if (!id) return;
    try {
      yield revoke(id);
      handleBack();
    } catch (_unused) {}
  }), [id, revoke, handleBack]);
  return {
    id: id,
    session: session,
    isLoading: isLoading,
    hasError: Boolean(errorCode),
    errorMessage: errorMessage,
    isOffline: isOffline,
    onRetry: handleRetry,
    onBack: handleBack,
    onRevoke: handleRevoke
  };
};
var _default = exports.default = useUserSessionDetailScreen;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfcmVhY3QiLCJyZXF1aXJlIiwiX2V4cG9Sb3V0ZXIiLCJfaG9va3MiLCJyZXNvbHZlRXJyb3JNZXNzYWdlIiwidCIsImVycm9yQ29kZSIsImtleSIsInJlc29sdmVkIiwidXNlVXNlclNlc3Npb25EZXRhaWxTY3JlZW4iLCJfdXNlSTE4biIsInVzZUkxOG4iLCJyb3V0ZXIiLCJ1c2VSb3V0ZXIiLCJfdXNlTG9jYWxTZWFyY2hQYXJhbXMiLCJ1c2VMb2NhbFNlYXJjaFBhcmFtcyIsImlkIiwiX3VzZU5ldHdvcmsiLCJ1c2VOZXR3b3JrIiwiaXNPZmZsaW5lIiwiX3VzZVVzZXJTZXNzaW9uIiwidXNlVXNlclNlc3Npb24iLCJnZXQiLCJyZXZva2UiLCJkYXRhIiwiaXNMb2FkaW5nIiwicmVzZXQiLCJzZXNzaW9uIiwiQXJyYXkiLCJpc0FycmF5IiwiZXJyb3JNZXNzYWdlIiwidXNlTWVtbyIsImZldGNoRGV0YWlsIiwidXNlQ2FsbGJhY2siLCJ1c2VFZmZlY3QiLCJoYW5kbGVSZXRyeSIsImhhbmRsZUJhY2siLCJwdXNoIiwiaGFuZGxlUmV2b2tlIiwiX2FzeW5jVG9HZW5lcmF0b3IyIiwiZGVmYXVsdCIsIl91bnVzZWQiLCJoYXNFcnJvciIsIkJvb2xlYW4iLCJvblJldHJ5Iiwib25CYWNrIiwib25SZXZva2UiLCJfZGVmYXVsdCIsImV4cG9ydHMiXSwic291cmNlcyI6WyJ1c2VVc2VyU2Vzc2lvbkRldGFpbFNjcmVlbi5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogdXNlVXNlclNlc3Npb25EZXRhaWxTY3JlZW4gSG9va1xyXG4gKiBTaGFyZWQgbG9naWMgZm9yIFVzZXJTZXNzaW9uRGV0YWlsU2NyZWVuIGFjcm9zcyBwbGF0Zm9ybXMuXHJcbiAqIEZpbGU6IHVzZVVzZXJTZXNzaW9uRGV0YWlsU2NyZWVuLmpzXHJcbiAqL1xyXG5pbXBvcnQgeyB1c2VDYWxsYmFjaywgdXNlRWZmZWN0LCB1c2VNZW1vIH0gZnJvbSAncmVhY3QnO1xyXG5pbXBvcnQgeyB1c2VSb3V0ZXIsIHVzZUxvY2FsU2VhcmNoUGFyYW1zIH0gZnJvbSAnZXhwby1yb3V0ZXInO1xyXG5pbXBvcnQgeyB1c2VJMThuLCB1c2VOZXR3b3JrLCB1c2VVc2VyU2Vzc2lvbiB9IGZyb20gJ0Bob29rcyc7XHJcblxyXG5jb25zdCByZXNvbHZlRXJyb3JNZXNzYWdlID0gKHQsIGVycm9yQ29kZSkgPT4ge1xyXG4gIGlmICghZXJyb3JDb2RlKSByZXR1cm4gbnVsbDtcclxuICBjb25zdCBrZXkgPSBgZXJyb3JzLmNvZGVzLiR7ZXJyb3JDb2RlfWA7XHJcbiAgY29uc3QgcmVzb2x2ZWQgPSB0KGtleSk7XHJcbiAgcmV0dXJuIHJlc29sdmVkID09PSBrZXkgPyB0KCdlcnJvcnMuY29kZXMuVU5LTk9XTl9FUlJPUicpIDogcmVzb2x2ZWQ7XHJcbn07XHJcblxyXG5jb25zdCB1c2VVc2VyU2Vzc2lvbkRldGFpbFNjcmVlbiA9ICgpID0+IHtcclxuICBjb25zdCB7IHQgfSA9IHVzZUkxOG4oKTtcclxuICBjb25zdCByb3V0ZXIgPSB1c2VSb3V0ZXIoKTtcclxuICBjb25zdCB7IGlkIH0gPSB1c2VMb2NhbFNlYXJjaFBhcmFtcygpO1xyXG4gIGNvbnN0IHsgaXNPZmZsaW5lIH0gPSB1c2VOZXR3b3JrKCk7XHJcbiAgY29uc3QgeyBnZXQsIHJldm9rZSwgZGF0YSwgaXNMb2FkaW5nLCBlcnJvckNvZGUsIHJlc2V0IH0gPSB1c2VVc2VyU2Vzc2lvbigpO1xyXG5cclxuICBjb25zdCBzZXNzaW9uID0gZGF0YSAmJiB0eXBlb2YgZGF0YSA9PT0gJ29iamVjdCcgJiYgIUFycmF5LmlzQXJyYXkoZGF0YSkgPyBkYXRhIDogbnVsbDtcclxuICBjb25zdCBlcnJvck1lc3NhZ2UgPSB1c2VNZW1vKFxyXG4gICAgKCkgPT4gcmVzb2x2ZUVycm9yTWVzc2FnZSh0LCBlcnJvckNvZGUpLFxyXG4gICAgW3QsIGVycm9yQ29kZV1cclxuICApO1xyXG5cclxuICBjb25zdCBmZXRjaERldGFpbCA9IHVzZUNhbGxiYWNrKCgpID0+IHtcclxuICAgIGlmICghaWQpIHJldHVybjtcclxuICAgIHJlc2V0KCk7XHJcbiAgICBnZXQoaWQpO1xyXG4gIH0sIFtpZCwgZ2V0LCByZXNldF0pO1xyXG5cclxuICB1c2VFZmZlY3QoKCkgPT4ge1xyXG4gICAgZmV0Y2hEZXRhaWwoKTtcclxuICB9LCBbZmV0Y2hEZXRhaWxdKTtcclxuXHJcbiAgY29uc3QgaGFuZGxlUmV0cnkgPSB1c2VDYWxsYmFjaygoKSA9PiB7XHJcbiAgICBmZXRjaERldGFpbCgpO1xyXG4gIH0sIFtmZXRjaERldGFpbF0pO1xyXG5cclxuICBjb25zdCBoYW5kbGVCYWNrID0gdXNlQ2FsbGJhY2soKCkgPT4ge1xyXG4gICAgcm91dGVyLnB1c2goJy9zZXR0aW5ncy91c2VyLXNlc3Npb25zJyk7XHJcbiAgfSwgW3JvdXRlcl0pO1xyXG5cclxuICBjb25zdCBoYW5kbGVSZXZva2UgPSB1c2VDYWxsYmFjayhhc3luYyAoKSA9PiB7XHJcbiAgICBpZiAoIWlkKSByZXR1cm47XHJcbiAgICB0cnkge1xyXG4gICAgICBhd2FpdCByZXZva2UoaWQpO1xyXG4gICAgICBoYW5kbGVCYWNrKCk7XHJcbiAgICB9IGNhdGNoIHtcclxuICAgICAgLyogZXJyb3IgaGFuZGxlZCBieSBob29rICovXHJcbiAgICB9XHJcbiAgfSwgW2lkLCByZXZva2UsIGhhbmRsZUJhY2tdKTtcclxuXHJcbiAgcmV0dXJuIHtcclxuICAgIGlkLFxyXG4gICAgc2Vzc2lvbixcclxuICAgIGlzTG9hZGluZyxcclxuICAgIGhhc0Vycm9yOiBCb29sZWFuKGVycm9yQ29kZSksXHJcbiAgICBlcnJvck1lc3NhZ2UsXHJcbiAgICBpc09mZmxpbmUsXHJcbiAgICBvblJldHJ5OiBoYW5kbGVSZXRyeSxcclxuICAgIG9uQmFjazogaGFuZGxlQmFjayxcclxuICAgIG9uUmV2b2tlOiBoYW5kbGVSZXZva2UsXHJcbiAgfTtcclxufTtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IHVzZVVzZXJTZXNzaW9uRGV0YWlsU2Ny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