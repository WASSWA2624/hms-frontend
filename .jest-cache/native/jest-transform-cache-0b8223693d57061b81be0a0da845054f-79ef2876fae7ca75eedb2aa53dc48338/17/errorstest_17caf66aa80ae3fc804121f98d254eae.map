{"version":3,"names":["_errors","require","describe","beforeEach","jest","spyOn","console","mockImplementation","afterEach","error","mockRestore","warn","info","debug","it","result","normalizeError","expect","toMatchObject","code","message","severity","safeMessage","toBe","networkError","name","status","statusCode","context","userId","handleError","toHaveBeenCalled","toHaveProperty","toBeDefined","FallbackUI","onRetry","fn","not","toThrow","ErrorBoundary","getDerivedStateFromError","Error","state","toEqual","hasError"],"sources":["errors.test.js"],"sourcesContent":["/**\r\n * Error Handling Tests\r\n * File: errors.test.js\r\n */\r\nimport { normalizeError, handleError, ErrorBoundary, FallbackUI } from '@errors';\r\n\r\ndescribe('Error Handling Layer', () => {\r\n  beforeEach(() => {\r\n    jest.spyOn(console, 'error').mockImplementation(() => {});\r\n    jest.spyOn(console, 'warn').mockImplementation(() => {});\r\n    jest.spyOn(console, 'info').mockImplementation(() => {});\r\n    jest.spyOn(console, 'debug').mockImplementation(() => {});\r\n  });\r\n\r\n  afterEach(() => {\r\n    console.error.mockRestore();\r\n    console.warn.mockRestore();\r\n    console.info.mockRestore();\r\n    console.debug.mockRestore();\r\n  });\r\n\r\n  describe('normalizeError', () => {\r\n    it('should handle null/undefined errors', () => {\r\n      const result = normalizeError(null);\r\n      expect(result).toMatchObject({\r\n        code: 'UNKNOWN_ERROR',\r\n        message: 'An unknown error occurred',\r\n        severity: 'error',\r\n      });\r\n      expect(result.safeMessage).toBe('An unknown error occurred');\r\n    });\r\n\r\n    it('should normalize network errors', () => {\r\n      const networkError = {\r\n        name: 'NetworkError',\r\n        message: 'Network request failed',\r\n      };\r\n      const result = normalizeError(networkError);\r\n      expect(result).toMatchObject({\r\n        code: 'NETWORK_ERROR',\r\n        message: 'Network connection failed',\r\n        severity: 'warning',\r\n      });\r\n      expect(result.safeMessage).toBe('Network connection failed');\r\n    });\r\n\r\n    it('should normalize network errors by message', () => {\r\n      const networkError = {\r\n        message: 'network connection timeout',\r\n      };\r\n      const result = normalizeError(networkError);\r\n      expect(result.code).toBe('NETWORK_ERROR');\r\n      expect(result.severity).toBe('warning');\r\n    });\r\n\r\n    it('should normalize 401 unauthorized errors', () => {\r\n      const error = { status: 401, message: 'Unauthorized' };\r\n      const result = normalizeError(error);\r\n      expect(result).toMatchObject({\r\n        code: 'UNAUTHORIZED',\r\n        message: 'Authentication required',\r\n        severity: 'error',\r\n      });\r\n      expect(result.safeMessage).toBe('Authentication required');\r\n    });\r\n\r\n    it('should normalize 403 forbidden errors', () => {\r\n      const error = { status: 403, message: 'Forbidden' };\r\n      const result = normalizeError(error);\r\n      expect(result).toMatchObject({\r\n        code: 'FORBIDDEN',\r\n        message: 'Access denied',\r\n        severity: 'error',\r\n      });\r\n      expect(result.safeMessage).toBe('Access denied');\r\n    });\r\n\r\n    it('should normalize 500+ server errors', () => {\r\n      const error = { status: 500, message: 'Internal Server Error' };\r\n      const result = normalizeError(error);\r\n      expect(result).toMatchObject({\r\n        code: 'SERVER_ERROR',\r\n        message: 'Server error occurred',\r\n        severity: 'error',\r\n      });\r\n      expect(result.safeMessage).toBe('Server error occurred');\r\n    });\r\n\r\n    it('should handle statusCode instead of status', () => {\r\n      const error = { statusCode: 401 };\r\n      const result = normalizeError(error);\r\n      expect(result.code).toBe('UNAUTHORIZED');\r\n    });\r\n\r\n    it('should use error code and message when available', () => {\r\n      const error = {\r\n        code: 'CUSTOM_ERROR',\r\n        message: 'Custom error message',\r\n        severity: 'warning',\r\n      };\r\n      const result = normalizeError(error);\r\n      expect(result).toMatchObject({\r\n        code: 'CUSTOM_ERROR',\r\n        message: 'Custom error message',\r\n        severity: 'warning',\r\n      });\r\n      expect(result.safeMessage).toBe('An unknown error occurred');\r\n    });\r\n\r\n    it('should default to UNKNOWN_ERROR for unrecognized errors', () => {\r\n      const error = { message: 'Some error' };\r\n      const result = normalizeError(error);\r\n      expect(result.code).toBe('UNKNOWN_ERROR');\r\n      expect(result.message).toBe('Some error');\r\n      expect(result.severity).toBe('error');\r\n    });\r\n  });\r\n\r\n  describe('handleError', () => {\r\n    it('should normalize and log errors', () => {\r\n      const error = { message: 'Test error', code: 'TEST_ERROR' };\r\n      const context = { userId: '123' };\r\n      \r\n      const result = handleError(error, context);\r\n      \r\n      expect(console.error).toHaveBeenCalled();\r\n      expect(result).toHaveProperty('code');\r\n      expect(result).toHaveProperty('message');\r\n      expect(result).toHaveProperty('severity');\r\n    });\r\n\r\n    it('should handle errors without context', () => {\r\n      const error = { message: 'Test error' };\r\n      \r\n      const result = handleError(error);\r\n      \r\n      expect(console.error).toHaveBeenCalled();\r\n      expect(result).toBeDefined();\r\n    });\r\n\r\n    it('should handle null errors', () => {\r\n      const result = handleError(null);\r\n      \r\n      expect(console.error).toHaveBeenCalled();\r\n      expect(result.code).toBe('UNKNOWN_ERROR');\r\n    });\r\n  });\r\n\r\n  describe('FallbackUI', () => {\r\n    it('should be a React component', () => {\r\n      expect(FallbackUI).toBeDefined();\r\n      expect(typeof FallbackUI).toBe('function');\r\n    });\r\n\r\n    it('should accept error and onRetry props', () => {\r\n      // Component structure test - verify it can be instantiated\r\n      const error = { message: 'Test error' };\r\n      const onRetry = jest.fn();\r\n      \r\n      // Just verify the component exists and accepts props\r\n      expect(() => {\r\n        // In a real test environment, we would render this\r\n        // For now, just verify it's importable and has the right structure\r\n        expect(FallbackUI).toBeDefined();\r\n      }).not.toThrow();\r\n    });\r\n  });\r\n\r\n  describe('ErrorBoundary', () => {\r\n    it('should be a React component class', () => {\r\n      expect(ErrorBoundary).toBeDefined();\r\n      expect(typeof ErrorBoundary).toBe('function');\r\n    });\r\n\r\n    it('should have getDerivedStateFromError static method', () => {\r\n      expect(ErrorBoundary.getDerivedStateFromError).toBeDefined();\r\n      expect(typeof ErrorBoundary.getDerivedStateFromError).toBe('function');\r\n    });\r\n\r\n    it('should handle errors via getDerivedStateFromError', () => {\r\n      const error = new Error('Test error');\r\n      const state = ErrorBoundary.getDerivedStateFromError(error);\r\n      \r\n      expect(state).toEqual({\r\n        hasError: true,\r\n        error: error,\r\n      });\r\n    });\r\n  });\r\n});\r\n\r\n"],"mappings":"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","ignoreList":[]}