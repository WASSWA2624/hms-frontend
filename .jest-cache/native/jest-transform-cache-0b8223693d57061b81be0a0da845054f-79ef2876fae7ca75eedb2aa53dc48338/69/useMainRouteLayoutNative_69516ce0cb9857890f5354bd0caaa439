e18ff83d10eca036240bed24ececca59
var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault").default;
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
var _toConsumableArray2 = _interopRequireDefault(require("@babel/runtime/helpers/toConsumableArray"));
var _react = require("react");
var _expoRouter = require("expo-router");
var _hooks = require("../../../../hooks");
var _sideMenu = require("../../../../config/sideMenu");
var _guards = require("../../../../navigation/guards");
var _config = require("../../../../config");
var _types = require("../../../components/navigation/GlobalHeader/types");
var _components = require("../../../components");
var _jsxRuntime = require("react/jsx-runtime");
var useMainRouteLayoutNative = function useMainRouteLayoutNative() {
  (0, _guards.useAuthGuard)();
  var _useI18n = (0, _hooks.useI18n)(),
    t = _useI18n.t;
  var router = (0, _expoRouter.useRouter)();
  var _useAuth = (0, _hooks.useAuth)(),
    isAuthenticated = _useAuth.isAuthenticated,
    logout = _useAuth.logout,
    roles = _useAuth.roles;
  var _useUiState = (0, _hooks.useUiState)(),
    isLoading = _useUiState.isLoading;
  var _useNavigationVisibil = (0, _hooks.useNavigationVisibility)(),
    isItemVisible = _useNavigationVisibil.isItemVisible;
  var mainItems = (0, _react.useMemo)(function () {
    return _sideMenu.MAIN_NAV_ITEMS.map(function (it) {
      return Object.assign({}, it, {
        href: it.path,
        label: t(`navigation.items.main.${it.id}`),
        icon: (0, _sideMenu.getMenuIconGlyph)(it.icon)
      });
    });
  }, [t]);
  var canAccessRegister = (0, _react.useMemo)(function () {
    var _AUTH$REGISTER_ROLES;
    return isAuthenticated && ((_AUTH$REGISTER_ROLES = _config.AUTH.REGISTER_ROLES) == null ? void 0 : _AUTH$REGISTER_ROLES.length) > 0 && _config.AUTH.REGISTER_ROLES.some(function (role) {
      return roles.includes(role);
    });
  }, [isAuthenticated, roles]);
  var headerActions = (0, _react.useMemo)(function () {
    return isAuthenticated ? [].concat((0, _toConsumableArray2.default)(canAccessRegister ? [{
      id: 'register',
      label: t('auth.register.button'),
      accessibilityLabel: t('auth.register.button'),
      onPress: function onPress() {
        return router.push('/register');
      },
      variant: _types.ACTION_VARIANTS.GHOST
    }] : []), [{
      id: 'logout',
      label: t('navigation.header.logout'),
      accessibilityLabel: t('navigation.header.logout'),
      onPress: logout,
      variant: _types.ACTION_VARIANTS.GHOST
    }]) : [{
      id: 'login',
      label: t('auth.login.button'),
      accessibilityLabel: t('auth.login.button'),
      onPress: function onPress() {
        return router.push('/login');
      },
      variant: _types.ACTION_VARIANTS.PRIMARY
    }];
  }, [isAuthenticated, canAccessRegister, logout, router, t]);
  var overlaySlot = (0, _react.useMemo)(function () {
    return isLoading ? (0, _jsxRuntime.jsx)(_components.LoadingOverlay, {
      visible: true,
      testID: "main-loading-overlay"
    }) : null;
  }, [isLoading]);
  return {
    headerActions: headerActions,
    overlaySlot: overlaySlot,
    mainItems: mainItems,
    isItemVisible: isItemVisible
  };
};
var _default = exports.default = useMainRouteLayoutNative;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfcmVhY3QiLCJyZXF1aXJlIiwiX2V4cG9Sb3V0ZXIiLCJfaG9va3MiLCJfc2lkZU1lbnUiLCJfZ3VhcmRzIiwiX2NvbmZpZyIsIl90eXBlcyIsIl9jb21wb25lbnRzIiwiX2pzeFJ1bnRpbWUiLCJ1c2VNYWluUm91dGVMYXlvdXROYXRpdmUiLCJ1c2VBdXRoR3VhcmQiLCJfdXNlSTE4biIsInVzZUkxOG4iLCJ0Iiwicm91dGVyIiwidXNlUm91dGVyIiwiX3VzZUF1dGgiLCJ1c2VBdXRoIiwiaXNBdXRoZW50aWNhdGVkIiwibG9nb3V0Iiwicm9sZXMiLCJfdXNlVWlTdGF0ZSIsInVzZVVpU3RhdGUiLCJpc0xvYWRpbmciLCJfdXNlTmF2aWdhdGlvblZpc2liaWwiLCJ1c2VOYXZpZ2F0aW9uVmlzaWJpbGl0eSIsImlzSXRlbVZpc2libGUiLCJtYWluSXRlbXMiLCJ1c2VNZW1vIiwiTUFJTl9OQVZfSVRFTVMiLCJtYXAiLCJpdCIsIk9iamVjdCIsImFzc2lnbiIsImhyZWYiLCJwYXRoIiwibGFiZWwiLCJpZCIsImljb24iLCJnZXRNZW51SWNvbkdseXBoIiwiY2FuQWNjZXNzUmVnaXN0ZXIiLCJfQVVUSCRSRUdJU1RFUl9ST0xFUyIsIkFVVEgiLCJSRUdJU1RFUl9ST0xFUyIsImxlbmd0aCIsInNvbWUiLCJyb2xlIiwiaW5jbHVkZXMiLCJoZWFkZXJBY3Rpb25zIiwiY29uY2F0IiwiX3RvQ29uc3VtYWJsZUFycmF5MiIsImRlZmF1bHQiLCJhY2Nlc3NpYmlsaXR5TGFiZWwiLCJvblByZXNzIiwicHVzaCIsInZhcmlhbnQiLCJBQ1RJT05fVkFSSUFOVFMiLCJHSE9TVCIsIlBSSU1BUlkiLCJvdmVybGF5U2xvdCIsImpzeCIsIkxvYWRpbmdPdmVybGF5IiwidmlzaWJsZSIsInRlc3RJRCIsIl9kZWZhdWx0IiwiZXhwb3J0cyJdLCJzb3VyY2VzIjpbInVzZU1haW5Sb3V0ZUxheW91dE5hdGl2ZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogdXNlTWFpblJvdXRlTGF5b3V0TmF0aXZlIEhvb2tcclxuICogU2hhcmVkIGxvZ2ljIGZvciBNYWluUm91dGVMYXlvdXQgQW5kcm9pZCBhbmQgaU9TIChoZWFkZXIgYWN0aW9ucywgb3ZlcmxheSwgbmF2IGl0ZW1zKVxyXG4gKiBGaWxlOiB1c2VNYWluUm91dGVMYXlvdXROYXRpdmUuanNcclxuICovXHJcblxyXG5pbXBvcnQgeyB1c2VNZW1vIH0gZnJvbSAncmVhY3QnO1xyXG5pbXBvcnQgeyB1c2VSb3V0ZXIgfSBmcm9tICdleHBvLXJvdXRlcic7XHJcbmltcG9ydCB7IHVzZUF1dGgsIHVzZUkxOG4sIHVzZU5hdmlnYXRpb25WaXNpYmlsaXR5LCB1c2VVaVN0YXRlIH0gZnJvbSAnQGhvb2tzJztcclxuaW1wb3J0IHsgTUFJTl9OQVZfSVRFTVMsIGdldE1lbnVJY29uR2x5cGggfSBmcm9tICdAY29uZmlnL3NpZGVNZW51JztcclxuaW1wb3J0IHsgdXNlQXV0aEd1YXJkIH0gZnJvbSAnQG5hdmlnYXRpb24vZ3VhcmRzJztcclxuaW1wb3J0IHsgQVVUSCB9IGZyb20gJ0Bjb25maWcnO1xyXG5pbXBvcnQgeyBBQ1RJT05fVkFSSUFOVFMgfSBmcm9tICdAcGxhdGZvcm0vY29tcG9uZW50cy9uYXZpZ2F0aW9uL0dsb2JhbEhlYWRlci90eXBlcyc7XHJcbmltcG9ydCB7IExvYWRpbmdPdmVybGF5IH0gZnJvbSAnQHBsYXRmb3JtL2NvbXBvbmVudHMnO1xyXG5cclxuLyoqXHJcbiAqIFNoYXJlZCBob29rIGZvciBNYWluUm91dGVMYXlvdXQgbmF0aXZlIChBbmRyb2lkL2lPUylcclxuICogQHJldHVybnMge09iamVjdH0gaGVhZGVyQWN0aW9ucywgb3ZlcmxheVNsb3QsIG1haW5JdGVtcywgaXNJdGVtVmlzaWJsZVxyXG4gKi9cclxuY29uc3QgdXNlTWFpblJvdXRlTGF5b3V0TmF0aXZlID0gKCkgPT4ge1xyXG4gIHVzZUF1dGhHdWFyZCgpO1xyXG4gIGNvbnN0IHsgdCB9ID0gdXNlSTE4bigpO1xyXG4gIGNvbnN0IHJvdXRlciA9IHVzZVJvdXRlcigpO1xyXG4gIGNvbnN0IHsgaXNBdXRoZW50aWNhdGVkLCBsb2dvdXQsIHJvbGVzIH0gPSB1c2VBdXRoKCk7XHJcbiAgY29uc3QgeyBpc0xvYWRpbmcgfSA9IHVzZVVpU3RhdGUoKTtcclxuICBjb25zdCB7IGlzSXRlbVZpc2libGUgfSA9IHVzZU5hdmlnYXRpb25WaXNpYmlsaXR5KCk7XHJcbiAgY29uc3QgbWFpbkl0ZW1zID0gdXNlTWVtbyhcclxuICAgICgpID0+XHJcbiAgICAgIE1BSU5fTkFWX0lURU1TLm1hcCgoaXQpID0+ICh7XHJcbiAgICAgICAgLi4uaXQsXHJcbiAgICAgICAgaHJlZjogaXQucGF0aCxcclxuICAgICAgICBsYWJlbDogdChgbmF2aWdhdGlvbi5pdGVtcy5tYWluLiR7aXQuaWR9YCksXHJcbiAgICAgICAgaWNvbjogZ2V0TWVudUljb25HbHlwaChpdC5pY29uKSxcclxuICAgICAgfSkpLFxyXG4gICAgW3RdXHJcbiAgKTtcclxuXHJcbiAgY29uc3QgY2FuQWNjZXNzUmVnaXN0ZXIgPSB1c2VNZW1vKFxyXG4gICAgKCkgPT5cclxuICAgICAgaXNBdXRoZW50aWNhdGVkICYmXHJcbiAgICAgIEFVVEguUkVHSVNURVJfUk9MRVM/Lmxlbmd0aCA+IDAgJiZcclxuICAgICAgQVVUSC5SRUdJU1RFUl9ST0xFUy5zb21lKChyb2xlKSA9PiByb2xlcy5pbmNsdWRlcyhyb2xlKSksXHJcbiAgICBbaXNBdXRoZW50aWNhdGVkLCByb2xlc11cclxuICApO1xyXG5cclxuICBjb25zdCBoZWFkZXJBY3Rpb25zID0gdXNlTWVtbyhcclxuICAgICgpID0+XHJcbiAgICAgIGlzQXV0aGVudGljYXRlZFxyXG4gICAgICAgID8gW1xyXG4gICAgICAgICAgICAuLi4oY2FuQWNjZXNzUmVnaXN0ZXJcclxuICAgICAgICAgICAgICA/IFtcclxuICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIGlkOiAncmVnaXN0ZXInLFxyXG4gICAgICAgICAgICAgICAgICAgIGxhYmVsOiB0KCdhdXRoLnJlZ2lzdGVyLmJ1dHRvbicpLFxyXG4gICAgICAgICAgICAgICAgICAgIGFjY2Vzc2liaWxpdHlMYWJlbDogdCgnYXV0aC5yZWdpc3Rlci5idXR0b24nKSxcclxuICAgICAgICAgICAgICAgICAgICBvblByZXNzOiAoKSA9PiByb3V0ZXIucHVzaCgnL3JlZ2lzdGVyJyksXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyaWFudDogQUNUSU9OX1ZBUklBTlRTLkdIT1NULFxyXG4gICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgXVxyXG4gICAgICAgICAgICAgIDogW10pLFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgaWQ6ICdsb2dvdXQnLFxyXG4gICAgICAgICAgICAgIGxhYmVsOiB0KCduYXZpZ2F0aW9uLmhlYWRlci5sb2dvdXQnKSxcclxuICAgICAgICAgICAgICBhY2Nlc3NpYmlsaXR5TGFiZWw6IHQoJ25hdmlnYXRpb24uaGVhZGVyLmxvZ291dCcpLFxyXG4gICAgICAgICAgICAgIG9uUHJlc3M6IGxvZ291dCxcclxuICAgICAgICAgICAgICB2YXJpYW50OiBBQ1RJT05fVkFSSUFOVFMuR0hPU1QsXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICBdXHJcbiAgICAgICAgOiBbXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICBpZDogJ2xvZ2luJyxcclxuICAgICAgICAgICAgICBsYWJlbDogdCgnYXV0aC5sb2dpbi5idXR0b24nKSxcclxuICAgICAgICAgICAgICBhY2Nlc3NpYmlsaXR5TGFiZWw6IHQoJ2F1dGgubG9naW4uYnV0dG9uJyksXHJcbiAgICAgICAgICAgICAgb25QcmVzczogKCkgPT4gcm91dGVyLnB1c2goJy9sb2dpbicpLFxyXG4gICAgICAgICAgICAgIHZhcmlhbnQ6IEFDVElPTl9WQVJJQU5UUy5QUklNQVJZLFxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgXSxcclxuICAgIFtpc0F1dGhlbnRpY2F0ZWQsIGNhbkFjY2Vzc1JlZ2lzdGVyLCBsb2dvdXQsIHJvdXRlciwgdF1cclxuICApO1xyXG5cclxuICBjb25zdCBvdmVybGF5U2xvdCA9IHVzZU1lbW8oXHJcbiAgICAoKSA9PlxyXG4gICAgICBpc0xvYWRpbmcgPyAoXHJcbiAgICAgICAgPExvYWRpbmdPdmVybGF5IHZpc2libGUgdGVzdElEPVwibWFpbi1sb2FkaW5nLW92ZXJsYXlcIiAvPlxyXG4gICAgICApIDogbnVsbCxcclxuICAgIFtpc0xvYWRpbmddXHJcbiAgKTtcclxuXHJcbiAgcmV0dXJuIHsgaGVhZGVyQWN0aW9ucywgb3ZlcmxheVNsb3QsIG1haW5JdGVtcywgaXNJdGVtVmlzaWJsZSB9O1xyXG59O1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgdXNlTWFpblJvdXRlTGF5b3V0TmF0aXZlO1xyXG4iXSwibWFwcGluZ3MiOiI7Ozs7OztBQU1BLElBQUFBLE1BQUEsR0FBQUMsT0FBQTtBQUNBLElBQUFDLFdBQUEsR0FBQUQsT0FBQTtBQUNBLElBQUFFLE1BQUEsR0FBQUYsT0FBQTtBQUNBLElBQUFHLFNBQUEsR0FBQUgsT0FBQTtBQUNBLElBQUFJLE9BQUEsR0FBQUosT0FBQTtBQUNBLElBQUFLLE9BQUEsR0FBQUwsT0FBQTtBQUNBLElBQUFNLE1BQUEsR0FBQU4sT0FBQTtBQUNBLElBQUFPLFdBQUEsR0FBQVAsT0FBQTtBQUFzRCxJQUFBUSxXQUFBLEdBQUFSLE9BQUE7QUFNdEQsSUFBTVMsd0JBQXdCLEdBQUcsU0FBM0JBLHdCQUF3QkEsQ0FBQSxFQUFTO0VBQ3JDLElBQUFDLG9CQUFZLEVBQUMsQ0FBQztFQUNkLElBQUFDLFFBQUEsR0FBYyxJQUFBQyxjQUFPLEVBQUMsQ0FBQztJQUFmQyxDQUFDLEdBQUFGLFFBQUEsQ0FBREUsQ0FBQztFQUNULElBQU1DLE1BQU0sR0FBRyxJQUFBQyxxQkFBUyxFQUFDLENBQUM7RUFDMUIsSUFBQUMsUUFBQSxHQUEyQyxJQUFBQyxjQUFPLEVBQUMsQ0FBQztJQUE1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