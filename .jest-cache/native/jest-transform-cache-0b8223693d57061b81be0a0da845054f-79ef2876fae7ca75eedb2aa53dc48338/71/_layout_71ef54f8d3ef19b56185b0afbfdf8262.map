{"version":3,"names":["_react","_interopRequireWildcard","require","_reactRedux","_react2","_expoRouter","_errors","_i18n","_bootstrap","_logging","_store","_interopRequireDefault","_RootLayoutStyles","_ThemeProviderWrapper","_reactNative","_jsxRuntime","RootLayout","_useState","useState","_useState2","_slicedToArray2","default","isBootstrapReady","setIsBootstrapReady","_useState3","_useState4","bootstrapError","setBootstrapError","useEffect","initializeApp","_ref","_asyncToGenerator2","bootstrapApp","error","logger","message","stack","apply","arguments","jsx","ErrorBoundary","children","StyledLoadingContainer","StyledActivityIndicator","size","Provider","store","PersistGate","loading","persistor","I18nProvider","View","style","flex","height","Slot","_default","exports"],"sources":["_layout.jsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { Provider } from 'react-redux';\r\nimport { PersistGate } from 'redux-persist/integration/react';\r\nimport { Slot } from 'expo-router';\r\nimport { ErrorBoundary } from '@errors';\r\nimport { I18nProvider } from '@i18n';\r\nimport { bootstrapApp } from '@bootstrap';\r\nimport { logger } from '@logging';\r\nimport store from '@store';\r\nimport { StyledLoadingContainer, StyledActivityIndicator } from '@platform/layouts/common/RootLayoutStyles';\r\nimport ThemeProviderWrapper from '@platform/layouts/common/ThemeProviderWrapper';\r\nimport { View } from 'react-native';\r\n\r\n/**\r\n * Root Layout Component\r\n * \r\n * This is the root layout for Expo App Router.\r\n * All providers will be added here in subsequent steps.\r\n * \r\n * Per app-router.mdc: Root layout responsibilities (providers/startup wiring)\r\n * are defined in bootstrap-config.mdc.\r\n * \r\n * Per bootstrap-config.mdc: ErrorBoundary is mounted only in root layout.\r\n * Per errors-logging.mdc: ErrorBoundary catches render/runtime errors and displays fallback UI.\r\n * \r\n * Per bootstrap-config.mdc: Redux Provider mounted only in root layout.\r\n * Per state-management.mdc: Store access patterns via Provider.\r\n * \r\n * Per bootstrap-config.mdc: ThemeProvider mounted only in root layout.\r\n * Per theme-design.mdc: Theme consumption via styled-components.\r\n * \r\n * Per bootstrap-config.mdc: Localization Provider mounted only in root layout.\r\n * Per i18n.mdc: i18n provider/registry, locale handling.\r\n * \r\n * Per bootstrap-config.mdc: Bootstrap runs in correct order (security → store → theme → offline)\r\n * before rendering providers. Bootstrap errors are handled gracefully per bootstrap-config.mdc.\r\n * \r\n * Note: Expo Router root layout uses <Slot /> to render child routes, not {children}\r\n */\r\nconst RootLayout = () => {\r\n  const [isBootstrapReady, setIsBootstrapReady] = useState(false);\r\n  const [bootstrapError, setBootstrapError] = useState(null);\r\n\r\n  useEffect(() => {\r\n    /**\r\n     * Initialize app systems in correct order per bootstrap-config.mdc:\r\n     * 1. Security (protects everything)\r\n     * 2. Store (required by most layers)\r\n     * 3. Theme (required by UI)\r\n     * 4. Offline (depends on store and services)\r\n     */\r\n    const initializeApp = async () => {\r\n      try {\r\n        await bootstrapApp();\r\n        setIsBootstrapReady(true);\r\n      } catch (error) {\r\n        // Per bootstrap-config.mdc: Fatal errors must block rendering\r\n        // Non-fatal errors must be logged\r\n        // Per errors-logging.mdc: Log errors via logger\r\n        logger.error('Bootstrap initialization failed', {\r\n          error: error.message,\r\n          stack: error.stack,\r\n        });\r\n        \r\n        // Store error to block rendering (fatal error)\r\n        setBootstrapError(error);\r\n        \r\n        // Note: ErrorBoundary will catch if this causes a render error\r\n        // For now, we'll log and set error state to prevent rendering\r\n      }\r\n    };\r\n\r\n    initializeApp();\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, []);\r\n\r\n  // Per bootstrap-config.mdc: Fatal errors must block rendering\r\n  if (bootstrapError) {\r\n    // ErrorBoundary will handle this, but we prevent rendering providers\r\n    // until bootstrap succeeds\r\n    return (\r\n      <ErrorBoundary>\r\n        <StyledLoadingContainer>\r\n          <StyledActivityIndicator size=\"large\" />\r\n        </StyledLoadingContainer>\r\n      </ErrorBoundary>\r\n    );\r\n  }\r\n\r\n  // Per bootstrap-config.mdc: Add loading state while bootstrap completes\r\n  if (!isBootstrapReady) {\r\n    return (\r\n      <ErrorBoundary>\r\n        <StyledLoadingContainer>\r\n          <StyledActivityIndicator size=\"large\" />\r\n        </StyledLoadingContainer>\r\n      </ErrorBoundary>\r\n    );\r\n  }\r\n\r\n  // Bootstrap completed successfully, render providers\r\n  return (\r\n    <ErrorBoundary>\r\n      <Provider store={store}>\r\n        <PersistGate\r\n          loading={\r\n            <StyledLoadingContainer>\r\n              <StyledActivityIndicator size=\"large\" />\r\n            </StyledLoadingContainer>\r\n          }\r\n          persistor={store.persistor}\r\n        >\r\n          <ThemeProviderWrapper>\r\n            <I18nProvider>\r\n              <View style={{ flex: 1, height: '100%' }}>\r\n                <Slot />\r\n              </View>\r\n            </I18nProvider>\r\n          </ThemeProviderWrapper>\r\n        </PersistGate>\r\n      </Provider>\r\n    </ErrorBoundary>\r\n  );\r\n};\r\n\r\nexport default RootLayout;\r\n\r\n"],"mappings":"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","ignoreList":[]}