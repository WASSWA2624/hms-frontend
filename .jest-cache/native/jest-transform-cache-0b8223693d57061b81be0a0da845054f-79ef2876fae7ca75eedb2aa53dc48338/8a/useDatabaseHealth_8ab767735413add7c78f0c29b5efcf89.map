{"version":3,"names":["_react","require","_config","_useNetwork","_interopRequireDefault","cov_4w150804r","path","hash","global","Function","gcv","coverageData","statementMap","start","line","column","end","fnMap","name","decl","loc","branchMap","type","locations","undefined","s","f","b","_coverageSchema","coverage","actualCoverage","HEALTH_POLL_MS","useDatabaseHealth","_ref","useNetwork","isOffline","_ref2","useState","_ref3","_slicedToArray2","default","isConnected","setIsConnected","check","useCallback","_asyncToGenerator2","fetch","url","endpoints","HEALTH","_res$headers$get","res","method","signal","AbortSignal","timeout","ok","data","headers","get","includes","json","dbOk","database","_unused","useEffect","id","setInterval","clearInterval","_default","exports"],"sources":["useDatabaseHealth.js"],"sourcesContent":["/**\r\n * useDatabaseHealth Hook\r\n * Monitors backend database connectivity via health endpoint.\r\n * File: useDatabaseHealth.js\r\n */\r\nimport { useCallback, useEffect, useState } from 'react';\r\nimport { endpoints } from '@config';\r\nimport useNetwork from './useNetwork';\r\n\r\nconst HEALTH_POLL_MS = 30000;\r\n\r\nconst useDatabaseHealth = () => {\r\n  const { isOffline } = useNetwork();\r\n  const [isConnected, setIsConnected] = useState(true);\r\n\r\n  const check = useCallback(async () => {\r\n    if (typeof fetch === 'undefined') return;\r\n    const url = endpoints.HEALTH;\r\n    try {\r\n      const res = await fetch(url, { method: 'GET', signal: AbortSignal.timeout(5000) });\r\n      const ok = res.ok;\r\n      const data = res.ok && res.headers.get('content-type')?.includes('json') ? await res.json() : {};\r\n      const dbOk = data?.database === 'ok' || data?.database === true || (ok && typeof data.database === 'undefined');\r\n      setIsConnected(ok && (dbOk || typeof data.database === 'undefined'));\r\n    } catch {\r\n      setIsConnected(false);\r\n    }\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (isOffline) {\r\n      setIsConnected(false);\r\n      return;\r\n    }\r\n    check();\r\n    const id = setInterval(check, HEALTH_POLL_MS);\r\n    return () => clearInterval(id);\r\n  }, [isOffline, check]);\r\n\r\n  return { isConnected };\r\n};\r\n\r\nexport default useDatabaseHealth;\r\n"],"mappings":"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","ignoreList":[]}