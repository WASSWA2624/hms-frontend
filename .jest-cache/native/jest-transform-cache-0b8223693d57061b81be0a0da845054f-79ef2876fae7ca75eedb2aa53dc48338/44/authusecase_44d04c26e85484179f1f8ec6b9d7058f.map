{"version":3,"names":["_errors","require","_security","_auth","_auth2","_auth3","execute","_ref","_asyncToGenerator2","default","work","error","handleError","_x","apply","arguments","loginUseCase","exports","_ref2","payload","parsed","parseCredentials","response","loginApi","_normalizeAuthRespons","normalizeAuthResponse","data","user","tokens","accessToken","refreshToken","tokenManager","setTokens","_x2","registerUseCase","_ref4","parseAuthPayload","registerApi","_normalizeAuthRespons2","_x3","logoutUseCase","_ref6","logoutApi","clearTokens","refreshSessionUseCase","_ref8","getRefreshToken","refreshApi","_normalizeAuthRespons3","loadCurrentUserUseCase","_ref0","getCurrentUserApi","_normalizeAuthRespons4","verifyEmailUseCase","_ref10","verifyEmailApi","_x4","verifyPhoneUseCase","_ref12","verifyPhoneApi","_x5","resendVerificationUseCase","_ref14","resendVerificationApi","_x6","forgotPasswordUseCase","_ref16","forgotPasswordApi","_x7","resetPasswordUseCase","_ref18","resetPasswordApi","_x8","changePasswordUseCase","_ref20","changePasswordApi","_x9"],"sources":["auth.usecase.js"],"sourcesContent":["/**\r\n * Auth Use Cases\r\n * File: auth.usecase.js\r\n */\r\nimport { handleError } from '@errors';\r\nimport { tokenManager } from '@security';\r\nimport { normalizeAuthResponse } from './auth.model';\r\nimport {\r\n  changePasswordApi,\r\n  forgotPasswordApi,\r\n  getCurrentUserApi,\r\n  loginApi,\r\n  logoutApi,\r\n  refreshApi,\r\n  registerApi,\r\n  resendVerificationApi,\r\n  resetPasswordApi,\r\n  verifyEmailApi,\r\n  verifyPhoneApi,\r\n} from './auth.api';\r\nimport { parseAuthPayload, parseCredentials } from './auth.rules';\r\n\r\nconst execute = async (work) => {\r\n  try {\r\n    return await work();\r\n  } catch (error) {\r\n    throw handleError(error);\r\n  }\r\n};\r\n\r\nconst loginUseCase = async (payload) =>\r\n  execute(async () => {\r\n    const parsed = parseCredentials(payload);\r\n    const response = await loginApi(parsed);\r\n    const { user, tokens } = normalizeAuthResponse(response.data);\r\n    if (tokens?.accessToken && tokens?.refreshToken) {\r\n      await tokenManager.setTokens(tokens.accessToken, tokens.refreshToken);\r\n    }\r\n    return user;\r\n  });\r\n\r\nconst registerUseCase = async (payload) =>\r\n  execute(async () => {\r\n    const parsed = parseAuthPayload(payload);\r\n    const response = await registerApi(parsed);\r\n    const { user, tokens } = normalizeAuthResponse(response.data);\r\n    if (tokens?.accessToken && tokens?.refreshToken) {\r\n      await tokenManager.setTokens(tokens.accessToken, tokens.refreshToken);\r\n    }\r\n    return user;\r\n  });\r\n\r\nconst logoutUseCase = async () =>\r\n  execute(async () => {\r\n    try {\r\n      await logoutApi();\r\n      return true;\r\n    } finally {\r\n      await tokenManager.clearTokens();\r\n    }\r\n  });\r\n\r\nconst refreshSessionUseCase = async () =>\r\n  execute(async () => {\r\n    const refreshToken = await tokenManager.getRefreshToken();\r\n    const response = await refreshApi({ refreshToken });\r\n    const { tokens } = normalizeAuthResponse(response.data);\r\n    if (tokens?.accessToken && tokens?.refreshToken) {\r\n      await tokenManager.setTokens(tokens.accessToken, tokens.refreshToken);\r\n    }\r\n    return tokens;\r\n  });\r\n\r\nconst loadCurrentUserUseCase = async () =>\r\n  execute(async () => {\r\n    const response = await getCurrentUserApi();\r\n    const { user } = normalizeAuthResponse(response.data);\r\n    return user;\r\n  });\r\n\r\nconst verifyEmailUseCase = async (payload) =>\r\n  execute(async () => {\r\n    const parsed = parseAuthPayload(payload);\r\n    const response = await verifyEmailApi(parsed);\r\n    return response.data || null;\r\n  });\r\n\r\nconst verifyPhoneUseCase = async (payload) =>\r\n  execute(async () => {\r\n    const parsed = parseAuthPayload(payload);\r\n    const response = await verifyPhoneApi(parsed);\r\n    return response.data || null;\r\n  });\r\n\r\nconst resendVerificationUseCase = async (payload) =>\r\n  execute(async () => {\r\n    const parsed = parseAuthPayload(payload);\r\n    const response = await resendVerificationApi(parsed);\r\n    return response.data || null;\r\n  });\r\n\r\nconst forgotPasswordUseCase = async (payload) =>\r\n  execute(async () => {\r\n    const parsed = parseAuthPayload(payload);\r\n    const response = await forgotPasswordApi(parsed);\r\n    return response.data || null;\r\n  });\r\n\r\nconst resetPasswordUseCase = async (payload) =>\r\n  execute(async () => {\r\n    const parsed = parseAuthPayload(payload);\r\n    const response = await resetPasswordApi(parsed);\r\n    return response.data || null;\r\n  });\r\n\r\nconst changePasswordUseCase = async (payload) =>\r\n  execute(async () => {\r\n    const parsed = parseAuthPayload(payload);\r\n    const response = await changePasswordApi(parsed);\r\n    return response.data || null;\r\n  });\r\n\r\nexport {\r\n  loginUseCase,\r\n  registerUseCase,\r\n  logoutUseCase,\r\n  refreshSessionUseCase,\r\n  loadCurrentUserUseCase,\r\n  verifyEmailUseCase,\r\n  verifyPhoneUseCase,\r\n  resendVerificationUseCase,\r\n  forgotPasswordUseCase,\r\n  resetPasswordUseCase,\r\n  changePasswordUseCase,\r\n};\r\n"],"mappings":"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","ignoreList":[]}