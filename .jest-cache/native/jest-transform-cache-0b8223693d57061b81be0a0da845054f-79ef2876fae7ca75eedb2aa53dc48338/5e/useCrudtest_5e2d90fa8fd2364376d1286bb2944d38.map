{"version":3,"names":["_react","_interopRequireDefault","require","_reactNative","_reactTestRenderer","_useCrud","_jsxRuntime","TestComponent","_ref","actions","onResult","api","useCrud","React","useEffect","describe","it","_asyncToGenerator2","default","action","jest","fn","mockResolvedValue","ok","render","jsx","list","value","waitFor","expect","isLoading","toBe","errorCode","toBeNull","act","data","toEqual","mockRejectedValue","code","get","error"],"sources":["useCrud.test.js"],"sourcesContent":["/**\r\n * useCrud Hook Tests\r\n * File: useCrud.test.js\r\n */\r\nimport React from 'react';\r\nimport { render, waitFor } from '@testing-library/react-native';\r\nimport { act } from 'react-test-renderer';\r\nimport useCrud from '@hooks/useCrud';\r\n\r\nconst TestComponent = ({ actions, onResult }) => {\r\n  const api = useCrud(actions);\r\n  React.useEffect(() => {\r\n    onResult(api);\r\n  });\r\n  return null;\r\n};\r\n\r\ndescribe('useCrud', () => {\r\n  it('runs actions and updates async state', async () => {\r\n    const action = jest.fn().mockResolvedValue({ ok: true });\r\n    let api;\r\n    render(<TestComponent actions={{ list: action }} onResult={(value) => (api = value)} />);\r\n\r\n    await waitFor(() => {\r\n      expect(api.isLoading).toBe(false);\r\n      expect(api.errorCode).toBeNull();\r\n    });\r\n\r\n    await act(async () => {\r\n      await api.list();\r\n    });\r\n\r\n    await waitFor(() => {\r\n      expect(api.isLoading).toBe(false);\r\n      expect(api.data).toEqual({ ok: true });\r\n    });\r\n  });\r\n\r\n  it('stores error codes when action fails', async () => {\r\n    const action = jest.fn().mockRejectedValue({ code: 'UNAUTHORIZED' });\r\n    let api;\r\n    render(<TestComponent actions={{ get: action }} onResult={(value) => (api = value)} />);\r\n\r\n    await act(async () => {\r\n      try {\r\n        await api.get('1');\r\n      } catch (error) {\r\n        expect(error.code).toBe('UNAUTHORIZED');\r\n      }\r\n    });\r\n\r\n    await waitFor(() => {\r\n      expect(api.errorCode).toBe('UNAUTHORIZED');\r\n    });\r\n  });\r\n});\r\n"],"mappings":"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","ignoreList":[]}