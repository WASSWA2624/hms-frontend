{"version":3,"names":["_react","require","_hooks","_types","calculatePasswordStrength","password","theme","strength","PASSWORD_STRENGTH","WEAK","label","color","hasMixedCase","test","hasNumbers","hasSpecial","length","FAIR","GOOD","VERY_STRONG","STRONG","finalStrength","Math","min","strengthColors","_defineProperty2","default","colors","error","warning","success","strengthLabels","text","tertiary","usePasswordField","_ref","_ref$password","useTheme","passwordStrength","useMemo","_default","exports"],"sources":["usePasswordField.js"],"sourcesContent":["/**\r\n * PasswordField Hook\r\n * Password strength calculation and validation logic\r\n * File: usePasswordField.js\r\n */\r\nimport { useMemo } from 'react';\r\nimport { useTheme } from '@hooks';\r\nimport { PASSWORD_STRENGTH } from './types';\r\n\r\n/**\r\n * Calculate password strength\r\n * @param {string} password - Password to check\r\n * @param {Object} theme - Theme object with colors\r\n * @returns {Object} Strength info with level, label, and color\r\n */\r\nconst calculatePasswordStrength = (password, theme) => {\r\n  if (!password) {\r\n    return {\r\n      strength: PASSWORD_STRENGTH.WEAK,\r\n      label: '',\r\n      color: '',\r\n    };\r\n  }\r\n\r\n  // Check for complexity features\r\n  const hasMixedCase = /[a-z]/.test(password) && /[A-Z]/.test(password);\r\n  const hasNumbers = /\\d/.test(password);\r\n  const hasSpecial = /[^a-zA-Z\\d]/.test(password);\r\n  const length = password.length;\r\n\r\n  // Base strength based on length\r\n  let strength = 0;\r\n  if (length >= 8) {\r\n    strength = PASSWORD_STRENGTH.FAIR; // 1\r\n  }\r\n  if (length >= 12) {\r\n    strength = PASSWORD_STRENGTH.GOOD; // 2\r\n  }\r\n\r\n  // Apply complexity bonuses based on test expectations:\r\n  // - 'password1234' (12 chars, lowercase + numbers) → GOOD (2)\r\n  // - 'Password1234' (12 chars, mixed case + numbers) → STRONG (3)\r\n  // - 'ComplexP@ssw0rd123' (mixed case + numbers + special) → VERY_STRONG (4)\r\n  // - 'password123' (11 chars, lowercase + numbers) → >= GOOD (2)\r\n  // - 'password@123' (11 chars, lowercase + numbers + special) → >= STRONG (3)\r\n\r\n  if (length >= 12) {\r\n    // 12+ chars: base is GOOD (2)\r\n    if (hasMixedCase && hasNumbers && hasSpecial) {\r\n      strength = PASSWORD_STRENGTH.VERY_STRONG; // 4\r\n    } else if (hasMixedCase && hasNumbers) {\r\n      strength = PASSWORD_STRENGTH.STRONG; // 3\r\n    } else if (hasNumbers && hasSpecial) {\r\n      strength = PASSWORD_STRENGTH.STRONG; // 3 - e.g., 'password@123' (12 chars, numbers + special)\r\n    }\r\n    // Otherwise keep at GOOD (2) - e.g., 'password1234' (lowercase + numbers only)\r\n  } else if (length >= 8) {\r\n    // 8-11 chars: base is FAIR (1)\r\n    if ((hasMixedCase && hasNumbers) || (hasNumbers && hasSpecial)) {\r\n      strength = PASSWORD_STRENGTH.STRONG; // 3 - e.g., 'Password123' or 'password@123'\r\n    } else if (hasMixedCase || hasNumbers || hasSpecial) {\r\n      strength = PASSWORD_STRENGTH.GOOD; // 2\r\n    }\r\n  }\r\n\r\n  const finalStrength = Math.min(strength, PASSWORD_STRENGTH.VERY_STRONG);\r\n\r\n  // Map strength to theme colors and labels\r\n  const strengthColors = {\r\n    [PASSWORD_STRENGTH.WEAK]: theme.colors.error,\r\n    [PASSWORD_STRENGTH.FAIR]: theme.colors.warning,\r\n    [PASSWORD_STRENGTH.GOOD]: theme.colors.warning, // Use warning for good (yellow/orange)\r\n    [PASSWORD_STRENGTH.STRONG]: theme.colors.success,\r\n    [PASSWORD_STRENGTH.VERY_STRONG]: theme.colors.success,\r\n  };\r\n\r\n  const strengthLabels = {\r\n    [PASSWORD_STRENGTH.WEAK]: 'Weak',\r\n    [PASSWORD_STRENGTH.FAIR]: 'Fair',\r\n    [PASSWORD_STRENGTH.GOOD]: 'Good',\r\n    [PASSWORD_STRENGTH.STRONG]: 'Strong',\r\n    [PASSWORD_STRENGTH.VERY_STRONG]: 'Very Strong',\r\n  };\r\n\r\n  return {\r\n    strength: finalStrength,\r\n    label: strengthLabels[finalStrength] || '',\r\n    color: strengthColors[finalStrength] || theme.colors.text.tertiary,\r\n  };\r\n};\r\n\r\n/**\r\n * Custom hook for PasswordField logic\r\n * @param {Object} params - Hook parameters\r\n * @param {string} params.password - Password value\r\n * @returns {Object} Password strength information\r\n */\r\nconst usePasswordField = ({ password = '' }) => {\r\n  const theme = useTheme();\r\n  const passwordStrength = useMemo(\r\n    () => calculatePasswordStrength(password, theme),\r\n    [password, theme]\r\n  );\r\n\r\n  return {\r\n    passwordStrength,\r\n  };\r\n};\r\n\r\nexport default usePasswordField;\r\n\r\n"],"mappings":";;;;;;AAKA,IAAAA,MAAA,GAAAC,OAAA;AACA,IAAAC,MAAA,GAAAD,OAAA;AACA,IAAAE,MAAA,GAAAF,OAAA;AAQA,IAAMG,yBAAyB,GAAG,SAA5BA,yBAAyBA,CAAIC,QAAQ,EAAEC,KAAK,EAAK;EACrD,IAAI,CAACD,QAAQ,EAAE;IACb,OAAO;MACLE,QAAQ,EAAEC,wBAAiB,CAACC,IAAI;MAChCC,KAAK,EAAE,EAAE;MACTC,KAAK,EAAE;IACT,CAAC;EACH;EAGA,IAAMC,YAAY,GAAG,OAAO,CAACC,IAAI,CAACR,QAAQ,CAAC,IAAI,OAAO,CAACQ,IAAI,CAACR,QAAQ,CAAC;EACrE,IAAMS,UAAU,GAAG,IAAI,CAACD,IAAI,CAACR,QAAQ,CAAC;EACtC,IAAMU,UAAU,GAAG,aAAa,CAACF,IAAI,CAACR,QAAQ,CAAC;EAC/C,IAAMW,MAAM,GAAGX,QAAQ,CAACW,MAAM;EAG9B,IAAIT,QAAQ,GAAG,CAAC;EAChB,IAAIS,MAAM,IAAI,CAAC,EAAE;IACfT,QAAQ,GAAGC,wBAAiB,CAACS,IAAI;EACnC;EACA,IAAID,MAAM,IAAI,EAAE,EAAE;IAChBT,QAAQ,GAAGC,wBAAiB,CAACU,IAAI;EACnC;EASA,IAAIF,MAAM,IAAI,EAAE,EAAE;IAEhB,IAAIJ,YAAY,IAAIE,UAAU,IAAIC,UAAU,EAAE;MAC5CR,QAAQ,GAAGC,wBAAiB,CAACW,WAAW;IAC1C,CAAC,MAAM,IAAIP,YAAY,IAAIE,UAAU,EAAE;MACrCP,QAAQ,GAAGC,wBAAiB,CAACY,MAAM;IACrC,CAAC,MAAM,IAAIN,UAAU,IAAIC,UAAU,EAAE;MACnCR,QAAQ,GAAGC,wBAAiB,CAACY,MAAM;IACrC;EAEF,CAAC,MAAM,IAAIJ,MAAM,IAAI,CAAC,EAAE;IAEtB,IAAKJ,YAAY,IAAIE,UAAU,IAAMA,UAAU,IAAIC,UAAW,EAAE;MAC9DR,QAAQ,GAAGC,wBAAiB,CAACY,MAAM;IACrC,CAAC,MAAM,IAAIR,YAAY,IAAIE,UAAU,IAAIC,UAAU,EAAE;MACnDR,QAAQ,GAAGC,wBAAiB,CAACU,IAAI;IACnC;EACF;EAEA,IAAMG,aAAa,GAAGC,IAAI,CAACC,GAAG,CAAChB,QAAQ,EAAEC,wBAAiB,CAACW,WAAW,CAAC;EAGvE,IAAMK,cAAc,OAAAC,gBAAA,CAAAC,OAAA,MAAAD,gBAAA,CAAAC,OAAA,MAAAD,gBAAA,CAAAC,OAAA,MAAAD,gBAAA,CAAAC,OAAA,MAAAD,gBAAA,CAAAC,OAAA,MACjBlB,wBAAiB,CAACC,IAAI,EAAGH,KAAK,CAACqB,MAAM,CAACC,KAAK,GAC3CpB,wBAAiB,CAACS,IAAI,EAAGX,KAAK,CAACqB,MAAM,CAACE,OAAO,GAC7CrB,wBAAiB,CAACU,IAAI,EAAGZ,KAAK,CAACqB,MAAM,CAACE,OAAO,GAC7CrB,wBAAiB,CAACY,MAAM,EAAGd,KAAK,CAACqB,MAAM,CAACG,OAAO,GAC/CtB,wBAAiB,CAACW,WAAW,EAAGb,KAAK,CAACqB,MAAM,CAACG,OAAO,CACtD;EAED,IAAMC,cAAc,OAAAN,gBAAA,CAAAC,OAAA,MAAAD,gBAAA,CAAAC,OAAA,MAAAD,gBAAA,CAAAC,OAAA,MAAAD,gBAAA,CAAAC,OAAA,MAAAD,gBAAA,CAAAC,OAAA,MACjBlB,wBAAiB,CAACC,IAAI,EAAG,MAAM,GAC/BD,wBAAiB,CAACS,IAAI,EAAG,MAAM,GAC/BT,wBAAiB,CAACU,IAAI,EAAG,MAAM,GAC/BV,wBAAiB,CAACY,MAAM,EAAG,QAAQ,GACnCZ,wBAAiB,CAACW,WAAW,EAAG,aAAa,CAC/C;EAED,OAAO;IACLZ,QAAQ,EAAEc,aAAa;IACvBX,KAAK,EAAEqB,cAAc,CAACV,aAAa,CAAC,IAAI,EAAE;IAC1CV,KAAK,EAAEa,cAAc,CAACH,aAAa,CAAC,IAAIf,KAAK,CAACqB,MAAM,CAACK,IAAI,CAACC;EAC5D,CAAC;AACH,CAAC;AAQD,IAAMC,gBAAgB,GAAG,SAAnBA,gBAAgBA,CAAAC,IAAA,EAA0B;EAAA,IAAAC,aAAA,GAAAD,IAAA,CAApB9B,QAAQ;IAARA,QAAQ,GAAA+B,aAAA,cAAG,EAAE,GAAAA,aAAA;EACvC,IAAM9B,KAAK,GAAG,IAAA+B,eAAQ,EAAC,CAAC;EACxB,IAAMC,gBAAgB,GAAG,IAAAC,cAAO,EAC9B;IAAA,OAAMnC,yBAAyB,CAACC,QAAQ,EAAEC,KAAK,CAAC;EAAA,GAChD,CAACD,QAAQ,EAAEC,KAAK,CAClB,CAAC;EAED,OAAO;IACLgC,gBAAgB,EAAhBA;EACF,CAAC;AACH,CAAC;AAAC,IAAAE,QAAA,GAAAC,OAAA,CAAAf,OAAA,GAEaQ,gBAAgB","ignoreList":[]}