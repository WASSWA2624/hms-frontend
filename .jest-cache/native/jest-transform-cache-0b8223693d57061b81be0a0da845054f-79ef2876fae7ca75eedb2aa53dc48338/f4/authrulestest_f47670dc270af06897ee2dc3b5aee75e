a2a935f66c0f2d3e9523841ef78b4645
var _auth = require("../../../features/auth");
describe('auth.rules', function () {
  it('parses credentials and payloads', function () {
    expect((0, _auth.parseCredentials)({
      email: 'user@example.com',
      password: 'pass',
      tenant_id: '550e8400-e29b-41d4-a716-446655440000'
    })).toEqual({
      email: 'user@example.com',
      password: 'pass',
      tenant_id: '550e8400-e29b-41d4-a716-446655440000'
    });
    expect((0, _auth.parseCredentials)({
      email: 'user@example.com',
      password: 'pass',
      tenant_id: '550e8400-e29b-41d4-a716-446655440000',
      facility_id: '550e8400-e29b-41d4-a716-446655440001'
    })).toEqual({
      email: 'user@example.com',
      password: 'pass',
      tenant_id: '550e8400-e29b-41d4-a716-446655440000',
      facility_id: '550e8400-e29b-41d4-a716-446655440001'
    });
    expect((0, _auth.parseCredentials)({
      phone: '256701234567',
      password: 'pass',
      tenant_id: '550e8400-e29b-41d4-a716-446655440000'
    })).toEqual({
      phone: '256701234567',
      password: 'pass',
      tenant_id: '550e8400-e29b-41d4-a716-446655440000'
    });
    expect((0, _auth.parseAuthPayload)({
      token: 'abc'
    })).toEqual({
      token: 'abc'
    });
  });
  it('rejects credentials without identifier', function () {
    expect(function () {
      return (0, _auth.parseCredentials)({
        password: 'pass',
        tenant_id: '550e8400-e29b-41d4-a716-446655440000'
      });
    }).toThrow('identifier_required');
  });
  it('rejects phone numbers with plus sign', function () {
    expect(function () {
      return (0, _auth.parseCredentials)({
        phone: '+256701234567',
        password: 'pass',
        tenant_id: '550e8400-e29b-41d4-a716-446655440000'
      });
    }).toThrow();
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfYXV0aCIsInJlcXVpcmUiLCJkZXNjcmliZSIsIml0IiwiZXhwZWN0IiwicGFyc2VDcmVkZW50aWFscyIsImVtYWlsIiwicGFzc3dvcmQiLCJ0ZW5hbnRfaWQiLCJ0b0VxdWFsIiwiZmFjaWxpdHlfaWQiLCJwaG9uZSIsInBhcnNlQXV0aFBheWxvYWQiLCJ0b2tlbiIsInRvVGhyb3ciXSwic291cmNlcyI6WyJhdXRoLnJ1bGVzLnRlc3QuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIEF1dGggUnVsZXMgVGVzdHNcclxuICogRmlsZTogYXV0aC5ydWxlcy50ZXN0LmpzXHJcbiAqL1xyXG5pbXBvcnQgeyBwYXJzZUF1dGhQYXlsb2FkLCBwYXJzZUNyZWRlbnRpYWxzIH0gZnJvbSAnQGZlYXR1cmVzL2F1dGgnO1xyXG5cclxuZGVzY3JpYmUoJ2F1dGgucnVsZXMnLCAoKSA9PiB7XHJcbiAgaXQoJ3BhcnNlcyBjcmVkZW50aWFscyBhbmQgcGF5bG9hZHMnLCAoKSA9PiB7XHJcbiAgICBleHBlY3QocGFyc2VDcmVkZW50aWFscyh7IGVtYWlsOiAndXNlckBleGFtcGxlLmNvbScsIHBhc3N3b3JkOiAncGFzcycsIHRlbmFudF9pZDogJzU1MGU4NDAwLWUyOWItNDFkNC1hNzE2LTQ0NjY1NTQ0MDAwMCcgfSkpLnRvRXF1YWwoe1xyXG4gICAgICBlbWFpbDogJ3VzZXJAZXhhbXBsZS5jb20nLFxyXG4gICAgICBwYXNzd29yZDogJ3Bhc3MnLFxyXG4gICAgICB0ZW5hbnRfaWQ6ICc1NTBlODQwMC1lMjliLTQxZDQtYTcxNi00NDY2NTU0NDAwMDAnLFxyXG4gICAgfSk7XHJcbiAgICBleHBlY3QocGFyc2VDcmVkZW50aWFscyh7XHJcbiAgICAgIGVtYWlsOiAndXNlckBleGFtcGxlLmNvbScsXHJcbiAgICAgIHBhc3N3b3JkOiAncGFzcycsXHJcbiAgICAgIHRlbmFudF9pZDogJzU1MGU4NDAwLWUyOWItNDFkNC1hNzE2LTQ0NjY1NTQ0MDAwMCcsXHJcbiAgICAgIGZhY2lsaXR5X2lkOiAnNTUwZTg0MDAtZTI5Yi00MWQ0LWE3MTYtNDQ2NjU1NDQwMDAxJ1xyXG4gICAgfSkpLnRvRXF1YWwoe1xyXG4gICAgICBlbWFpbDogJ3VzZXJAZXhhbXBsZS5jb20nLFxyXG4gICAgICBwYXNzd29yZDogJ3Bhc3MnLFxyXG4gICAgICB0ZW5hbnRfaWQ6ICc1NTBlODQwMC1lMjliLTQxZDQtYTcxNi00NDY2NTU0NDAwMDAnLFxyXG4gICAgICBmYWNpbGl0eV9pZDogJzU1MGU4NDAwLWUyOWItNDFkNC1hNzE2LTQ0NjY1NTQ0MDAwMSdcclxuICAgIH0pO1xyXG4gICAgZXhwZWN0KHBhcnNlQ3JlZGVudGlhbHMoeyBwaG9uZTogJzI1NjcwMTIzNDU2NycsIHBhc3N3b3JkOiAncGFzcycsIHRlbmFudF9pZDogJzU1MGU4NDAwLWUyOWItNDFkNC1hNzE2LTQ0NjY1NTQ0MDAwMCcgfSkpLnRvRXF1YWwoe1xyXG4gICAgICBwaG9uZTogJzI1NjcwMTIzNDU2NycsXHJcbiAgICAgIHBhc3N3b3JkOiAncGFzcycsXHJcbiAgICAgIHRlbmFudF9pZDogJzU1MGU4NDAwLWUyOWItNDFkNC1hNzE2LTQ0NjY1NTQ0MDAwMCcsXHJcbiAgICB9KTtcclxuICAgIGV4cGVjdChwYXJzZUF1dGhQYXlsb2FkKHsgdG9rZW46ICdhYmMnIH0pKS50b0VxdWFsKHsgdG9rZW46ICdhYmMnIH0pO1xyXG4gIH0pO1xyXG5cclxuICBpdCgncmVqZWN0cyBjcmVkZW50aWFscyB3aXRob3V0IGlkZW50aWZpZXInLCAoKSA9PiB7XHJcbiAgICBleHBlY3QoKCkgPT4gcGFyc2VDcmVkZW50aWFscyh7IHBhc3N3b3JkOiAncGFzcycsIHRlbmFudF9pZDogJzU1MGU4NDAwLWUyOWItNDFkNC1hNzE2LTQ0NjY1NTQ0MDAwMCcgfSkpLnRvVGhyb3coJ2lkZW50aWZpZXJfcmVxdWlyZWQnKTtcclxuICB9KTtcclxuXHJcbiAgaXQoJ3JlamVjdHMgcGhvbmUgbnVtYmVycyB3aXRoIHBsdXMgc2lnbicsICgpID0+IHtcclxuICAgIGV4cGVjdCgoKSA9PiBwYXJzZUNyZWRlbnRpYWxzKHsgcGhvbmU6ICcrMjU2NzAxMjM0NTY3JywgcGFzc3dvcmQ6ICdwYXNzJywgdGVuYW50X2lkOiAnNTUwZTg0MDAtZTI5Yi00MWQ0LWE3MTYtNDQ2NjU1NDQwMDAwJyB9KSkudG9UaHJvdygpO1xyXG4gIH0pO1xyXG59KTtcclxuIl0sIm1hcHBpbmdzIjoiQUFJQSxJQUFBQSxLQUFBLEdBQUFDLE9BQUE7QUFFQUMsUUFBUSxDQUFDLFlBQVksRUFBRSxZQUFNO0VBQzNCQyxFQUFFLENBQUMsaUNBQWlDLEVBQUUsWUFBTTtJQUMxQ0MsTUFBTSxDQUFDLElBQUFDLHNCQUFnQixFQUFDO01BQUVDLEtBQUssRUFBRSxrQkFBa0I7TUFBRUMsUUFBUSxFQUFFLE1BQU07TUFBRUMsU0FBUyxFQUFFO0lBQXVDLENBQUMsQ0FBQyxDQUFDLENBQUNDLE9BQU8sQ0FBQztNQUNuSUgsS0FBSyxFQUFFLGtCQUFrQjtNQUN6QkMsUUFBUSxFQUFFLE1BQU07TUFDaEJDLFNBQVMsRUFBRTtJQUNiLENBQUMsQ0FBQztJQUNGSixNQUFNLENBQUMsSUFBQUMsc0JBQWdCLEVBQUM7TUFDdEJDLEtBQUssRUFBRSxrQkFBa0I7TUFDekJDLFFBQVEsRUFBRSxNQUFNO01BQ2hCQyxTQUFTLEVBQUUsc0NBQXNDO01BQ2pERSxXQUFXLEVBQUU7SUFDZixDQUFDLENBQUMsQ0FBQyxDQUFDRCxPQUFPLENBQUM7TUFDVkgsS0FBSyxFQUFFLGtCQUFrQjtNQUN6QkMsUUFBUSxFQUFFLE1BQU07TUFDaEJDLFNBQVMsRUFBRSxzQ0FBc0M7TUFDakRFLFdBQVcsRUFBRTtJQUNmLENBQUMsQ0FBQztJQUNGTixNQUFNLENBQUMsSUFBQUMsc0JBQWdCLEVBQUM7TUFBRU0sS0FBSyxFQUFFLGNBQWM7TUFBRUosUUFBUSxFQUFFLE1BQU07TUFBRUMsU0FBUyxFQUFFO0lBQXVDLENBQUMsQ0FBQyxDQUFDLENBQUNDLE9BQU8sQ0FBQztNQUMvSEUsS0FBSyxFQUFFLGNBQWM7TUFDckJKLFFBQVEsRUFBRSxNQUFNO01BQ2hCQyxTQUFTLEVBQUU7SUFDYixDQUFDLENBQUM7SUFDRkosTUFBTSxDQUFDLElBQUFRLHNCQUFnQixFQUFDO01BQUVDLEtBQUssRUFBRTtJQUFNLENBQUMsQ0FBQyxDQUFDLENBQUNKLE9BQU8sQ0FBQztNQUFFSSxLQUFLLEVBQUU7SUFBTSxDQUFDLENBQUM7RUFDdEUsQ0FBQyxDQUFDO0VBRUZWLEVBQUUsQ0FBQyx3Q0FBd0MsRUFBRSxZQUFNO0lBQ2pEQyxNQUFNLENBQUM7TUFBQSxPQUFNLElBQUFDLHNCQUFnQixFQUFDO1FBQUVFLFFBQVEsRUFBRSxNQUFNO1FBQUVDLFNBQVMsRUFBRTtNQUF1QyxDQUFDLENBQUM7SUFBQSxFQUFDLENBQUNNLE9BQU8sQ0FBQyxxQkFBcUIsQ0FBQztFQUN4SSxDQUFDLENBQUM7RUFFRlgsRUFBRSxDQUFDLHNDQUFzQyxFQUFFLFlBQU07SUFDL0NDLE1BQU0sQ0FBQztNQUFBLE9BQU0sSUFBQUMsc0JBQWdCLEVBQUM7UUFBRU0sS0FBSyxFQUFFLGVBQWU7UUFBRUosUUFBUSxFQUFFLE1BQU07UUFBRUMsU0FBUyxFQUFFO01BQXVDLENBQUMsQ0FBQztJQUFBLEVBQUMsQ0FBQ00sT0FBTyxDQUFDLENBQUM7RUFDM0ksQ0FBQyxDQUFDO0FBQ0osQ0FBQyxDQUFDIiwiaWdub3JlTGlzdCI6W119