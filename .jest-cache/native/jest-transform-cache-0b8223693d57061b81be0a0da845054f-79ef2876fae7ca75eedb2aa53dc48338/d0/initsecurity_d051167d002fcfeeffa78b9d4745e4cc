8087176338279446ba6c5147aeba6196
var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault").default;
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.initSecurity = initSecurity;
var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));
var _security = require("../security");
var _logging = require("../logging");
function initSecurity() {
  return _initSecurity.apply(this, arguments);
}
function _initSecurity() {
  _initSecurity = (0, _asyncToGenerator2.default)(function* () {
    try {
      var accessToken = yield _security.tokenManager.getAccessToken();
      var refreshToken = yield _security.tokenManager.getRefreshToken();
      if (accessToken) {
        var isExpired = _security.tokenManager.isTokenExpired(accessToken);
        if (isExpired && refreshToken) {
          _logging.logger.info('Access token expired, refresh token available');
        } else if (isExpired) {
          _logging.logger.info('Tokens expired, user will need to re-authenticate');
        } else {
          _logging.logger.info('Valid session found on startup');
        }
      } else {
        _logging.logger.info('No session found on startup');
      }
      _logging.logger.info('Security initialized successfully');
    } catch (error) {
      _logging.logger.error('Security initialization failed', {
        error: error.message
      });
    }
  });
  return _initSecurity.apply(this, arguments);
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfc2VjdXJpdHkiLCJyZXF1aXJlIiwiX2xvZ2dpbmciLCJpbml0U2VjdXJpdHkiLCJfaW5pdFNlY3VyaXR5IiwiYXBwbHkiLCJhcmd1bWVudHMiLCJfYXN5bmNUb0dlbmVyYXRvcjIiLCJkZWZhdWx0IiwiYWNjZXNzVG9rZW4iLCJ0b2tlbk1hbmFnZXIiLCJnZXRBY2Nlc3NUb2tlbiIsInJlZnJlc2hUb2tlbiIsImdldFJlZnJlc2hUb2tlbiIsImlzRXhwaXJlZCIsImlzVG9rZW5FeHBpcmVkIiwibG9nZ2VyIiwiaW5mbyIsImVycm9yIiwibWVzc2FnZSJdLCJzb3VyY2VzIjpbImluaXQuc2VjdXJpdHkuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIFNlY3VyaXR5IEluaXRpYWxpemF0aW9uXHJcbiAqIEZpbGU6IGluaXQuc2VjdXJpdHkuanNcclxuICovXHJcbmltcG9ydCB7IHRva2VuTWFuYWdlciB9IGZyb20gJ0BzZWN1cml0eSc7XHJcbmltcG9ydCB7IGxvZ2dlciB9IGZyb20gJ0Bsb2dnaW5nJztcclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBpbml0U2VjdXJpdHkoKSB7XHJcbiAgdHJ5IHtcclxuICAgIC8vIENoZWNrIGlmIHRva2VucyBleGlzdCBhbmQgYXJlIHZhbGlkXHJcbiAgICBjb25zdCBhY2Nlc3NUb2tlbiA9IGF3YWl0IHRva2VuTWFuYWdlci5nZXRBY2Nlc3NUb2tlbigpO1xyXG4gICAgY29uc3QgcmVmcmVzaFRva2VuID0gYXdhaXQgdG9rZW5NYW5hZ2VyLmdldFJlZnJlc2hUb2tlbigpO1xyXG4gICAgXHJcbiAgICBpZiAoYWNjZXNzVG9rZW4pIHtcclxuICAgICAgY29uc3QgaXNFeHBpcmVkID0gdG9rZW5NYW5hZ2VyLmlzVG9rZW5FeHBpcmVkKGFjY2Vzc1Rva2VuKTtcclxuICAgICAgaWYgKGlzRXhwaXJlZCAmJiByZWZyZXNoVG9rZW4pIHtcclxuICAgICAgICBsb2dnZXIuaW5mbygnQWNjZXNzIHRva2VuIGV4cGlyZWQsIHJlZnJlc2ggdG9rZW4gYXZhaWxhYmxlJyk7XHJcbiAgICAgIH0gZWxzZSBpZiAoaXNFeHBpcmVkKSB7XHJcbiAgICAgICAgbG9nZ2VyLmluZm8oJ1Rva2VucyBleHBpcmVkLCB1c2VyIHdpbGwgbmVlZCB0byByZS1hdXRoZW50aWNhdGUnKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBsb2dnZXIuaW5mbygnVmFsaWQgc2Vzc2lvbiBmb3VuZCBvbiBzdGFydHVwJyk7XHJcbiAgICAgIH1cclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGxvZ2dlci5pbmZvKCdObyBzZXNzaW9uIGZvdW5kIG9uIHN0YXJ0dXAnKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gSW5pdGlhbGl6ZSBlbmNyeXB0aW9uIGtleXMgKGlmIG5lZWRlZClcclxuICAgIC8vIEVuY3J5cHRpb24ga2V5cyBhcmUgaW5pdGlhbGl6ZWQgbGF6aWx5IHdoZW4gbmVlZGVkXHJcbiAgICBcclxuICAgIGxvZ2dlci5pbmZvKCdTZWN1cml0eSBpbml0aWFsaXplZCBzdWNjZXNzZnVsbHknKTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgLy8gU2VjdXJpdHkgZmFpbHVyZXMgbXVzdCBub3QgY3Jhc2ggYXBwLCBidXQgc2hvdWxkIGJlIGxvZ2dlZFxyXG4gICAgbG9nZ2VyLmVycm9yKCdTZWN1cml0eSBpbml0aWFsaXphdGlvbiBmYWlsZWQnLCB7IGVycm9yOiBlcnJvci5tZXNzYWdlIH0pO1xyXG4gICAgLy8gRG9uJ3QgdGhyb3cgLSBhbGxvdyBhcHAgdG8gY29udGludWUsIGJ1dCBzZWN1cml0eSBmZWF0dXJlcyBtYXkgYmUgbGltaXRlZFxyXG4gIH1cclxufVxyXG5cclxuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFJQSxJQUFBQSxTQUFBLEdBQUFDLE9BQUE7QUFDQSxJQUFBQyxRQUFBLEdBQUFELE9BQUE7QUFBa0MsU0FFWkUsWUFBWUEsQ0FBQTtFQUFBLE9BQUFDLGFBQUEsQ0FBQUMsS0FBQSxPQUFBQyxTQUFBO0FBQUE7QUFBQSxTQUFBRixjQUFBO0VBQUFBLGFBQUEsT0FBQUcsa0JBQUEsQ0FBQUMsT0FBQSxFQUEzQixhQUE4QjtJQUNuQyxJQUFJO01BRUYsSUFBTUMsV0FBVyxTQUFTQyxzQkFBWSxDQUFDQyxjQUFjLENBQUMsQ0FBQztNQUN2RCxJQUFNQyxZQUFZLFNBQVNGLHNCQUFZLENBQUNHLGVBQWUsQ0FBQyxDQUFDO01BRXpELElBQUlKLFdBQVcsRUFBRTtRQUNmLElBQU1LLFNBQVMsR0FBR0osc0JBQVksQ0FBQ0ssY0FBYyxDQUFDTixXQUFXLENBQUM7UUFDMUQsSUFBSUssU0FBUyxJQUFJRixZQUFZLEVBQUU7VUFDN0JJLGVBQU0sQ0FBQ0MsSUFBSSxDQUFDLCtDQUErQyxDQUFDO1FBQzlELENBQUMsTUFBTSxJQUFJSCxTQUFTLEVBQUU7VUFDcEJFLGVBQU0sQ0FBQ0MsSUFBSSxDQUFDLG1EQUFtRCxDQUFDO1FBQ2xFLENBQUMsTUFBTTtVQUNMRCxlQUFNLENBQUNDLElBQUksQ0FBQyxnQ0FBZ0MsQ0FBQztRQUMvQztNQUNGLENBQUMsTUFBTTtRQUNMRCxlQUFNLENBQUNDLElBQUksQ0FBQyw2QkFBNkIsQ0FBQztNQUM1QztNQUtBRCxlQUFNLENBQUNDLElBQUksQ0FBQyxtQ0FBbUMsQ0FBQztJQUNsRCxDQUFDLENBQUMsT0FBT0MsS0FBSyxFQUFFO01BRWRGLGVBQU0sQ0FBQ0UsS0FBSyxDQUFDLGdDQUFnQyxFQUFFO1FBQUVBLEtBQUssRUFBRUEsS0FBSyxDQUFDQztNQUFRLENBQUMsQ0FBQztJQUUxRTtFQUNGLENBQUM7RUFBQSxPQUFBZixhQUFBLENBQUFDLEtBQUEsT0FBQUMsU0FBQTtBQUFBIiwiaWdub3JlTGlzdCI6W119