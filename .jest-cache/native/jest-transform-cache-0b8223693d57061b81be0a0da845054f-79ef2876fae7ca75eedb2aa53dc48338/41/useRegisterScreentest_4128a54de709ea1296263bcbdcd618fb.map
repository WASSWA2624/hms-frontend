{"version":3,"names":["_getJestObj","mock","useAuth","jest","fn","useI18n","useNetwork","useRouter","_interopRequireDefault","require","default","_asyncToGenerator2","_require4","React","TestRenderer","_require","_require2","useRegisterScreen","_require3","STEPS","act","renderHook","hook","result","renderer","HookHarness","hookResult","Object","assign","create","createElement","current","unmount","describe","register","Promise","resolve","clearError","push","t","key","beforeEach","clearAllMocks","mockReturnValue","isLoading","errorCode","isAuthenticated","roles","isOffline","it","_renderHook","expect","email","toBe","password","tenantId","canSubmit","canProceed","_renderHook2","handleChangeTenantId","_renderHook3","handleChangeFacilityId","handleContinue","handleChangeEmail","handleChangePassword","handleChangePhone","handleSubmit","toHaveBeenCalled","toHaveBeenCalledWith","tenant_id","facility_id","phone","_renderHook4","errorMessage","_renderHook5","accessErrorMessage","_renderHook6","tenantIdError","step","ORGANIZATION","_renderHook7","handleGoToLogin","_renderHook8","handleBack"],"sources":["useRegisterScreen.test.js"],"sourcesContent":["/**\r\n * useRegisterScreen Hook Tests\r\n * File: useRegisterScreen.test.js\r\n */\r\nconst React = require('react');\r\nconst TestRenderer = require('react-test-renderer');\r\nconst { useAuth, useI18n, useNetwork } = require('@hooks');\r\nconst { useRouter } = require('expo-router');\r\n\r\nconst useRegisterScreen = require('@platform/screens/auth/RegisterScreen/useRegisterScreen').default;\r\n// eslint-disable-next-line import/no-unresolved\r\nconst { STEPS } = require('@platform/screens/auth/RegisterScreen/types.js');\r\n\r\njest.mock('@hooks', () => ({\r\n  useAuth: jest.fn(),\r\n  useI18n: jest.fn(),\r\n  useNetwork: jest.fn(),\r\n}));\r\n\r\njest.mock('expo-router', () => ({\r\n  useRouter: jest.fn(),\r\n}));\r\n\r\nconst act = TestRenderer.act;\r\nconst renderHook = (hook) => {\r\n  const result = {};\r\n  let renderer;\r\n\r\n  const HookHarness = () => {\r\n    const hookResult = hook();\r\n    Object.assign(result, hookResult);\r\n    return null;\r\n  };\r\n\r\n  act(() => {\r\n    renderer = TestRenderer.create(React.createElement(HookHarness));\r\n  });\r\n\r\n  return {\r\n    result: { current: result },\r\n    unmount: () => {\r\n      act(() => {\r\n        renderer.unmount();\r\n      });\r\n    },\r\n  };\r\n};\r\n\r\ndescribe('useRegisterScreen Hook', () => {\r\n  const register = jest.fn(() => Promise.resolve({}));\r\n  const clearError = jest.fn();\r\n  const push = jest.fn();\r\n  const t = jest.fn((key) => {\r\n    if (key === 'errors.codes.UNKNOWN_ERROR') return 'Unknown error';\r\n    if (key === 'errors.codes.CONFLICT') return 'Conflict';\r\n    return key;\r\n  });\r\n\r\n  beforeEach(() => {\r\n    jest.clearAllMocks();\r\n    useAuth.mockReturnValue({\r\n      register,\r\n      clearError,\r\n      isLoading: false,\r\n      errorCode: null,\r\n      isAuthenticated: true,\r\n      roles: ['admin'],\r\n    });\r\n    useI18n.mockReturnValue({ t });\r\n    useNetwork.mockReturnValue({ isOffline: false });\r\n    useRouter.mockReturnValue({ push });\r\n  });\r\n\r\n  it('returns initial state', () => {\r\n    const { result } = renderHook(() => useRegisterScreen());\r\n    expect(result.current.email).toBe('');\r\n    expect(result.current.password).toBe('');\r\n    expect(result.current.tenantId).toBe('');\r\n    expect(result.current.canSubmit).toBe(false);\r\n    expect(result.current.canProceed).toBe(false);\r\n  });\r\n\r\n  it('enables continue when tenant is valid', () => {\r\n    const { result } = renderHook(() => useRegisterScreen());\r\n    act(() => {\r\n      result.current.handleChangeTenantId('550e8400-e29b-41d4-a716-446655440000');\r\n    });\r\n    expect(result.current.canProceed).toBe(true);\r\n  });\r\n\r\n  it('advances to details step and submits register payload', async () => {\r\n    const { result } = renderHook(() => useRegisterScreen());\r\n    act(() => {\r\n      result.current.handleChangeTenantId('550e8400-e29b-41d4-a716-446655440000');\r\n      result.current.handleChangeFacilityId('550e8400-e29b-41d4-a716-446655440001');\r\n    });\r\n    act(() => {\r\n      result.current.handleContinue();\r\n    });\r\n    act(() => {\r\n      result.current.handleChangeEmail('user@example.com');\r\n      result.current.handleChangePassword('Pass123!');\r\n      result.current.handleChangePhone('+256 701 234 567');\r\n    });\r\n    await act(async () => {\r\n      await result.current.handleSubmit();\r\n    });\r\n    expect(clearError).toHaveBeenCalled();\r\n    expect(register).toHaveBeenCalledWith({\r\n      email: 'user@example.com',\r\n      password: 'Pass123!',\r\n      tenant_id: '550e8400-e29b-41d4-a716-446655440000',\r\n      facility_id: '550e8400-e29b-41d4-a716-446655440001',\r\n      phone: '256701234567',\r\n    });\r\n  });\r\n\r\n  it('maps error codes to i18n messages', () => {\r\n    useAuth.mockReturnValue({\r\n      register,\r\n      clearError,\r\n      isLoading: false,\r\n      errorCode: 'CONFLICT',\r\n    });\r\n    const { result } = renderHook(() => useRegisterScreen());\r\n    expect(result.current.errorMessage).toBe('Conflict');\r\n  });\r\n\r\n  it('blocks access when user lacks role', () => {\r\n    useAuth.mockReturnValue({\r\n      register,\r\n      clearError,\r\n      isLoading: false,\r\n      errorCode: null,\r\n      isAuthenticated: false,\r\n      roles: [],\r\n    });\r\n    const { result } = renderHook(() => useRegisterScreen());\r\n    expect(result.current.accessErrorMessage).toBe('errors.codes.FORBIDDEN');\r\n  });\r\n\r\n  it('blocks continue when tenant is invalid', () => {\r\n    const { result } = renderHook(() => useRegisterScreen());\r\n    act(() => {\r\n      result.current.handleChangeTenantId('invalid');\r\n    });\r\n    act(() => {\r\n      result.current.handleContinue();\r\n    });\r\n    expect(result.current.tenantIdError).toBe('forms.validation.invalidUuid');\r\n    expect(result.current.step).toBe(STEPS.ORGANIZATION);\r\n  });\r\n\r\n  it('handles navigation actions', () => {\r\n    const { result } = renderHook(() => useRegisterScreen());\r\n    act(() => {\r\n      result.current.handleGoToLogin();\r\n    });\r\n    expect(push).toHaveBeenCalledWith('/login');\r\n  });\r\n\r\n  it('supports going back to organization step', () => {\r\n    const { result } = renderHook(() => useRegisterScreen());\r\n    act(() => {\r\n      result.current.handleChangeTenantId('550e8400-e29b-41d4-a716-446655440000');\r\n      result.current.handleContinue();\r\n      result.current.handleBack();\r\n    });\r\n    expect(result.current.step).toBe(STEPS.ORGANIZATION);\r\n  });\r\n});\r\n\r\n"],"mappings":"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","ignoreList":[]}