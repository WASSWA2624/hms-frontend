57fba7ea87bcdc8ab6841abe8adffefe
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
var _react = require("react");
var _reactRedux = require("react-redux");
var _selectors = require("../store/selectors");
var _auth = require("../store/slices/auth.slice");
var normalizeRole = function normalizeRole(role) {
  if (!role) return null;
  return String(role).trim().toLowerCase();
};
var normalizeRoles = function normalizeRoles(roles) {
  if (!roles) return [];
  var list = Array.isArray(roles) ? roles : [roles];
  return list.map(normalizeRole).filter(Boolean);
};
var useAuth = function useAuth() {
  var dispatch = (0, _reactRedux.useDispatch)();
  var isAuthenticated = (0, _reactRedux.useSelector)(_selectors.selectIsAuthenticated);
  var user = (0, _reactRedux.useSelector)(_selectors.selectUser);
  var roles = (0, _react.useMemo)(function () {
    var userRoles = (user == null ? void 0 : user.roles) || (user == null ? void 0 : user.role) || [];
    return normalizeRoles(userRoles);
  }, [user]);
  return {
    isAuthenticated: Boolean(isAuthenticated),
    user: user || null,
    roles: roles,
    role: roles[0] || null,
    login: (0, _react.useCallback)(function (payload) {
      return dispatch(_auth.actions.login(payload));
    }, [dispatch]),
    register: (0, _react.useCallback)(function (payload) {
      return dispatch(_auth.actions.register(payload));
    }, [dispatch]),
    logout: (0, _react.useCallback)(function () {
      return dispatch(_auth.actions.logout());
    }, [dispatch]),
    refreshSession: (0, _react.useCallback)(function () {
      return dispatch(_auth.actions.refreshSession());
    }, [dispatch]),
    loadCurrentUser: (0, _react.useCallback)(function () {
      return dispatch(_auth.actions.loadCurrentUser());
    }, [dispatch])
  };
};
var _default = exports.default = useAuth;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfcmVhY3QiLCJyZXF1aXJlIiwiX3JlYWN0UmVkdXgiLCJfc2VsZWN0b3JzIiwiX2F1dGgiLCJub3JtYWxpemVSb2xlIiwicm9sZSIsIlN0cmluZyIsInRyaW0iLCJ0b0xvd2VyQ2FzZSIsIm5vcm1hbGl6ZVJvbGVzIiwicm9sZXMiLCJsaXN0IiwiQXJyYXkiLCJpc0FycmF5IiwibWFwIiwiZmlsdGVyIiwiQm9vbGVhbiIsInVzZUF1dGgiLCJkaXNwYXRjaCIsInVzZURpc3BhdGNoIiwiaXNBdXRoZW50aWNhdGVkIiwidXNlU2VsZWN0b3IiLCJzZWxlY3RJc0F1dGhlbnRpY2F0ZWQiLCJ1c2VyIiwic2VsZWN0VXNlciIsInVzZU1lbW8iLCJ1c2VyUm9sZXMiLCJsb2dpbiIsInVzZUNhbGxiYWNrIiwicGF5bG9hZCIsImF1dGhBY3Rpb25zIiwicmVnaXN0ZXIiLCJsb2dvdXQiLCJyZWZyZXNoU2Vzc2lvbiIsImxvYWRDdXJyZW50VXNlciIsIl9kZWZhdWx0IiwiZXhwb3J0cyIsImRlZmF1bHQiXSwic291cmNlcyI6WyJ1c2VBdXRoLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiB1c2VBdXRoIEhvb2tcclxuICogUHJvdmlkZXMgbWluaW1hbCBhdXRoIHN0YXRlIGZyb20gUmVkdXggZm9yIFVJIGd1YXJkcy9uYXZpZ2F0aW9uLlxyXG4gKiBGaWxlOiB1c2VBdXRoLmpzXHJcbiAqL1xyXG5pbXBvcnQgeyB1c2VDYWxsYmFjaywgdXNlTWVtbyB9IGZyb20gJ3JlYWN0JztcclxuaW1wb3J0IHsgdXNlRGlzcGF0Y2gsIHVzZVNlbGVjdG9yIH0gZnJvbSAncmVhY3QtcmVkdXgnO1xyXG5pbXBvcnQgeyBzZWxlY3RJc0F1dGhlbnRpY2F0ZWQsIHNlbGVjdFVzZXIgfSBmcm9tICdAc3RvcmUvc2VsZWN0b3JzJztcclxuaW1wb3J0IHsgYWN0aW9ucyBhcyBhdXRoQWN0aW9ucyB9IGZyb20gJ0BzdG9yZS9zbGljZXMvYXV0aC5zbGljZSc7XHJcblxyXG5jb25zdCBub3JtYWxpemVSb2xlID0gKHJvbGUpID0+IHtcclxuICBpZiAoIXJvbGUpIHJldHVybiBudWxsO1xyXG4gIHJldHVybiBTdHJpbmcocm9sZSkudHJpbSgpLnRvTG93ZXJDYXNlKCk7XHJcbn07XHJcblxyXG5jb25zdCBub3JtYWxpemVSb2xlcyA9IChyb2xlcykgPT4ge1xyXG4gIGlmICghcm9sZXMpIHJldHVybiBbXTtcclxuICBjb25zdCBsaXN0ID0gQXJyYXkuaXNBcnJheShyb2xlcykgPyByb2xlcyA6IFtyb2xlc107XHJcbiAgcmV0dXJuIGxpc3QubWFwKG5vcm1hbGl6ZVJvbGUpLmZpbHRlcihCb29sZWFuKTtcclxufTtcclxuXHJcbi8qKlxyXG4gKiB1c2VBdXRoIGhvb2tcclxuICogQHJldHVybnMge09iamVjdH0gYXV0aCBzdGF0ZSBhbmQgbm9ybWFsaXplZCByb2xlc1xyXG4gKi9cclxuY29uc3QgdXNlQXV0aCA9ICgpID0+IHtcclxuICBjb25zdCBkaXNwYXRjaCA9IHVzZURpc3BhdGNoKCk7XHJcbiAgY29uc3QgaXNBdXRoZW50aWNhdGVkID0gdXNlU2VsZWN0b3Ioc2VsZWN0SXNBdXRoZW50aWNhdGVkKTtcclxuICBjb25zdCB1c2VyID0gdXNlU2VsZWN0b3Ioc2VsZWN0VXNlcik7XHJcblxyXG4gIGNvbnN0IHJvbGVzID0gdXNlTWVtbygoKSA9PiB7XHJcbiAgICBjb25zdCB1c2VyUm9sZXMgPSB1c2VyPy5yb2xlcyB8fCB1c2VyPy5yb2xlIHx8IFtdO1xyXG4gICAgcmV0dXJuIG5vcm1hbGl6ZVJvbGVzKHVzZXJSb2xlcyk7XHJcbiAgfSwgW3VzZXJdKTtcclxuXHJcbiAgcmV0dXJuIHtcclxuICAgIGlzQXV0aGVudGljYXRlZDogQm9vbGVhbihpc0F1dGhlbnRpY2F0ZWQpLFxyXG4gICAgdXNlcjogdXNlciB8fCBudWxsLFxyXG4gICAgcm9sZXMsXHJcbiAgICByb2xlOiByb2xlc1swXSB8fCBudWxsLFxyXG4gICAgbG9naW46IHVzZUNhbGxiYWNrKChwYXlsb2FkKSA9PiBkaXNwYXRjaChhdXRoQWN0aW9ucy5sb2dpbihwYXlsb2FkKSksIFtkaXNwYXRjaF0pLFxyXG4gICAgcmVnaXN0ZXI6IHVzZUNhbGxiYWNrKChwYXlsb2FkKSA9PiBkaXNwYXRjaChhdXRoQWN0aW9ucy5yZWdpc3RlcihwYXlsb2FkKSksIFtkaXNwYXRjaF0pLFxyXG4gICAgbG9nb3V0OiB1c2VDYWxsYmFjaygoKSA9PiBkaXNwYXRjaChhdXRoQWN0aW9ucy5sb2dvdXQoKSksIFtkaXNwYXRjaF0pLFxyXG4gICAgcmVmcmVzaFNlc3Npb246IHVzZUNhbGxiYWNrKCgpID0+IGRpc3BhdGNoKGF1dGhBY3Rpb25zLnJlZnJlc2hTZXNzaW9uKCkpLCBbZGlzcGF0Y2hdKSxcclxuICAgIGxvYWRDdXJyZW50VXNlcjogdXNlQ2FsbGJhY2soKCkgPT4gZGlzcGF0Y2goYXV0aEFjdGlvbnMubG9hZEN1cnJlbnRVc2VyKCkpLCBbZGlzcGF0Y2hdKSxcclxuICB9O1xyXG59O1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgdXNlQXV0aDtcclxuIl0sIm1hcHBpbmdzIjoiOzs7O0FBS0EsSUFBQUEsTUFBQSxHQUFBQyxPQUFBO0FBQ0EsSUFBQUMsV0FBQSxHQUFBRCxPQUFBO0FBQ0EsSUFBQUUsVUFBQSxHQUFBRixPQUFBO0FBQ0EsSUFBQUcsS0FBQSxHQUFBSCxPQUFBO0FBRUEsSUFBTUksYUFBYSxHQUFHLFNBQWhCQSxhQUFhQSxDQUFJQyxJQUFJLEVBQUs7RUFDOUIsSUFBSSxDQUFDQSxJQUFJLEVBQUUsT0FBTyxJQUFJO0VBQ3RCLE9BQU9DLE1BQU0sQ0FBQ0QsSUFBSSxDQUFDLENBQUNFLElBQUksQ0FBQyxDQUFDLENBQUNDLFdBQVcsQ0FBQyxDQUFDO0FBQzFDLENBQUM7QUFFRCxJQUFNQyxjQUFjLEdBQUcsU0FBakJBLGNBQWNBLENBQUlDLEtBQUssRUFBSztFQUNoQyxJQUFJLENBQUNBLEtBQUssRUFBRSxPQUFPLEVBQUU7RUFDckIsSUFBTUMsSUFBSSxHQUFHQyxLQUFLLENBQUNDLE9BQU8sQ0FBQ0gsS0FBSyxDQUFDLEdBQUdBLEtBQUssR0FBRyxDQUFDQSxLQUFLLENBQUM7RUFDbkQsT0FBT0MsSUFBSSxDQUFDRyxHQUFHLENBQUNWLGFBQWEsQ0FBQyxDQUFDVyxNQUFNLENBQUNDLE9BQU8sQ0FBQztBQUNoRCxDQUFDO0FBTUQsSUFBTUMsT0FBTyxHQUFHLFNBQVZBLE9BQU9BLENBQUEsRUFBUztFQUNwQixJQUFNQyxRQUFRLEdBQUcsSUFBQUMsdUJBQVcsRUFBQyxDQUFDO0VBQzlCLElBQU1DLGVBQWUsR0FBRyxJQUFBQyx1QkFBVyxFQUFDQyxnQ0FBcUIsQ0FBQztFQUMxRCxJQUFNQyxJQUFJLEdBQUcsSUFBQUYsdUJBQVcsRUFBQ0cscUJBQVUsQ0FBQztFQUVwQyxJQUFNZCxLQUFLLEdBQUcsSUFBQWUsY0FBTyxFQUFDLFlBQU07SUFDMUIsSUFBTUMsU0FBUyxHQUFHLENBQUFILElBQUksb0JBQUpBLElBQUksQ0FBRWIsS0FBSyxNQUFJYSxJQUFJLG9CQUFKQSxJQUFJLENBQUVsQixJQUFJLEtBQUksRUFBRTtJQUNqRCxPQUFPSSxjQUFjLENBQUNpQixTQUFTLENBQUM7RUFDbEMsQ0FBQyxFQUFFLENBQUNILElBQUksQ0FBQyxDQUFDO0VBRVYsT0FBTztJQUNMSCxlQUFlLEVBQUVKLE9BQU8sQ0FBQ0ksZUFBZSxDQUFDO0lBQ3pDRyxJQUFJLEVBQUVBLElBQUksSUFBSSxJQUFJO0lBQ2xCYixLQUFLLEVBQUxBLEtBQUs7SUFDTEwsSUFBSSxFQUFFSyxLQUFLLENBQUMsQ0FBQyxDQUFDLElBQUksSUFBSTtJQUN0QmlCLEtBQUssRUFBRSxJQUFBQyxrQkFBVyxFQUFDLFVBQUNDLE9BQU87TUFBQSxPQUFLWCxRQUFRLENBQUNZLGFBQVcsQ0FBQ0gsS0FBSyxDQUFDRSxPQUFPLENBQUMsQ0FBQztJQUFBLEdBQUUsQ0FBQ1gsUUFBUSxDQUFDLENBQUM7SUFDakZhLFFBQVEsRUFBRSxJQUFBSCxrQkFBVyxFQUFDLFVBQUNDLE9BQU87TUFBQSxPQUFLWCxRQUFRLENBQUNZLGFBQVcsQ0FBQ0MsUUFBUSxDQUFDRixPQUFPLENBQUMsQ0FBQztJQUFBLEdBQUUsQ0FBQ1gsUUFBUSxDQUFDLENBQUM7SUFDdkZjLE1BQU0sRUFBRSxJQUFBSixrQkFBVyxFQUFDO01BQUEsT0FBTVYsUUFBUSxDQUFDWSxhQUFXLENBQUNFLE1BQU0sQ0FBQyxDQUFDLENBQUM7SUFBQSxHQUFFLENBQUNkLFFBQVEsQ0FBQyxDQUFDO0lBQ3JFZSxjQUFjLEVBQUUsSUFBQUwsa0JBQVcsRUFBQztNQUFBLE9BQU1WLFFBQVEsQ0FBQ1ksYUFBVyxDQUFDRyxjQUFjLENBQUMsQ0FBQyxDQUFDO0lBQUEsR0FBRSxDQUFDZixRQUFRLENBQUMsQ0FBQztJQUNyRmdCLGVBQWUsRUFBRSxJQUFBTixrQkFBVyxFQUFDO01BQUEsT0FBTVYsUUFBUSxDQUFDWSxhQUFXLENBQUNJLGVBQWUsQ0FBQyxDQUFDLENBQUM7SUFBQSxHQUFFLENBQUNoQixRQUFRLENBQUM7RUFDeEYsQ0FBQztBQUNILENBQUM7QUFBQyxJQUFBaUIsUUFBQSxHQUFBQyxPQUFBLENBQUFDLE9BQUEsR0FFYXBCLE9BQU8iLCJpZ25vcmVMaXN0IjpbXX0=