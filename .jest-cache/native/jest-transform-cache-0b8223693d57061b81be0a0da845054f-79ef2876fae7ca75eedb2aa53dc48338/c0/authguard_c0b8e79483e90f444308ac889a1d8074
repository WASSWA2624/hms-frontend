009d45e1946e69b16a8d5b7a097b7ab7
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.useAuthGuard = useAuthGuard;
var _react = require("react");
var _reactRedux = require("react-redux");
var _expoRouter = require("expo-router");
var _selectors = require("../../store/selectors");
function useAuthGuard() {
  var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
  var _options$redirectPath = options.redirectPath,
    redirectPath = _options$redirectPath === void 0 ? '/login' : _options$redirectPath,
    _options$skipRedirect = options.skipRedirect,
    skipRedirect = _options$skipRedirect === void 0 ? false : _options$skipRedirect;
  var router = (0, _expoRouter.useRouter)();
  var isAuthenticated = (0, _reactRedux.useSelector)(_selectors.selectIsAuthenticated);
  var user = (0, _reactRedux.useSelector)(_selectors.selectUser);
  var hasRedirected = (0, _react.useRef)(false);
  (0, _react.useEffect)(function () {
    if (skipRedirect) {
      return;
    }
    if (isAuthenticated) {
      hasRedirected.current = false;
    } else if (!hasRedirected.current) {
      hasRedirected.current = true;
      router.replace(redirectPath);
    }
  }, [isAuthenticated, redirectPath, router, skipRedirect]);
  return {
    authenticated: isAuthenticated,
    user: user || null
  };
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfcmVhY3QiLCJyZXF1aXJlIiwiX3JlYWN0UmVkdXgiLCJfZXhwb1JvdXRlciIsIl9zZWxlY3RvcnMiLCJ1c2VBdXRoR3VhcmQiLCJvcHRpb25zIiwiYXJndW1lbnRzIiwibGVuZ3RoIiwidW5kZWZpbmVkIiwiX29wdGlvbnMkcmVkaXJlY3RQYXRoIiwicmVkaXJlY3RQYXRoIiwiX29wdGlvbnMkc2tpcFJlZGlyZWN0Iiwic2tpcFJlZGlyZWN0Iiwicm91dGVyIiwidXNlUm91dGVyIiwiaXNBdXRoZW50aWNhdGVkIiwidXNlU2VsZWN0b3IiLCJzZWxlY3RJc0F1dGhlbnRpY2F0ZWQiLCJ1c2VyIiwic2VsZWN0VXNlciIsImhhc1JlZGlyZWN0ZWQiLCJ1c2VSZWYiLCJ1c2VFZmZlY3QiLCJjdXJyZW50IiwicmVwbGFjZSIsImF1dGhlbnRpY2F0ZWQiXSwic291cmNlcyI6WyJhdXRoLmd1YXJkLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBBdXRoIEd1YXJkIEhvb2tcclxuICogXHJcbiAqIENoZWNrcyBhdXRoZW50aWNhdGlvbiBzdGF0ZSBhbmQgcmVkaXJlY3RzIHVuYXV0aGVudGljYXRlZCB1c2Vycy5cclxuICogXHJcbiAqIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zIC0gQ29uZmlndXJhdGlvbiBvcHRpb25zXHJcbiAqIEBwYXJhbSB7c3RyaW5nfSBbb3B0aW9ucy5yZWRpcmVjdFBhdGg9Jy9sb2dpbiddIC0gUGF0aCB0byByZWRpcmVjdCB0byBpZiB1bmF1dGhlbnRpY2F0ZWRcclxuICogQHBhcmFtIHtib29sZWFufSBbb3B0aW9ucy5za2lwUmVkaXJlY3Q9ZmFsc2VdIC0gSWYgdHJ1ZSwgc2tpcCBhdXRvbWF0aWMgcmVkaXJlY3QgKHVzZWZ1bCBmb3IgYXV0aCBsYXlvdXRzIHRoYXQgbmVlZCB0byByZWRpcmVjdCBhdXRoZW50aWNhdGVkIHVzZXJzKVxyXG4gKiBAcmV0dXJucyB7T2JqZWN0fSBBdXRoIHN0YXRlIG9iamVjdCB3aXRoIHsgYXV0aGVudGljYXRlZCwgdXNlciB9XHJcbiAqIFxyXG4gKiBAZXhhbXBsZVxyXG4gKiBjb25zdCB7IGF1dGhlbnRpY2F0ZWQsIHVzZXIgfSA9IHVzZUF1dGhHdWFyZCgpO1xyXG4gKiBjb25zdCB7IGF1dGhlbnRpY2F0ZWQsIHVzZXIgfSA9IHVzZUF1dGhHdWFyZCh7IHJlZGlyZWN0UGF0aDogJy9jdXN0b20tbG9naW4nIH0pO1xyXG4gKiBjb25zdCB7IGF1dGhlbnRpY2F0ZWQsIHVzZXIgfSA9IHVzZUF1dGhHdWFyZCh7IHNraXBSZWRpcmVjdDogdHJ1ZSB9KTsgLy8gRm9yIGF1dGggbGF5b3V0c1xyXG4gKi9cclxuXHJcbmltcG9ydCB7IHVzZUVmZmVjdCwgdXNlUmVmIH0gZnJvbSAncmVhY3QnO1xyXG5pbXBvcnQgeyB1c2VTZWxlY3RvciB9IGZyb20gJ3JlYWN0LXJlZHV4JztcclxuaW1wb3J0IHsgdXNlUm91dGVyIH0gZnJvbSAnZXhwby1yb3V0ZXInO1xyXG5pbXBvcnQgeyBzZWxlY3RJc0F1dGhlbnRpY2F0ZWQsIHNlbGVjdFVzZXIgfSBmcm9tICdAc3RvcmUvc2VsZWN0b3JzJztcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiB1c2VBdXRoR3VhcmQob3B0aW9ucyA9IHt9KSB7XHJcbiAgY29uc3QgeyByZWRpcmVjdFBhdGggPSAnL2xvZ2luJywgc2tpcFJlZGlyZWN0ID0gZmFsc2UgfSA9IG9wdGlvbnM7XHJcbiAgXHJcbiAgY29uc3Qgcm91dGVyID0gdXNlUm91dGVyKCk7XHJcbiAgY29uc3QgaXNBdXRoZW50aWNhdGVkID0gdXNlU2VsZWN0b3Ioc2VsZWN0SXNBdXRoZW50aWNhdGVkKTtcclxuICBjb25zdCB1c2VyID0gdXNlU2VsZWN0b3Ioc2VsZWN0VXNlcik7XHJcbiAgXHJcbiAgLy8gVXNlIHJlZiB0byB0cmFjayBpZiByZWRpcmVjdCBoYXMgYmVlbiBwZXJmb3JtZWQgdG8gcHJldmVudCBtdWx0aXBsZSByZWRpcmVjdHNcclxuICBjb25zdCBoYXNSZWRpcmVjdGVkID0gdXNlUmVmKGZhbHNlKTtcclxuICBcclxuICB1c2VFZmZlY3QoKCkgPT4ge1xyXG4gICAgaWYgKHNraXBSZWRpcmVjdCkge1xyXG4gICAgICAvLyBTa2lwIGF1dG9tYXRpYyByZWRpcmVjdCAtIGxldCB0aGUgY2FsbGluZyBjb21wb25lbnQgaGFuZGxlIHJlZGlyZWN0c1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGlmIChpc0F1dGhlbnRpY2F0ZWQpIHtcclxuICAgICAgLy8gUmVzZXQgcmVkaXJlY3QgZmxhZyB3aGVuIGF1dGhlbnRpY2F0ZWRcclxuICAgICAgaGFzUmVkaXJlY3RlZC5jdXJyZW50ID0gZmFsc2U7XHJcbiAgICB9IGVsc2UgaWYgKCFoYXNSZWRpcmVjdGVkLmN1cnJlbnQpIHtcclxuICAgICAgLy8gT25seSByZWRpcmVjdCBpZiBub3QgYXV0aGVudGljYXRlZCBhbmQgaGF2ZW4ndCByZWRpcmVjdGVkIHlldFxyXG4gICAgICBoYXNSZWRpcmVjdGVkLmN1cnJlbnQgPSB0cnVlO1xyXG4gICAgICByb3V0ZXIucmVwbGFjZShyZWRpcmVjdFBhdGgpO1xyXG4gICAgfVxyXG4gIH0sIFtpc0F1dGhlbnRpY2F0ZWQsIHJlZGlyZWN0UGF0aCwgcm91dGVyLCBza2lwUmVkaXJlY3RdKTtcclxuICBcclxuICByZXR1cm4ge1xyXG4gICAgYXV0aGVudGljYXRlZDogaXNBdXRoZW50aWNhdGVkLFxyXG4gICAgdXNlcjogdXNlciB8fCBudWxsLFxyXG4gIH07XHJcbn1cclxuXHJcbiJdLCJtYXBwaW5ncyI6Ijs7OztBQWdCQSxJQUFBQSxNQUFBLEdBQUFDLE9BQUE7QUFDQSxJQUFBQyxXQUFBLEdBQUFELE9BQUE7QUFDQSxJQUFBRSxXQUFBLEdBQUFGLE9BQUE7QUFDQSxJQUFBRyxVQUFBLEdBQUFILE9BQUE7QUFFTyxTQUFTSSxZQUFZQSxDQUFBLEVBQWU7RUFBQSxJQUFkQyxPQUFPLEdBQUFDLFNBQUEsQ0FBQUMsTUFBQSxRQUFBRCxTQUFBLFFBQUFFLFNBQUEsR0FBQUYsU0FBQSxNQUFHLENBQUMsQ0FBQztFQUN2QyxJQUFBRyxxQkFBQSxHQUEwREosT0FBTyxDQUF6REssWUFBWTtJQUFaQSxZQUFZLEdBQUFELHFCQUFBLGNBQUcsUUFBUSxHQUFBQSxxQkFBQTtJQUFBRSxxQkFBQSxHQUEyQk4sT0FBTyxDQUFoQ08sWUFBWTtJQUFaQSxZQUFZLEdBQUFELHFCQUFBLGNBQUcsS0FBSyxHQUFBQSxxQkFBQTtFQUVyRCxJQUFNRSxNQUFNLEdBQUcsSUFBQUMscUJBQVMsRUFBQyxDQUFDO0VBQzFCLElBQU1DLGVBQWUsR0FBRyxJQUFBQyx1QkFBVyxFQUFDQyxnQ0FBcUIsQ0FBQztFQUMxRCxJQUFNQyxJQUFJLEdBQUcsSUFBQUYsdUJBQVcsRUFBQ0cscUJBQVUsQ0FBQztFQUdwQyxJQUFNQyxhQUFhLEdBQUcsSUFBQUMsYUFBTSxFQUFDLEtBQUssQ0FBQztFQUVuQyxJQUFBQyxnQkFBUyxFQUFDLFlBQU07SUFDZCxJQUFJVixZQUFZLEVBQUU7TUFFaEI7SUFDRjtJQUVBLElBQUlHLGVBQWUsRUFBRTtNQUVuQkssYUFBYSxDQUFDRyxPQUFPLEdBQUcsS0FBSztJQUMvQixDQUFDLE1BQU0sSUFBSSxDQUFDSCxhQUFhLENBQUNHLE9BQU8sRUFBRTtNQUVqQ0gsYUFBYSxDQUFDRyxPQUFPLEdBQUcsSUFBSTtNQUM1QlYsTUFBTSxDQUFDVyxPQUFPLENBQUNkLFlBQVksQ0FBQztJQUM5QjtFQUNGLENBQUMsRUFBRSxDQUFDSyxlQUFlLEVBQUVMLFlBQVksRUFBRUcsTUFBTSxFQUFFRCxZQUFZLENBQUMsQ0FBQztFQUV6RCxPQUFPO0lBQ0xhLGFBQWEsRUFBRVYsZUFBZTtJQUM5QkcsSUFBSSxFQUFFQSxJQUFJLElBQUk7RUFDaEIsQ0FBQztBQUNIIiwiaWdub3JlTGlzdCI6W119